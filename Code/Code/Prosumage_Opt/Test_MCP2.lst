GAMS 24.2.1  r43572 Released Dec  9, 2013 WEX-WEI x86_64/MS Windows 09/03/18 16:02:15 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  **************************************************************************
      ******
   2  **************************************************************************
      ******
   3  *   This model is a dispatch and investment model for PROSUMAGE households
   4  *   PROSUMAGE households PROduce, conSUMe electricity and usage storAGE
   5  *
   6  *   Date of this version: August 6, 2018
   7  *
   8  **************************************************************************
      ******
   9  **************************************************************************
      ******
  10   
  11   
  12  ******************* Format and model run specifications ******************
      ******
  13   
  14  * ------------- household selection---------------------------------------
      ------
  15  * Select a household profile between V1 and V74:
  16   
  18   
  19   
  20  * ------------- Base year selection---------------------------------------
      ------
  21  * Select year between 2010 and 2016:
  22   
  24   
  25   
  26   
  27  * ------------- Set data import and export options -----------------------
      ------
  28   
  29  * mark offXcel with a star to turn off excel import and import gdx file
  30  * mark modelkill to create a gdx file only without model run
  31   
  34   
  35  * Set column index (alphabetic) in excel file furthest to the right
  36  * to speed up data import
  37   
  39   
  40  * Name input file suffix other than "input data"
  42   
  43  * Auto set of input file (do not change)
  45   
  46  * Auto set of output file (do not change)
  48   
  49   
  50  **************** Sets, variables, parameters declaration *****************
      ******
  51   
  52   
  53  Sets
  54  h                Hours                                   /h1*h8760/
  55  res              Renewable technologies                  /solar/
  56  *sto              Storage technolgies                     /storage/
  57  year             Base years                              /2010*2016/
  58  hh_profile       Household load data                     /V1*V74/
  59   
  60  ;
  61   
  62  Variables
  63  Z                        Objective
  64  lambda1(h)
  65  lambda2(h)
  66   
  67  ;
  68   
  69  Positive variables
  70  G_PV(h)              Generation of pv plant
  71  *CU(h)                Curtailment of pv energy
  72  N_PV                PV generation capacities
  73  *N_STO_E(sto)             Capacities: storage energy
  74  *N_STO_P(sto)             Capacities: storage power
  75  *STO_L(sto,h)             Storage level
  76  *STO_IN(sto,h)            Storage intake
  77  *STO_OUT(sto,h)           Storage generation
  78  E_buy(h)                 Energy purchased from market
  79  E_sell(h)                Energy sold to market
  80  mu
  81   
  82  ;
  83   
  84  Parameters
  85  *sto_ini_last(sto)           Level of storage in initial and last period
  86  *eta_sto_in(sto)             Efficiency: storage in
  87  *eta_sto_out(sto)            Efficiency: storage out
  88  d(h)                        Household load
  89  d_upload(h,hh_profile)      Household load - upload parameter
  90  avail_solar(h)              Hourly capacity factor for pv
  91  avail_solar_upload(h,year)  Hourly capacity factor pv - upload parameter
  92  pv_cap_max             PV capacity maximum
  93  price_market(h)             Price for selling energy per kWh
  94  price_market_upload(h,year) Price for selling energy per MWh - upload para
      meter
  95  price_buy(h)                   Price for energy consumption per kWh
  96  *c_i_sto_e(sto)              Cost: investment into storage energy
  97  *c_i_sto_p(sto)              Cost: investment into storage power
  98  c_i_pv                      Cost: investment into renewable capacity
  99  *c_var_sto(sto)              Cost: variable generation costs storage
 100  penalty                     Penalty term
 101   
 102   
 103   
 104  ;
 105   
 106   
 107  * Declare efficiency parameters
 108  *sto_ini_last(sto)  =  0.5 ;
 109  *eta_sto_in(sto)    =  0.81 ;
 110  *eta_sto_out(sto)   =  0.926 ;
 111  penalty = 0 ;
 112   
 113   
 114  * Declare cost parameters
 115  *c_i_sto_e(sto)  =  5418.14/1000 ;
 116  *c_i_sto_p(sto)  = 50995.48/1000 ;
 117  c_i_pv = 60526.64/1000 ;
 118  *c_var_sto(sto)  =     0.5/1000 ;
 119  price_buy(h)       =     0.30 ;
 120   
 121  * Declare further restrictions
 122  pv_cap_max = 10;
 123   
 124   
 125  ***************************** Upload data ********************************
      ******
 126   
 134   
 135   
 136  *$call "gdxxrw data\input_data.xlsx squeeze=N @data\input_data.tmp  o=data
      \input_data.gdx  ";
GDXIN   C:\Users\cguenther\Documents\GitHub\prosumage\Code\Code\Prosumage_Opt\da
        ta\input_data.gdx
--- LOAD  d_upload = 1:d_upload
--- LOAD  avail_solar_upload = 2:avail_solar_upload
--- LOAD  price_market_upload = 3:price_market_upload
 139  ;
 140   
 141  * Load data for specific household and base year
 142  d(h)                   = d_upload(h,'V17') ;
 143  avail_solar(h)         = avail_solar_upload(h,'2014') ;
 144   
 145  *Load market price as price per kWh
 146  price_market(h)        = price_market_upload(h,'2014')/1000 ;
 147  *price_market(h)        = 0.12 ;
 148   
 150   
 151  ****************************** Model setup *******************************
      ******
 152   
 153  Equations
 154  objective                  Objective function
 155  hh_energy_balance          Household energy balance
 156  pv_generation              Household use of pv energy generation
 157  pv_install_max        PV capacity constraint
 158  energy_tomarket            Amount of energy sold to market
 159  energy_frommarket          Amount of energy purchased from market
 160  KKTN
 161  KKTG
 162  KKTEB
 163  KKTES
 164  *stolev_no_freelunch        Storage level in initial and last period
 165  *stolevel                   Storage level dynamics
 166  *stolev_max_energy          Storage capacity constraint on maximum energy
 167  *stoin_max_power            Storage capacity constraint on maximum power -
       storing in
 168  *stoout_max_power           Storage capacity constraint on maximum power -
       storing out
 169  *foresight_24h              Perfect foresight only for next 24h
 170  ;
 171   
 172   
 173  *** Objective function: Minimize total system costs
 174   
 175  *** Household energy balance: Satisfy load with own generation, storage an
      d grid
 176  hh_energy_balance(h)..
 177   
 178   
 179             G_PV(h)
 180  *         + sum( sto , STO_OUT(sto,h))
 181           + E_buy(h)
 182          =L= d(h)
 183   
 184  ;
 185   
 186  *** Household PV generation usage: Directly consumed, curtailed,stored or 
      sold
 187  pv_generation(h)..
 188   
 189   
 190          G_PV(h)
 191  *      + CU(res,h)
 192  *      + sum( sto , STO_IN(sto,h))
 193        + E_sell(h)   =L=
 194          avail_solar(h) * N_PV
 195   
 196   
 197  ;
 198   
 199  *** Restrict PV capacity
 200  pv_install_max..
 201   
 202             pv_cap_max =G= N_PV
 203  ;
 204   
 205  *** Restrict PV capacity
 206  KKTN..
 207   
 208          c_i_pv - sum( h , lambda2(h)*  avail_solar(h)) + mu =E= 0
 209  ;
 210   
 211  KKTG(h)..
 212   
 213         lambda1(h) +  lambda2(h) =E= 0
 214  ;
 215   
 216  KKTEB(h)..
 217   
 218        -price_buy(h) +  lambda1(h) =E= 0
 219  ;
 220   
 221  KKTES(h)..
 222   
 223        -price_market(h) +  lambda2(h) =E= 0
 224  ;
 225   
      *** Technical constraints on storage
      *Storage level in first and last period must be the same
      stolev_no_freelunch(sto)..
       
               STO_L(sto,'h1') =E= STO_L(sto,'h8760')
      ;
       
      *Storage level for all hours except first: Prio level plus intake minus ou
      tflow
      stolevel(sto,h)$( ord(h) > 1 )..
       
               STO_L(sto,h) =E=
               STO_L(sto,h-1)
               + STO_IN(sto,h) * eta_sto_in(sto)
               - STO_OUT(sto,h)/eta_sto_out(sto)
      ;
       
      * Restrict foresight to 24h: Fix restriction -> should only apply to every
       24th hour
      foresight_24h(sto,h)$( ord(h) > 24 )..
       
               STO_L(sto,h) =E=
               STO_L(sto,h-24)
      ;
       
       
       
      * Storage maximum energy capacity
      stolev_max_energy(sto,h)..
       
               STO_L(sto,h) =L= N_STO_E(sto)
      ;
       
      * Storage maximum charging capacity (power in)
      stoin_max_power(sto,h)..
       
               STO_IN(sto,h) =L= N_STO_P(sto)
      ;
       
      * Storage maximum discharging capacity (power out)
      stoout_max_power(sto,h)..
       
               STO_OUT(sto,h) =L= N_STO_P(sto)
      ;
 270   
 271  ***************************** Initialize model ***************************
      ******
 272  Model prosumodmcp /
 273  KKTN.N_PV
 274  KKTG.G_PV
 275  KKTEB.E_buy
 276  KKTES.E_sell
 277  hh_energy_balance.lambda1
 278   
      KKTN.N_PV
      KKTG.G_PV
      KKTEB.E_buy
      KKTES.E_sell
      hh_energy_balance.lambda1
      pv_generation.lambda2
      pv_install_max.mu
 288  /
 289   
 290   
 291  options
 292  optcr = 0.00
 293  reslim = 10000000
 294  lp = cplex
 295  mcp = path
 296  nlp = conopt
 297  dispwidth = 15
 298  limrow = 0
 299  limcol = 0
 300  solprint = off
 301  sysout = off
 302  optcr = 1e-3
 303  optca = 10
 304  ;
 305   
 313   
 314   
 315  solve   prosumodmcp using mcp;
****                               $483
**** The following MCP errors were detected in model prosumodmcp:
**** 483 N_PV no ref to var in equ.var
**** 483 E_sell no ref to var in equ.var
 316  display d , N_PV.l , E_buy.l , E_sell.l
****                   $141                 $141
 317   
 318   
 319   
 320  ***************************** Set up reporting ***************************
      ******
 321   
 322   
GAMS 24.2.1  r43572 Released Dec  9, 2013 WEX-WEI x86_64/MS Windows 09/03/18 16:02:15 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Error Messages


141  Symbol neither initialized nor assigned
        A wild shot: You may have spurious commas in the explanatory
        text of a declaration. Check symbol reference list.
483  Mapped variables have to appear in the model

**** 3 ERROR(S)   0 WARNING(S)
GAMS 24.2.1  r43572 Released Dec  9, 2013 WEX-WEI x86_64/MS Windows 09/03/18 16:02:15 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\cguenther\Documents\GitHub\pr
                                          osumage\Code\Code\Prosumage_Opt\Test_M
                                          CP2.gms
     2      137 GDXIN          1     137  C:\Users\cguenther\Documents\GitHub\pr
                                          osumage\Code\Code\Prosumage_Opt\data\i
                                          nput_data.gdx


COMPILATION TIME     =        0.141 SECONDS     28 MB  24.2.1 r43572 WEX-WEI


USER: Abteilung Energie, Verkehr, Umwelt, 5 User     S131220:0515AN-GEN
      Deutsches Institut fuer Wirtschaftsforschung DIW           DC3975
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\cguenther\Documents\GitHub\prosumage\Code\Code\Prosumage_Opt
           \Test_MCP2.gms
Output     C:\Users\cguenther\Documents\GitHub\prosumage\Code\Code\Prosumage_Opt
           \Test_MCP2.lst

**** USER ERROR(S) ENCOUNTERED
