GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows 10/18/18 20:58:57 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  **************************************************************************
      ******
   2  **************************************************************************
      ******
   3  *   This model is a dispatch and investment model for PROSUMAGE households
   4  *   PROSUMAGE households PROduce, conSUMe electricity and usage storAGE
   5  *
   6  *   Date of this version: August 6, 2018
   7  *
   8  **************************************************************************
      ******
   9  **************************************************************************
      ******
  10   
  11   
  12  ******************* Format and model run specifications ******************
      ******
  13   
  14  * ------------- household selection---------------------------------------
      ------
  15  * Select a household profile between V1 and V74:
  16   
  18   
  19   
  20  * ------------- Base year selection---------------------------------------
      ------
  21  * Select year between 2010 and 2016:
  22   
  24   
  25   
  26   
  27  * ------------- Set data import and export options -----------------------
      ------
  28   
  29  * mark offXcel with a star to turn off excel import and import gdx file
  30  * mark modelkill to create a gdx file only without model run
  31   
  34   
  35  * Set column index (alphabetic) in excel file furthest to the right
  36  * to speed up data import
  37   
  39   
  40  * Name input file suffix other than "input data"
  42   
  43  * Auto set of input file (do not change)
  45   
  46  * Auto set of output file (do not change)
  48   
  49   
  50  **************** Sets, variables, parameters declaration *****************
      ******
  51   
  52   
  53   
  54  Sets
  55  h                hour                                    /h1*h8760/
  56  res              Renewable technologies                  /renewable/
  57  sto              Storage technolgies                     /storage/
  58  year             Base years                              /2010*2016/
  59  hh_profile       Household load data                     /V1*V74/
  60  ct               Dispatchable Technologies               /base, peak/
  61  * Include subset of all first hours of days within a year
INCLUDE    C:\Users\Lenovo\Documents\GitHub\prosumage\Code\Source_Code\Modelle\M
           ORITS\24h_FirstHours.gms
  63  Set
  64  h24(h)           Subset: First hour of day                  /h2,h1,h25,h49
      ,h73,h97,h121,h145,h169,h193,h217,h241,h265,h289,h313,h337,h361,h385,h409,
      h433,h457,h481,h505,h529,h553,h577,h601,h625,h649,h673,h697,h721,h745,h769
      ,h793,h817,h841,h865,h889,h913,h937,h961,h985,h1009,h1033,h1057,h1081,h110
      5,h1129,h1153,h1177,h1201,h1225,h1249,h1273,h1297,h1321,h1345,h1369,h1393,
      h1417,h1441,h1465,h1489,h1513,h1537,h1561,h1585,h1609,h1633,h1657,h1681,h1
      705,h1729,h1753,h1777,h1801,h1825,h1849,h1873,h1897,h1921,h1945,h1969,h199
      3,h2017,h2041,h2065,h2089,h2113,h2137,h2161,h2185,h2209,h2233,h2257,h2281,
      h2305,h2329,h2353,h2377,h2401,h2425,h2449,h2473,h2497,h2521,h2545,h2569,h2
      593,h2617,h2641,h2665,h2689,h2713,h2737,h2761,h2785,h2809,h2833,h2857,h288
      1,h2905,h2929,h2953,h2977,h3001,h3025,h3049,h3073,h3097,h3121,h3145,h3169,
      h3193,h3217,h3241,h3265,h3289,h3313,h3337,h3361,h3385,h3409,h3433,h3457,h3
      481,h3505,h3529,h3553,h3577,h3601,h3625,h3649,h3673,h3697,h3721,h3745,h376
      9,h3793,h3817,h3841,h3865,h3889,h3913,h3937,h3961,h3985,h4009,h4033,h4057,
      h4081,h4105,h4129,h4153,h4177,h4201,h4225,h4249,h4273,h4297,h4321,h4345,h4
      369,h4393,h4417,h4441,h4465,h4489,h4513,h4537,h4561,h4585,h4609,h4633,h465
      7,h4681,h4705,h4729,h4753,h4777,h4801,h4825,h4849,h4873,h4897,h4921,h4945,
      h4969,h4993,h5017,h5041,h5065,h5089,h5113,h5137,h5161,h5185,h5209,h5233,h5
      257,h5281,h5305,h5329,h5353,h5377,h5401,h5425,h5449,h5473,h5497,h5521,h554
      5,h5569,h5593,h5617,h5641,h5665,h5689,h5713,h5737,h5761,h5785,h5809,h5833,
      h5857,h5881,h5905,h5929,h5953,h5977,h6001,h6025,h6049,h6073,h6097,h6121,h6
      145,h6169,h6193,h6217,h6241,h6265,h6289,h6313,h6337,h6361,h6385,h6409,h643
      3,h6457,h6481,h6505,h6529,h6553,h6577,h6601,h6625,h6649,h6673,h6697,h6721,
      h6745,h6769,h6793,h6817,h6841,h6865,h6889,h6913,h6937,h6961,h6985,h7009,h7
      033,h7057,h7081,h7105,h7129,h7153,h7177,h7201,h7225,h7249,h7273,h7297,h732
      1,h7345,h7369,h7393,h7417,h7441,h7465,h7489,h7513,h7537,h7561,h7585,h7609,
      h7633,h7657,h7681,h7705,h7729,h7753,h7777,h7801,h7825,h7849,h7873,h7897,h7
      921,h7945,h7969,h7993,h8017,h8041,h8065,h8089,h8113,h8137,h8161,h8185,h820
      9,h8233,h8257,h8281,h8305,h8329,h8353,h8377,h8401,h8425,h8449,h8473,h8497,
      h8521,h8545,h8569,h8593,h8617,h8641,h8665,h8689,h8713,h8737/
  65  ;
  66  ;
  67   
  68  Variables
  69  Z_hh                         Objective household
  70  Z_sys                        Objective System
  71  ;
  72   
  73  Positive variables
  74  *Household variables
  75  G_PV_hh(h)              Generation of pv plant
  76  CU_hh(h)                Curtailment of pv energy
  77  N_PV_hh                 PV generation capacities
  78  N_STO_E_hh             Capacities: storage energy
  79  N_STO_P_hh             Capacities: storage power
  80  STO_L_hh(h)             Storage level
  81  STO_IN_hh(h)            Storage intake
  82  STO_OUT_hh(h)           Storage generation
  83  E_buy_hh(h)                 Energy purchased from market
  84  E_sell_hh(h)                Energy sold to market
  85  lambda_hh(h)
  86  gamma1_hh
  87  gamma2_hh(h)
  88  gamma3_hh(h)
  89  gamma4_hh(h)
  90  ;
  91   
  92  Variables
  93  mu_hh(h)
  94  levelsto_hh(h)
  95  lambda_stolev24h_hh(h) ;
  96   
  97  Positive variables
  98  *System variables
  99  G_CON(ct,h)              Generation of conventional electricity
 100  G_RENEWABLE(h)       Generation of renewable energy
 101  CU( h)                Curtailment of renewable energy
 102  N_RENEWABLE         Capacities: renewable energy
 103  N_CON(ct)                Capacities: conventional energy
 104  N_STO_E          Capacities: storage energy
 105  N_STO_P          Capacities: storage power
 106  STO_L(h)          Storage level
 107  STO_IN(h)         Storage intake
 108  STO_OUT(h)        Storage generation
 109  lambda(h)
 110  gamma1(ct,h)
 111  gamma2(h)
 112  gamma3(h)
 113  gamma4(h)
 114  resshare
 115  ;
 116   
 117  Variables
 118  mu
 119  levelsto(h);
 120   
 121  Parameters
 122  * Household Parameters
 123  sto_ini_last_hh             Level of storage in first and last period of t
      he analysis
 124  eta_sto_in_hh               Efficiency: storage in
 125  eta_sto_out_hh              Efficiency: storage out
 126  d_hh(h)                     Household load
 127  d_upload_hh(h,hh_profile)   Household load - upload parameter
 128  avail_solar(h)              Hourly capacity factor for pv
 129  avail_solar_upload(h,year)  Hourly capacity factor pv - upload parameter
 130  pv_cap_max                  PV capacity maximum
 131  price_market_upload(h,year) Price for selling energy per MWh - upload para
      meter
 132  price_buy                   Price for energy consumption per kWh
 133  c_i_sto_e_hh                Cost: investment into storage energy
 134  c_i_sto_p_hh                Cost: investment into storage power
 135  c_i_pv_hh                   Cost: investment into renewable capacity
 136  c_var_sto_hh                Cost: variable generation costs storage
 137  lev_Z                       Objective value: Annual electricity costs
 138  lev_EB                      Level of purchased electricity from grid
 139  lev_ES                      Level of sold electricity to grid
 140  price_market(h)             Price for selling energy per kWh
 141  days /365/
 142  ;
 143   
 144   
 145  Parameters
 146  *System Parameters
 147  phi_sto_ini              Level of storage in first and last period of the 
      analysis
 148  eta_sto_in               Efficiency: storage in
 149  eta_sto_out              Efficiency: storage out
 150  phi_min_res              Minimum share of renewable electricity in net con
      sumption
 151  phi_max_curt             Maximum share of renewable electricity curtailed 
      over the year
 152  d(h)                     Electricity demand
 153  d_upload(h,year)         Electricity demand - upload parameter
 154  phi_res( h)              Hourly capacity factor renewable energy
 155  phi_res_upload(h,year)   Hourly capacity factor renewable energy - upload 
      parameter
 156  c_i_sto_e                Cost: investment into storage energy
 157  c_i_sto_p                Cost: investment into storage power
 158  c_i_res                  Cost: investment into renewable capacity
 159  c_i_con(ct)              Cost: investment into conventional capacity
 160  c_var_con(ct)            Cost: variable generation costs conventional ener
      gy
 161  c_var_sto                Cost: variable generation costs storage
 162  penalty                  Penalty term
 163  share_solar(year)        Share of solar energy among total variable renewa
      ble energy
 164  share_wind(year)         Share of wind energy among total variable renewab
      le energy
 165  ;
 166   
 167  **************** Specify Parameters ***********************
 168   
 169  * Specify household Parameters
 170  * Declare efficiency parameters
 171  sto_ini_last_hh  =  0.5 ;
 172  eta_sto_in_hh    =  0.81 ;
 173  eta_sto_out_hh   =  0.926 ;
 174  penalty          =  0 ;
 175   
 176   
 177  * Declare cost parameters for household
 178  c_i_sto_e_hh  =  5418.14/1000  ;
 179  c_i_sto_p_hh  = 50995.48/1000  ;
 180  c_i_pv_hh     = 60526.64/1000  ;
 181  c_var_sto_hh  =     0.5 /1000*365/days  ;
 182  price_buy     =     0.30*365/days ;
 183   
 184  * Declare further restrictions
 185  pv_cap_max = 10       ;
 186   
 187   
 188  * Specify System Parameters
 189  phi_sto_ini = 0.5 ;
 190  eta_sto_in  = 0.81 ;
 191  eta_sto_out = 0.926 ;
 192  penalty     = 0 ;
 193  phi_min_res = 0.6;
 194   
 195  *Historical energy shares of wind and solar PV in base years
 196  *Source: OPSD (2017), see upload_data.xlsx
 197  share_solar('2012') = 0.378304182 ;
 198  share_solar('2013') = 0.385519442 ;
 199  share_solar('2014') = 0.390535228 ;
 200  share_solar('2015') = 0.310511627 ;
 201  share_solar('2016') = 0.310454625 ;
 202   
 203  share_wind('2012') = 0.621795818 ;
 204  share_wind('2013') = 0.614480558 ;
 205  share_wind('2014') = 0.609464772 ;
 206  share_wind('2015') = 0.689488373 ;
 207  share_wind('2016') = 0.689545375 ;
 208   
 209  * Specify system costs
 210  c_i_sto_e           = 5418.14 ;
 211  c_i_sto_p           = 50995.48 ;
 212  c_i_res             = share_solar('2014') * 60526.64 + share_wind('2014') 
      * 108869.81 ;
 213  c_i_con('base')     = 102393.68 ;
 214  c_i_con('peak')     = 47840.27 ;
 215  c_var_con('base')   = 31.03*365/days ;
 216  c_var_con('peak')   = 78.36*365/days ;
 217  c_var_sto           = 0.5*365/days ;
 218   
 219  ***************************** Upload data ********************************
      ******
 220   
 221  * Upload household data
 231   
 232  *$call "gdxxrw in.xlsx squeeze=N @in.tmp  o=in.gdx  ";
GDXIN   C:\Users\Lenovo\Documents\GitHub\prosumage\Code\Source_Code\Modelle\MORI
        TS\in.gdx
--- LOAD  d_upload_hh = 1:d_upload_hh
--- LOAD  avail_solar_upload = 2:avail_solar_upload
--- LOAD  price_market_upload = 3:price_market_upload
--- LOAD  d_upload = 4:d_upload
--- LOAD  phi_res_upload = 5:phi_res_upload
 236  ;
 237   
 238  * Load data for specific household and base year in MWh
 239  d_hh(h)                = d_upload_hh(h,'V17') ;
 240  avail_solar(h)         = avail_solar_upload(h,'2014') ;
 241   
 242  *Load market price as price per kWh
 243  price_market(h)        = price_market_upload(h,'2014')/1000  ;
 244  *price_market(h)        = 0.12 ;
 245   
 246   
 247  * Upload system relevant data
 248  *$onecho >temp.tmp
 249  *par=d_upload             rng=data!a3:f8763       rdim=1 cdim=1
 250  *par=phi_res_upload       rng=data!h3:m8763       rdim=1 cdim=1
 251   
 252  *$offecho
 253   
 254  *$call "gdxxrw data/upload_data.xlsx @temp.tmp o=Data_input";
 255  *$GDXin Data_input.gdx
 256  *$load d_upload phi_res_upload
 257  *;
 258   
 259  * Initialize base year
 260  phi_res(h)    = phi_res_upload(h,'2014') ;
 261  d(h)          = d_upload(h,'2014') ;
 262   
 264   
 265  ****************************** Model setup *******************************
      ******
 266   
 267  Equations
 268  *Household
 269  objective_hh                  Objective function
 270  hh_energy_balance_hh          Household energy balance
 271  pv_generation_hh              Household use of pv energy generation
 272  pv_install_max_hh             PV capacity constraint
 273  stolev_no_freelunch_hh        Storage level in initial and last period
 274  stolevel_hh                   Storage level dynamics
 275  stolev_max_energy_hh          Storage capacity constraint on maximum energ
      y
 276  stoin_max_power_hh            Storage capacity constraint on maximum power
       - storing in
 277  stoout_max_power_hh           Storage capacity constraint on maximum power
       - storing out
 278  KKTNPV_hh
 279  KKTNSTOE_hh
 280  KKTNSTOP_hh
 281  KKTEB_hh
 282  KKTES_hh
 283  KKTG_hh
 284  KKTSTOIN_hh
 285  KKTSTOUT_hh
 286  KKTSTOLEV_hh
 287  KKTCU_hh
 288  stolev_24h_hh
 289  ;
 290   
 291   
 292  Equations
 293  *System
 294  *objective                Objective function
 295  energy_balance           Energy balance (market clearing)
 296  renewable_generation     Use of renewable energy generation
 297  minRES                   Constraint on minimum share of renewables
 298  *maximum_curtailment      Constraint on maximum share of renewables curtai
      lment
 299  *maximum_loss             Constraint on maximum share of renewable energy 
      loss
 300  maximum_generation_con   Capacity constraint - conventional generation
 301  *stolev_start_end         Storage: storage level in the first and last per
      iod
 302  stolev                   Storage: storage level dynamics
 303  stolev_max               Storage: capacity constraint on maximum energy
 304  maxin_power              Storage: capacity constraint on maximum power - s
      toring in
 305  maxout_power             Storage: capacity constraint on maximum power - s
      toring out
 306  KKTNRES
 307  KKTNSTOE
 308  KKTNSTOP
 309  KKTNCON
 310  KKTGCON
 311  KKTGRES
 312  KKTSTOIN
 313  KKTSTOUT
 314  KKTSTOLEV
 315  KKTCU
 316   
 317  ;
 318   
 319   
 320   
 321  ************************* Declare household Equations ********************
      ******
 322  *** Objective function: Minimize total household electricity costs
 323  objective_hh..
 324   
 325     Z_hh =E=
 326   
 327            c_i_pv_hh* N_PV_hh
 328           + c_i_sto_e_hh * N_STO_E_hh + c_i_sto_p_hh * N_STO_P_hh
 329           + sum( (h) , c_var_sto_hh * (STO_IN_hh(h) + STO_OUT_hh(h)) )
 330           + sum(  h , price_buy * E_buy_hh(h))
 331           - sum(  h , lambda(h) * E_sell_hh(h))
 332  ;
 333   
 334  *** Household energy balance: Satisfy load with own generation, storage an
      d grid
 335  hh_energy_balance_hh(h)..
 336   
 337   
 338             G_PV_hh(h)
 339           + STO_OUT_hh(h)
 340           + E_buy_hh(h)  -  d_hh(h)       =G=    0
 341   
 342  ;
 343   
 344  *** Household PV generation usage: Directly consumed, CU_hhrtailed,stored 
      or sold
 345  pv_generation_hh(h)..
 346   
 347        avail_solar(h) * N_PV_hh
 348         - G_PV_hh(h)
 349         - CU_hh(h)
 350         - STO_IN_hh(h)
 351         - E_sell_hh(h)  =E= 0
 352  ;
 353   
 354  *** Restrict PV capacity
 355  pv_install_max_hh..
 356   
 357            pv_cap_max - N_PV_hh =G= 0
 358  ;
 359   
 360   
 361   
 362   
 363  *** Technical constraints on storage
 364  *Storage level in first and last period must be the same
      stolev_no_freelunch..
       
                STO_L_hh('h8760') - STO_L_hh('h1') =E= 0
      ;
       
 372   
 373  *Storage level for all hours except first: Prio level plus intake minus ou
      tflow
 374  stolevel_hh(h)$((ord(h)>1) )..
 375   
 376   
 377           STO_L_hh(h-1)
 378           + STO_IN_hh(h) * eta_sto_in_hh
 379           - STO_OUT_hh(h)/eta_sto_out_hh
 380           - STO_L_hh(h)
 381           =E=  0
 382  ;
 383   
 384  stolev_24h_hh(h)..
 385          - STO_L_hh(h)$(h24(h)) =E= 0
 386  ;
 387   
 388   
 389  * Storage maximum energy capacity
 390  stolev_max_energy_hh(h)..
 391   
 392            N_STO_E_hh  - STO_L_hh(h) =G= 0
 393  ;
 394   
 395  * Storage maximum charging capacity (power in)
 396  stoin_max_power_hh(h)..
 397   
 398             N_STO_P_hh - STO_IN_hh(h) =G= 0
 399  ;
 400   
 401  * Storage maximum discharging capacity (power out)
 402  stoout_max_power_hh(h)..
 403   
 404            N_STO_P_hh  - STO_OUT_hh(h) =G= 0
 405  ;
 406   
 407   
 408  KKTNPV_hh..
 409   
 410    c_i_pv_hh- sum( h, mu_hh(h)*avail_solar(h)) + gamma1_hh =G= 0
 411   
 412  ;
 413  KKTNSTOE_hh..
 414   
 415    c_i_sto_e_hh  - sum(h, gamma2_hh(h)) =G= 0
 416   
 417  ;
 418  KKTNSTOP_hh..
 419   
 420      c_i_sto_p_hh  - sum(h, gamma3_hh(h)) - sum(h, gamma4_hh(h)) =G= 0
 421   
 422  ;
 423   
 424  KKTEB_hh(h)..
 425   
 426           price_buy - lambda_hh(h) =G= 0
 427   
 428  ;
 429   
 430  KKTES_hh(h)..
 431   
 432  *           -price_market(h)
 433             -lambda(h)/1000
 434             + mu_hh(h) =G=  0
 435   
 436  ;
 437   
 438  KKTG_hh(h)..
 439   
 440        - lambda_hh(h) + mu_hh(h) =G= 0
 441   
 442   
 443  ;
 444   
 445  KKTCU_hh(h)..
 446   
 447        + mu_hh(h) =G= 0
 448  ;
 449   
 450  KKTSTOIN_hh(h)..
 451   
 452           c_var_sto_hh + mu_hh(h) + gamma3_hh(h) - levelsto_hh(h)*eta_sto_i
      n_hh =G= 0
 453   
 454  ;
 455  KKTSTOUT_hh(h)..
 456   
 457            c_var_sto_hh -lambda_hh(h) + gamma4_hh(h) + levelsto_hh(h)/eta_s
      to_out_hh =G= 0
 458   
 459   
 460  ;
 461   
 462  KKTSTOLEV_hh(h)..
 463   
 464   
 465       gamma2_hh(h) + levelsto_hh(h) - levelsto_hh(h+1)
 466      + (lambda_stolev24h_hh(h))$h24(h)  =G= 0
 467   
 468  ;
 469   
 470  ************************* Declare System Equations ***********************
      ******
 471   
      objective..
               Z =E= sum( sto , c_i_sto_e  * N_STO_E  + c_i_sto_p  * N_STO_P  )
               + sum( res , c_i_res(res) * N_RENEWABLE(res) )
               + sum( ct , c_i_con(ct) * N_CON(ct) )
               + sum( (ct,h) , c_var_con(ct) * G_CON(ct,h) )
               + sum( ( h) , c_var_sto  * (STO_IN( h) + STO_OUT( h)) )
      ;
 481   
 482   
 483  energy_balance(h)..
 484   
 485           sum( ct , G_CON(ct,h))
 486          + G_RENEWABLE(h)
 487          + STO_OUT(h)
 488          + E_sell_hh(h)/1000
 489          - d(h)
 490          - E_buy_hh(h)/1000
 491           =G= 0
 492  ;
 493   
 494  renewable_generation(h)..
 495   
 496   
 497            phi_res(h) * N_RENEWABLE
 498           - G_RENEWABLE(h) - CU(h) - STO_IN(h)  =E= 0
 499  ;
 500   
 501   
 502  minRES..
 503           (1-phi_min_res) * sum( h , d(h) ) - sum( (ct,h) , G_CON(ct,h) )  
      =G= 0
 504  ;
 505   
 506  maximum_generation_con(ct,h)..
 507   
 508           N_CON(ct) - G_CON(ct,h) =G= 0
 509  ;
 510   
 511   
 512  stolev(h)$((ord(h)>1) )..
 513          STO_L(h-1)
 514        + STO_IN(h) * eta_sto_in
 515        - STO_OUT(h)/eta_sto_out
 516        - STO_L(h)
 517        =E=  0
 518  ;
 519   
 520  stolev_max(h)..
 521   
 522            N_STO_E  - STO_L( h)  =G= 0
 523  ;
 524   
 525   
 526  maxin_power(h)..
 527   
 528           N_STO_P - STO_IN( h) =G= 0
 529  ;
 530   
 531  maxout_power(h)..
 532   
 533         N_STO_P   -  STO_OUT( h)   =G= 0
 534  ;
 535   
 536   
 537  KKTNRES..
 538   
 539   
 540    c_i_res - sum( h, mu(h)*phi_res(h)) =G= 0
 541   
 542  ;
 543  KKTNSTOE..
 544   
 545         c_i_sto_e  - sum(h, gamma2(h)) =G= 0
 546  ;
 547   
 548  KKTNSTOP..
 549         c_i_sto_p  - sum(h, gamma3(h)) - sum(h, gamma4(h)) =G= 0
 550   
 551  ;
 552   
 553  KKTNCON(ct)..
 554   
 555      c_i_con(ct) - sum(h, gamma1(ct,h))  =G= 0
 556   
 557  ;
 558   
 559  KKTGCON(ct,h)..
 560   
 561        c_var_con(ct)
 562        - lambda(h)
 563        + resshare + gamma1(ct,h)  =G= 0
 564   
 565  ;
 566   
 567  KKTGRES(h)..
 568   
 569                   - lambda(h)
 570                   + mu(h) =G= 0
 571   
 572  ;
 573   
 574  KKTSTOIN(h)..
 575   
 576                 c_var_sto + mu(h) + gamma3(h) - levelsto(h)*eta_sto_in =G= 
      0
 577   
 578  ;
 579   
 580  KKTSTOUT(h)..
 581   
 582   
 583    c_var_sto
 584    - lambda(h)
 585    + gamma4(h)
 586    + levelsto(h)/eta_sto_out =G= 0
 587   
 588   
 589   
 590  ;
 591   
 592  KKTSTOLEV(h)..
 593   
 594   
 595        gamma2(h) + levelsto(h) - levelsto(h+1) =G= 0
 596   
 597   
 598  ;
 599   
 600   
 601  KKTCU(h)..
 602   
 603        mu(h) =G= 0
 604   
 605  ;
 606   
 607   
 608   
 609  ***************************** Initialize model ***************************
      ******
 610  Model prosumodmcp /
 611   
 612  hh_energy_balance_hh.lambda_hh
 613  pv_generation_hh.mu_hh
 614  pv_install_max_hh.gamma1_hh
 615  stolevel_hh.levelsto_hh
 616  stolev_max_energy_hh.gamma2_hh
 617  stoin_max_power_hh.gamma3_hh
 618  stoout_max_power_hh.gamma4_hh
 619  KKTNPV_hh.N_PV_hh
 620  KKTNSTOE_hh.N_STO_E_hh
 621  KKTNSTOP_hh.N_STO_P_hh
 622  KKTEB_hh.E_buy_hh
 623  KKTES_hh.E_sell_hh
 624  KKTG_hh.G_PV_hh
 625  KKTSTOIN_hh.STO_IN_hh
 626  KKTSTOUT_hh.STO_OUT_hh
 627  KKTSTOLEV_hh.STO_L_hh
 628  KKTCU_hh.CU_hh
 629  stolev_24h_hh.lambda_stolev24h_hh
 630   
 631  energy_balance.lambda
 632  renewable_generation.mu
 633  minRES.resshare
 634  maximum_generation_con.gamma1
 635  stolev.levelsto
 636  stolev_max.gamma2
 637  maxin_power.gamma3
 638  maxout_power.gamma4
 639  KKTNRES.N_RENEWABLE
 640  KKTNSTOE.N_STO_E
 641  KKTNSTOP.N_STO_P
 642  KKTNCON.N_CON
 643  KKTGCON.G_CON
 644  KKTGRES.G_RENEWABLE
 645  KKTSTOIN.STO_IN
 646  KKTSTOUT.STO_OUT
 647  KKTSTOLEV.STO_L
 648  KKTCU.CU
 649   
 650  /
 651   
 652   
 653  options
 654  optcr = 0.00
 655  reslim = 10000000
 656  lp = cplex
 657  mip = cplex
 658  nlp = conopt
 659  dispwidth = 15
 660  limrow = 0
 661  limcol = 0
 662  solprint = off
 663  sysout = off
 664  optcr = 1e-3
 665  optca = 10
 666  *PROFILETOL = 10
 667   
 668  ;
 669   
 677   
 678  * Set up lower bounds for speed up
 679  * Household Variables
 680  G_PV_hh.up(h)              = 10  ;
 681  CU_hh.up(h)                = 10  ;
 682  N_PV_hh.up                 = 10  ;
 683  N_STO_E_hh.up              = 20  ;
 684  N_STO_P_hh.up              = 20  ;
 685  STO_L_hh.up(h)             = 20  ;
 686  STO_IN_hh.up(h)            = 20  ;
 687  STO_OUT_hh.up(h)           = 20  ;
 688  E_buy_hh.up(h)             = 50  ;
 689  E_sell_hh.up(h)            = 30  ;
 690  * System Variables
 691  G_CON.up(ct,h)             = 100000 ;
 692  G_RENEWABLE.up(h)          = 300000 ;
 693  CU.up(h)                   = 150000 ;
 694  N_RENEWABLE.up             = 300000 ;
 695  N_CON.up(ct)               = 100000 ;
 696  N_STO_E.up                 = 150000 ;
 697  N_STO_P.up                 = 100000 ;
 698  STO_L.up(h)                = 150000 ;
 699  STO_IN.up(h)               = 100000  ;
 700  STO_OUT.up(h)              = 100000  ;
 701   
 702  * Set up initial values for speed up
 703  STO_L_hh.l(h)   = 4.367;
 704  N_PV_hh.l       = 8    ;
 705  N_STO_E_hh.l    = 10   ;
 706  N_STO_P_hh.l    = 10   ;
 707  N_RENEWABLE.l              = 43000  ;
 708  N_CON.l(ct)                = 100000  ;
 709  N_STO_E.l                  = 120000 ;
 710  N_STO_P.l                  = 100000  ;
 711  *lambda.l(h)                = 1  ;
 712  *price_market(h)            = lambda.l(h)/1000 ;
 713   
 714   
 715  * First first storage level duals
 716  levelsto_hh.fx('h1') = 100;
 717  levelsto.fx('h1')  = 100;
 718   
 719   
 720  solve prosumodmcp using mcp;
 721   
 722  * Determine costs for system and household
 723  Z_sys.l                      =
 724           sum( sto , c_i_sto_e  * N_STO_E.l  + c_i_sto_p  * N_STO_P.l  )
 725           + c_i_res * N_RENEWABLE.l
 726           + sum( ct , c_i_con(ct) * N_CON.l(ct) )
 727           + sum( (ct,h) , c_var_con(ct) * G_CON.l(ct,h) )
 728           + sum( ( h) , c_var_sto  * (STO_IN.l( h) + STO_OUT.l( h)) )
 729  ;
 730   
 731   
 732  Z_hh.l                      =
 733   
 734            c_i_pv_hh* N_PV_hh.l
 735           + c_i_sto_e_hh * N_STO_E_hh.l  + c_i_sto_p_hh * N_STO_P_hh.l
 736           + sum( (h) , c_var_sto_hh * (STO_IN_hh.l (h) + STO_OUT_hh.l (h)) 
      )
 737           + sum(  h , price_buy * E_buy_hh.l (h))
 738           - sum(  h , price_market(h)/1000 * E_sell_hh.l (h))
 739  ;
 740   
 741  display d_hh , N_PV_hh.l , E_buy_hh.l , E_sell_hh.l ,  G_PV_hh.l,
 742          N_STO_E_hh.l, N_STO_P_hh.l, G_PV_hh.l,
 743          hh_energy_balance_hh.l, hh_energy_balance_hh.m,
 744          price_market,  CU_hh.l, N_RENEWABLE.l, d, G_RENEWABLE.l,
 745  *        G_CON.l, STO_OUT.l, lambda.l, lambda.m, mu.l, mu.m, energy_balanc
      e.m,
 746  *        N_CON.l, Z_sys.l ,
 747   Z_hh.l  ;
 748   
 749   
 750  ***************************** Set up reporting ***************************
      ******
 751   
      pv_install_max_hh.m, pv_generation_hh.m, N_STO_E_hh.l, N_STO_P_hh.l,
         hh_energy_balance_hh.m
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows 10/18/18 20:58:57 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\Lenovo\Documents\GitHub\prosu
                                          mage\Code\Source_Code\Modelle\MORITS\M
                                          ORITS_MCP_online.gms
     2       62 INCLUDE        1      62  .C:\Users\Lenovo\Documents\GitHub\pros
                                           umage\Code\Source_Code\Modelle\MORITS
                                           \24h_FirstHours.gms
     3      233 GDXIN          1     230  C:\Users\Lenovo\Documents\GitHub\prosu
                                          mage\Code\Source_Code\Modelle\MORITS\i
                                          n.gdx


COMPILATION TIME     =        0.125 SECONDS     31 MB  24.7.4 r58773 WEX-WEI
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows 10/18/18 20:58:57 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Model Statistics    SOLVE prosumodmcp Using MCP From line 720


MODEL STATISTICS

BLOCKS OF EQUATIONS          36     SINGLE EQUATIONS      245,654
BLOCKS OF VARIABLES          36     SINGLE VARIABLES      245,656
NON ZERO ELEMENTS       753,976     NON LINEAR N-Z              0
DERIVATIVE POOL              20     CONSTANT POOL              16
CODE LENGTH                   0


GENERATION TIME      =        3.750 SECONDS    103 MB  24.7.4 r58773 WEX-WEI


EXECUTION TIME       =        3.781 SECONDS    103 MB  24.7.4 r58773 WEX-WEI
