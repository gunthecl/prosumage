GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows 11/24/18 00:00:29 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1   
   2  **************************************************************************
      ******
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DI
      ETER).
      Version 1.3.0, October 2018.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses
      /mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
  12  **************************************************************************
      ******
  13   
  14   
  15   
  16   
  17  **************************
  18  ***** GLOBAL OPTIONS *****
  19  **************************
  20   
  21  * Set star to skip Excel upload and load data from gdx
  23   
  24   
  25  * Choose base year
  27   
  28  * Germany only - also adjust Excel inputs!
  30   
  31  * Set star to activate options
  32   
  34   
  35  * Set star to select run-of-river options either as exogenous parameter or
       as endogenous variable including reserve provision:
  36  * if nothing is selected, ROR capacity will be set to zero
  37  * if parameter option is selected, set appropriate values in fix.gmx
  38  * if variable option is selected, set appropriate bound in data_input exce
      l
  41   
  42  * Set star to determine loops, otherwise default 100% renewables
  44   
  45  * Set star for no crossover to speed up calculation time by skipping cross
      over in LP solver
  47   
  48  * Set star for reporting to Excel
  50   
  51   
  52  * ----------------- Select if to use MCP or LP format --------------------
      ------
  53   
  54  * Set to "*" to select linear program, leave blank to select MCP
  56   
  57  * Do not change these two lines
  60   
  61  **************************************************************************
      ******
  62   
  63  * Definition of strings for report parameters and sanity checks
  64  * (Do not change settings below)
  66   
  67  * Sanity checks
  69   
  70  **************************************************************************
      ******
  71   
  72  ****************************
  73  ***** INITIALIZE LOOPS *****
  74  ****************************
  75   
  76  sets
  77  *$ontext
  78  loop_res_share   Solution loop for different shares of renewables       /5
      0/
  81   
      loop_prosumage   Solution loop for different prosumer self-consumption lev
      els    /50/
      $ontext
  86   
  87  *      loop_res_share                          /50/
  88                        loop_prosumage                          /0/
  89  ;
  90   
  91   
  92   
  93   
  94  **************************************************************************
      ******
  95   
  96  **************************
  97  ***** SOLVER OPTIONS *****
  98  **************************
  99   
 100  options
 101  optcr = 0.00
 102  reslim = 10000000
 103  lp = cplex
 104  mip = cplex
 105  nlp = conopt
 106  limrow = 0
 107  limcol = 0
 108  ;
 109   
 110  options
 111  dispwidth = 15
 112  limrow = 0
 113  limcol = 0
 114  solprint = off
 115  sysout = off
 116  ;
 117   
 118   
 119   
 120   
 121  **************************************************************************
      ******
 122   
 123  **************************
 124  ***** Dataload *****
 125  **************************
 126   
INCLUDE    C:\Users\Lenovo\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_
           Module\Modified_MCP\dataload.gms
 128   
 129  **************************************************************************
      ******
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DI
      ETER).
      Version 1.3.0, October 2017.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses
      /mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
 139  **************************************************************************
      ******
 140   
 141   
 142   
 143   
 144  ***************  SETS  ***************************************************
      ******
 145   
 146  ***** Sets used in the model *****
 147  Sets
 148  tech                     Generation technologies
 149   dis(tech)               Dispatchable generation technologies
 150   nondis(tech)            Nondispatchable generation technologies
 151   con(tech)               Conventional generation technologies
 152   res(tech)               Renewable generation technologies
 153  sto                      Storage technologies
 154  rsvr                     Reservoir technologies
 155  dsm                      DSM technologies
 156   dsm_shift(dsm)          DSM load shifting technologies
 157   dsm_curt(dsm)           DSM load curtailment technologies
 158  year                     Base year for temporal data
 159  h                        Hours
 160  n                        Nodes
 161  l                        Lines
 162  ev                       EV types
 163  reserves                         Reserve qualities
 164   reserves_up(reserves)           Positive reserves
 165   reserves_do(reserves)           Negative reserves
 166   reserves_spin(reserves)         Spinning reserves
 167   reserves_nonspin(reserves)      Nonspinning reserves
 168   reserves_prim(reserves)         Primary reserves
 169   reserves_nonprim(reserves)      Nonprimary reserves
 170   reserves_prim_up(reserves)      Primary positive reserves
 171   reserves_nonprim_up(reserves)   Nonprimary positive reserves
 172   reserves_prim_do(reserves)      Primary negative reserves
 173   reserves_nonprim_do(reserves)   Nonprimary negative reserves
 174  bu                       Building archtypes
 175  ch                       Heating combination type
 176   hst(ch)                 Heating technology that feeds to storage
 177   hp(ch)                  Heat pump technologies
 178   hel(ch)                 Hybrid electric heating technologies - electric p
      art
 179   hfo(ch)                 Hybrid electric heating technologies - fossil par
      t
 180   
 181   
 182  ***** Sets used for data upload *****
 183  headers_tech                     Generation technologies - upload headers
 184   tech_dispatch                   Generation technologies - dispatchable or
       nondispatchable
 185   tech_res_con                    Generation technologies - renewable or "c
      onventional"
 186  headers_sto                      Storage technologies - upload headers
 187  headers_reservoir                Reservoir technologies - upload headers
 188  headers_dsm                      DSM technologies - upload headers
 189   dsm_type                        DSM technologies - shifting or curtailmen
      t
 190  headers_time                     Temporal data - upload headers
 191  headers_topology                 Spatial data - upload headers
 192  headers_ev                       EV data - upload headers
 193  headers_time_ev                  EV temporal data - upload headers
 194  headers_prosumage_generation     Prosumage generation data - upload header
      s
 195  headers_prosumage_storage        Prosumage storage data - upload headers
 196  headers_reserves                 Reserve data - upload headers
 197   reserves_up_down                Reserve data - positive and neagtive rese
      rves
 198   reserves_spin_nonspin           Reserve data - spinning and nonspinning r
      eserves
 199   reserves_prim_nonprim           Reserve data - primary and nonprimary res
      erves
 200  headers_heat                     Heat data - upload headers
 201   heat_storage                    Heat data - storage technologies
 202   heat_hp                         Heat data - heat pump technologies
 203   heat_elec                       Heat data - hybrid heating technologies -
       electric part
 204   heat_fossil                     Heat data - hybrid heating technologies -
       fossil part
 205  headers_time_heat                Heat data - upload headers time data
 206  headers_time_dhw                 Heat data - upload headers time data on D
      HW
 207  ;
 208   
 209   
 210   
 211   
 212  ***************  PARAMETERS  *********************************************
      ******
 213   
 214  Parameters
 215   
 216  ***** Generation technologies *****
 217  *--- Variable and fixed costs ---*
 218  eta              Efficiency of conventional technologies [0 1]
 219  carbon_content   CO2 emissions per fuel unit used [tons per MWh thermal]
 220  c_up             Load change costs UP [EUR per MWh]
 221  c_do             Load change costs DOWN [EUR per MWh]
 222  c_fix            Annual fixed costs [EUR per MW per year]
 223  c_vom            Variable O&M costs [EUR per MWh]
 224  CO2price         CO2 price in [EUR per ton]
 225   
 226  *--- Investment ---*
 227  c_inv_overnight  Investment costs: Overnight [EUR per MW]
 228  lifetime         Investment costs: technical lifetime [a]
 229  recovery         Investment costs: Recovery period according to depreciati
      on tables [a]
 230  interest_rate    Investment costs: Interest rate [%]
 231  m_p              Investment: maximum installable capacity per technology [
      MW]
 232  m_e              Investment: maximum installable energy [TWh per a]
 233   
 234  *--- Flexibility ---*
 235  grad_per_min     Maximum load change relative to installed capacity [% of 
      installed capacity per minute]
 236   
 237   
 238  ***** Fuel and CO2 costs *****
 239  fuelprice        Fuel price conventionals [EUR per MWh thermal]
 240   
 241   
 242  ***** Renewables *****
 243  c_cu             Hourly Curtailment costs for renewables [Euro per MW]
 244  phi_min_res      Minimum renewables share [0 1]
 245   
 246   
 247  ***** Storage *****
 248  *--- Variable and fixed costs ---*
 249  c_m_sto          Marginal costs of storing in or out [EUR per MWh]
 250  eta_sto          Storage efficiency [0 1]
 251  phi_sto_ini      Initial storage level [0 1]
 252  etop_max         Maximum E to P ratio of storage types [#]
 253  c_fix_sto        Annual fixed costs [EUR per MW]
 254   
 255  *--- Investment ---*
 256  c_inv_overnight_sto_e       Investment costs for storage energy: Overnight
       [EUR per MWh]
 257  c_inv_overnight_sto_p       Investment costs for storage capacity: Overnig
      ht [EUR per MW]
 258  m_sto_e                     Investment into storage: maximum installable e
      nergy [MWh]
 259  m_sto_p                     Investment into storage: maximum installable p
      ower [MW]
 260   
 261   
 262  ***** Reservoir*****
 263  *--- Variable and fixed costs ---*
 264  c_m_rsvr                 Marginal costs of generating energy from reservoi
      r [EUR per MWh]
 265  eta_rsvr                 Generation efficiency [0 1]
 266  phi_rsvr_ini             Initial reservoir level [0 1]
 267  c_fix_rsvr               Annual fixed costs [EUR per MW per a]
 268  phi_rsvr_min             Minimum hourly reservoir outflow as fraction of a
      nnual energy [0 1]
 269  phi_rsvr_lev_min         Minimum filling level [0 1]
 270   
 271  *--- Investment ---*
 272  c_inv_overnight_rsvr_e   Investment costs for reservoir energy: Overnight 
      [EUR per MWh]
 273  c_inv_overnight_rsvr_p   Investment costs for reservoir capacity: Overnigh
      t [EUR per MW]
 274  inv_lifetime_rsvr        Investment costs for reservoir: technical lifetim
      e [a]
 275  inv_interest_rsvr        Investment costs for reservoir: Interest rate [%]
 276  m_rsvr_e                 Investment into reservoir: maximum installable en
      ergy [MWh]
 277  m_rsvr_p                 Investment into reservoir: maximum installable ca
      pacity [MW]
 278   
 279   
 280  ***** DSM *****
 281  *--- Variable and fixed costs ---*
 282  c_m_dsm_cu       DSM: hourly costs of load curtailment [EUR per MWh]
 283  c_m_dsm_shift    DSM: costs for load shifting [EUR per MWh]
 284  c_fix_dsm_cu     Annual fixed costs load curtailment capacity [EUR per MW 
      per a]
 285  c_fix_dsm_shift  Annual fixed costs load shifting capacity [EUR per MW per
       a]
 286   
 287  *--- Flexibility, efficiency, recovery ---*
 288  t_dur_dsm_cu     DSM: Maximum duration load curtailment [h]
 289  t_off_dsm_cu     DSM: Minimum recovery time between two load curtailment i
      nstances [h]
 290   
 291  t_dur_dsm_shift  DSM: Maximum duration load shifting [h]
 292  t_off_dsm_shift  DSM: Minimum recovery time between two granular load upsh
      ift instances [h]
 293  eta_dsm_shift    DSM: Efficiency of load shifting technologies [0 1]
 294   
 295  *--- Investment ---*
 296  c_inv_overnight_dsm_cu           Investment costs for DSM load curtailment
      : Overnight [EUR per MW]
 297  c_inv_overnight_dsm_shift        Investment costs for DSM load shifting: O
      vernight [EUR per MW]
 298  inv_recovery_dsm_cu              Investment costs for DSM load curtailment
      : Recovery period [a]
 299  inv_recovery_dsm_shift           Investment costs for DSM load shifting: R
      ecovery period [a]
 300  inv_interest_dsm_cu              Investment costs for DSM load curtailment
      : Interest rate [%]
 301  inv_interest_dsm_shift           Investment costs for DSM load shifting: I
      nterest rate [%]
 302  m_dsm_cu                         DSM: Maximum installable capacity load cu
      rtailment [MW]
 303  m_dsm_shift                      DSM: Maximum installable capacity load sh
      ifting [MW]
 304   
 305   
 306  ***** Time Data *****
 307  d_y                      Demand hour h for different years [MWh]
 308  d                        Demand hour h [MWh]
 309  phi_res_y                Renewables availability technology res in hour h 
      for different years [0 1]
 310  phi_res                  Renewables availability technology res in hour h 
      [0 1]
 311  phi_ror_y                Run-of-river availability technology ror in hour 
      h for different years [0 1]
 312  phi_ror                  Run-of-river availability technology ror in hour 
      h [0 1]
 313  rsvr_in_y                Reservoir inflow in hour h for different years [0
       1]
 314  rsvr_in                  Reservoir inflow in hour h [0 1]
 315  n_ev_p_upload            Power rating of the charging connection in hour h
       [MW - 0 when car is in use or parked without grid connection]
 316  ev_ed_upload             Electricity demand for mobility vehicle profile e
      v in hour h [MW]
 317  ev_ged_exog_upload       Electricity demand for mobility in case of uncont
      rolled charging vehicle profile ev in hour h [MW]
 318  phi_reserves_call_y      Hourly share of reserve provision that is actuall
      y activated for different years [0 1]
 319  phi_reserves_call        Hourly share of reserve provision that is actuall
      y activated [0 1]
 320  reserves_exogenous_y     Hourly reserve provision for different years [MW]
 321  reserves_exogenous       Hourly reserve provision [MW]
 322   
 323  ***** Transmission *****
 324  *--- Investment ---*
 325  c_inv_overnight_ntc       Investment costs in: overnight [EUR per MW]
 326  c_fix_ntc                 Fixed costs [EUR per MW per a]
 327  inv_lifetime_ntc          Investment costs: technical lifetime [a]
 328  inv_recovery_ntc          Investment costs: Recovery period in [a]
 329  inv_interest_ntc          Investment costs: Interest rate [%]
 330  m_ntc                     Investment into NTC: maximum installable capacit
      y [MW]
 331   
 332  *--- Topology and distance ---*
 333  inc              Incidence index of link l on node n
 334  dist             Distance covered by link l [km]
 335   
 336   
 337  ***** Electric vehicles *****
 338  *--- Costs and attributes ---*
 339  c_m_ev           Marginal costs of discharging V2G [EUR per MWh]
 340  pen_phevfuel     Penalty for non-electric PHEV operation mode [EUR per MWh
      ]
 341  eta_ev_in        Electric vehicle efficiency of charging (G2V) [0 1]
 342  eta_ev_out       Electric vehicle efficiency of discharging (V2G) [0 1]
 343  phi_ev_ini       Electric vehicle charging level in initial period [0 1]
 344   
 345  n_ev_e           Electric vehicle battery capacity [MWh]
 346  ev_quant         Overall number of electirc vehicles [#]
 347  phi_ev           Share of electric vehicles per load profile in actual sce
      nario [0 1]
 348  ev_phev          Defines whether an electric vehicle is a PHEV REEV [1 if 
      yes 0 otherwise]
 349   
 350  *--- Temporal data ---*
 351  n_ev_p           Electric vehicle power rating [MWh]
 352  ev_ed            Electric vehicle electricity demand [MWh]
 353  ev_ged_exog      Electric vehicle grid electricity demand for exogenous ch
      arging pattern [MWh]
 354   
 355   
 356  ***** Prosumage *****
 357  phi_pro_load             Share of prosumagers among total load [0 1]
 358  phi_pro_self             Minimum self-generation shares for prosumagers [0
       1]
 359  m_res_pro                Maximum installable: renewables capacity [MW]
 360  m_sto_pro_e              Maximum installable: storage energy [MWh]
 361  m_sto_pro_p              Maximum installable: storage capacity [MW]
 362  phi_sto_pro_ini          Prosumagers' initial storage loading [0 1]
 363   
 364   
 365  ***** Reserves *****
 366  phi_reserves_share       Shares of SRL and MRL up and down [0 1]
 367  reserves_intercept       Intercept of regression line determining reserves
       demand
 368  reserves_slope           Slope of regression line determining reserves dem
      and
 369  reserves_reaction        Activation reaction time for reserves qualities [
      min]
 370  phi_reserves_pr_up       Positive primary reserves fraction of total nonpr
      imary reserves demand [0 1]
 371  phi_reserves_pr_do       Negative primary reserves fraction of total nonpr
      imary reserves demand [0 1]
 372  *reserves_exog
 373   
 374   
 375  ***** Heat *****
 376  *--- Time data ---*
 377  dh_upload                Hourly heat demand per year for upload [MWh per m
      2]
 378  dh_y                     Hourly heat demand per year [MWh per m2]
 379  dh                       Hourly heat demand [MWh per m2]
 380  temp_source              Heat pumps - source temperature [°Celsius]
 381  d_dhw_upload             Hourly DHW demand per year for upload [MWh per m2
      ]
 382  d_dhw_y                  Hourly DHW demand per year [MWh per m2]
 383  d_dhw                    Hourly DHW demand [MWh per m2]
 384  nets_profile(h)          Hourly exogenous heat demand by nonsmart night-ti
      me storage heaters [MWh per m2]
 385   
 386  *--- Technololgy attributes ---*
 387  phi_heat_type            Share of heating type ch per building archetype b
      u [0 1]
 388  eta_heat_stat            Static efficiency for heating technologies [0 1]
 389  eta_heat_dyn             Static efficiency for heating technologies [0 1]
 390  eta_dhw_aux_stat         Static efficiency for auxiliary DHW technologies 
      [0 1]
 391  n_heat_p_in              Maximum power inflow into heating technologies [M
      W]
 392  n_heat_p_out             Maximum power outflow from heating technologies [
      MW]
 393  n_heat_e                 Maximum energy level of heating storage technolog
      ies [MWh]
 394  n_sets_p_in              SETS - Power rating - electricity intake [MW]
 395  n_sets_p_out             SETS - Power rating - heat output [MW]
 396  n_sets_e                 SETS - Energy storage capacity [MWh]
 397  n_sets_dhw_p_in          SETS auxiliary DHW module - power rating - electr
      icity intake [MW]
 398  n_sets_dhw_p_out         SETS auxiliary DHW module - power rating - DHW ou
      tput [MW]
 399  n_sets_dhw_e             SETS auxiliary DHW module - energy storage capaci
      ty [MWh]
 400  phi_heat_ini             Inititial storage level of heating technologies [
      0 1]
 401  temp_sink                Heat pumps - sink temperature [°Celsius]
 402  pen_heat_fuel            Penalty term for non-electric fuel usage for hybr
      id heating technologies [EUR per MWh]
 403  area_floor               Floor area subject to specific heating technology
       in specific building type [m2]
 404  theta_night              Indicator for night hours {0 1}
 405   
 406   
 407   
 408  ***************  DERIVED PARAMETERS  *************************************
      ******
 409   
 410  c_m              Marginal production costs for conventional plants includi
      ng variable O and M costs [EUR per MWh]
 411  c_i              Annualized investment costs by conventioanl plant [EUR pe
      r MW]
 412   
 413  c_i_res          Annualized investment costs by renewable plant [EUR per M
      W]
 414  c_fix_res        Annualized fixed costs by renewable plant [EUR per MW per
       a]
 415   
 416  c_i_sto_e        Annualized investment costs storage energy [EUR per MWh]
 417  c_i_sto_p        Annualized investment costs storage capacity [EUR per MW]
 418   
 419  c_i_rsvr_e       Annualized investment costs storage energy [EUR per MWh]
 420  c_i_rsvr_p       Annualized investment costs storage capacity [EUR per MW]
 421   
 422  c_i_dsm_cu       DSM: Annualized investment costs load curtailment [EUR pe
      r MW]
 423  c_i_dsm_shift    DSM: Annualized investment costs load shifting [EUR per M
      W]
 424   
 425  c_i_ntc          Investment for net transfer capacity [EUR per MW and km]
 426   
 427  phi_mean_reserves_call_y         Hourly mean of share reserves called per 
      year [0 1]
 428  phi_mean_reserves_call           Hourly mean of share reserves called [0 1
      ]
 429   
 430  theta_dir        Dummy equal to 1 if building type bu has direct heating t
      ype ch [0 1]
 431  theta_sets       Dummy equal to 1 if building type bu has SETS heating typ
      e ch [0 1]
 432  theta_hp         Dummy equal to 1 if building type bu has heat pump heatin
      g type ch [0 1]
 433  theta_elec       Dummy equal to 1 if building type bu has hybrif electric 
      heating - electric part [0 1]
 434  theta_fossil     Dummy equal to 1 if building type bu has hybrif electric 
      heating - fossil part [0 1]
 435  theta_storage    Dummy equal to 1 if building type ch has storage heating 
      type ch [0 1]
 436   
 437   
 438   
 439   
 440  ***************  PARAMETERS FOR DATA UPLOAD  *****************************
      ******
 441   
 442  technology_data_upload(tech,tech_res_con,tech_dispatch,headers_tech)
 443  technology_data(tech,headers_tech)
 444  storage_data(sto,headers_sto)
 445  reservoir_data(rsvr,headers_reservoir)
 446  time_data_upload(h,year,headers_time)
 447  dsm_data_upload(dsm,dsm_type,headers_dsm)
 448  dsm_data(dsm,headers_dsm)
 449  topology_data(l,headers_topology)
 450  ev_data(ev,headers_ev)
 451  ev_time_data_upload(h,headers_time_ev,ev)
 452  prosumage_data_generation(tech,headers_prosumage_generation)
 453  prosumage_data_storage(sto,headers_prosumage_storage)
 454  reserves_time_data_activation(h,year,reserves)
 455  reserves_time_data_provision(h,year,reserves)
 456  reserves_data_upload(reserves,reserves_up_down,reserves_spin_nonspin,reser
      ves_prim_nonprim,headers_reserves)
 457  reserves_data(reserves,headers_reserves)
 458  heat_data_upload(bu,ch,heat_storage,heat_hp,heat_elec,heat_fossil,headers_
      heat)
 459  heat_data(bu,ch,headers_heat)
 460  dh_upload(h,year,headers_time_heat,bu)
 461  d_dhw_upload(h,year,headers_time_heat,bu)
 462  temp_source_upload
 463  ;
 464   
 465   
 466   
 467   
 468  ***************  UPLOAD TIME-CONSTANT SETS AND PARAMETERS  ***************
      ******
 469   
 529   
 530  *%skip_Excel%
 532   
GDXIN   C:\Users\Lenovo\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Mod
        ule\Modified_MCP\Data_input.gdx
--- LOAD  tech = 2:tech
--- LOAD  headers_tech = 3:headers_tech
--- LOAD  tech_dispatch = 4:tech_dispatch
--- LOAD  tech_res_con = 5:tech_res_con
--- LOAD  sto = 6:sto
--- LOAD  headers_sto = 7:headers_sto
--- LOAD  rsvr = 8:rsvr
--- LOAD  headers_reservoir = 9:headers_reservoir
--- LOAD  reservoir_data = 31:reservoir_data
--- LOAD  dsm = 10:dsm
--- LOAD  headers_dsm = 11:headers_dsm
--- LOAD  dsm_type = 12:dsm_type
--- LOAD  technology_data_upload = 29:technology_data_upload
--- LOAD  storage_data = 30:storage_data
--- LOAD  dsm_data_upload = 32:dsm_data_upload
 537   
--- LOAD  ev = 13:ev
--- LOAD  headers_ev = 14:headers_ev
--- LOAD  ev_data = 34:ev_data
--- LOAD  headers_prosumage_generation = 15:headers_prosumage_generation
--- LOAD  headers_prosumage_storage = 16:headers_prosumage_storage
--- LOAD  prosumage_data_generation = 35:prosumage_data_generation
--- LOAD  prosumage_data_storage = 36:prosumage_data_storage
--- LOAD  reserves = 17:reserves
--- LOAD  reserves_up_down = 19:reserves_up_down
--- LOAD  reserves_spin_nonspin = 20:reserves_spin_nonspin
--- LOAD  reserves_prim_nonprim = 21:reserves_prim_nonprim
--- LOAD  headers_reserves = 18:headers_reserves
--- LOAD  reserves_data_upload = 37:reserves_data_upload
--- LOAD  bu = 22:bu
--- LOAD  ch = 23:ch
--- LOAD  heat_storage = 24:heat_storage
--- LOAD  heat_hp = 25:heat_hp
--- LOAD  heat_elec = 26:heat_elec
--- LOAD  heat_fossil = 27:heat_fossil
--- LOAD  headers_heat = 28:headers_heat
--- LOAD  heat_data_upload = 38:heat_data_upload
 542  ;
 543   
      parameter inc ;
      inc(l,n) = 1 ;
      $ontext
 549   
 550   
 551  ***************  UPLOAD TIME-SERIES SETS AND PARAMETERS  *****************
      ******
 552   
 578   
 579   
 580  *
GDXIN   C:\Users\Lenovo\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Mod
        ule\Modified_MCP\time_series.gdx
--- LOAD  h = 1:h
--- LOAD  headers_time = 2:headers_time
--- LOAD  year = 3:year
--- LOAD  time_data_upload = 4:time_data_upload
 584  *$load headers_time_ev ev_time_data_upload
 585  *$load reserves_time_data_activation
 586  *$load reserves_time_data_provision
 587  *$load headers_time_heat dh_upload
 588  *$load theta_night
 589  *$load temp_source_upload
 590  *$load headers_time_dhw d_dhw_upload nets_profile
 591  ;
 592   
 593   
 594   
 595   
 596  ***************  ASSIGNMENTS  ********************************************
      ******
 597   
 598   
 599   
 600  ***** Aliases *****
 601  alias (h,hh) ;
 602  alias (res,resres) ;
 603  alias (reserves,reservesreserves) ;
 604  alias (nondis,nondisnondis) ;
 605   
 606   
 607   
 608  ***** Derived sets *****
 609  dis(tech)$sum( (tech_res_con,headers_tech), technology_data_upload(tech,te
      ch_res_con,'dis',headers_tech)) = yes;
 610  nondis(tech)$sum( (tech_res_con,headers_tech), technology_data_upload(tech
      ,tech_res_con,'nondis',headers_tech)) = yes;
 611   
 612  con(tech)$sum( (tech_dispatch,headers_tech), technology_data_upload(tech,'
      con',tech_dispatch,headers_tech)) = yes;
 613  res(tech)$sum( (tech_dispatch,headers_tech), technology_data_upload(tech,'
      res',tech_dispatch,headers_tech)) = yes;
 614   
      reserves_up(reserves)$sum( (reserves_spin_nonspin,reserves_prim_nonprim,he
      aders_reserves), reserves_data_upload(reserves,'up',reserves_spin_nonspin,
      reserves_prim_nonprim,headers_reserves)) = yes;
      reserves_do(reserves)$sum( (reserves_spin_nonspin,reserves_prim_nonprim,he
      aders_reserves), reserves_data_upload(reserves,'do',reserves_spin_nonspin,
      reserves_prim_nonprim,headers_reserves)) = yes;
       
      reserves_spin(reserves)$sum( (reserves_up_down,reserves_prim_nonprim,heade
      rs_reserves), reserves_data_upload(reserves,reserves_up_down,'spin',reserv
      es_prim_nonprim,headers_reserves)) = yes;
      reserves_nonspin(reserves)$sum( (reserves_up_down,reserves_prim_nonprim,he
      aders_reserves), reserves_data_upload(reserves,reserves_up_down,'nonspin',
      reserves_prim_nonprim,headers_reserves)) = yes;
       
      reserves_prim(reserves)$sum( (reserves_up_down,reserves_spin_nonspin,heade
      rs_reserves), reserves_data_upload(reserves,reserves_up_down,reserves_spin
      _nonspin,'prim',headers_reserves)) = yes;
      reserves_nonprim(reserves)$sum( (reserves_up_down,reserves_spin_nonspin,he
      aders_reserves), reserves_data_upload(reserves,reserves_up_down,reserves_s
      pin_nonspin,'nonprim',headers_reserves)) = yes;
       
      reserves_prim_up(reserves)$sum( (reserves_spin_nonspin,headers_reserves), 
      reserves_data_upload(reserves,'up',reserves_spin_nonspin,'prim',headers_re
      serves)) = yes;
      reserves_prim_do(reserves)$sum( (reserves_spin_nonspin,headers_reserves), 
      reserves_data_upload(reserves,'do',reserves_spin_nonspin,'prim',headers_re
      serves)) = yes;
      reserves_nonprim_up(reserves)$sum( (reserves_spin_nonspin,headers_reserves
      ), reserves_data_upload(reserves,'up',reserves_spin_nonspin,'nonprim',head
      ers_reserves)) = yes;
      reserves_nonprim_do(reserves)$sum( (reserves_spin_nonspin,headers_reserves
      ), reserves_data_upload(reserves,'do',reserves_spin_nonspin,'nonprim',head
      ers_reserves)) = yes;
       
      hst(ch)$sum( (bu,heat_hp,heat_elec,heat_fossil,headers_heat), heat_data_up
      load(bu,ch,'yes',heat_hp,heat_elec,heat_fossil,headers_heat)) = yes;
      hp(ch)$sum( (bu,heat_storage,heat_elec,heat_fossil,headers_heat), heat_dat
      a_upload(bu,ch,heat_storage,'yes',heat_elec,heat_fossil,headers_heat)) = y
      es;
       
      hel(ch)$sum( (bu,heat_storage,heat_hp,heat_fossil,headers_heat), heat_data
      _upload(bu,ch,heat_storage,heat_hp,'yes',heat_fossil,headers_heat)) = yes;
      hfo(ch)$sum( (bu,heat_storage,heat_hp,heat_elec,headers_heat), heat_data_u
      pload(bu,ch,heat_storage,heat_hp,heat_elec,'yes',headers_heat)) = yes;
 636   
 637   
 638   
 639  ***** Parameters *****
 640   
 641  *--- Generation technologies ---*
 642  technology_data(tech,headers_tech) = sum((tech_res_con,tech_dispatch), tec
      hnology_data_upload(tech,tech_res_con,tech_dispatch,headers_tech)) ;
 643  eta(tech) = technology_data(tech,'eta_con') ;
 644  carbon_content(tech) = technology_data(tech,'carbon_content') ;
 645  c_up(dis) =technology_data(dis,'load change costs up') ;
 646  c_do(dis) = technology_data(dis,'load change costs down') ;
 647  c_fix(tech) = technology_data(tech,'fixed_costs') ;
 648  c_vom(tech) = technology_data(tech,'variable_om') ;
 649  CO2price(tech) = technology_data(tech,'CO2_price') ;
 650   
 651  c_inv_overnight(tech) = technology_data(tech,'oc') ;
 652  lifetime(tech) = technology_data(tech,'lifetime') ;
 653  recovery(tech) = technology_data(tech,'recovery_period') ;
 654  interest_rate(tech) = technology_data(tech,'interest_rate') ;
 655  m_p(tech) = technology_data(tech,'max_installable') ;
 656  m_e(tech) = technology_data(tech,'max_energy') ;
 657  grad_per_min(dis) = technology_data(dis,'load change flexibility') ;
 658  fuelprice(tech) = technology_data(tech,'fuel costs') ;
 659   
 660  c_cu(res) = technology_data(res,'curtailment_costs') ;
 661   
 662   
 663  *--- Storage technologies ---*
 664  c_m_sto(sto) = storage_data(sto,'mc');
 665  eta_sto(sto) = storage_data(sto,'efficiency');
 666  c_fix_sto(sto) = storage_data(sto,'fixed_costs');
 667  phi_sto_ini(sto) = storage_data(sto,'level_start');
 668  etop_max(sto) = storage_data(sto,'etop_max') ;
 669   
 670  c_inv_overnight_sto_e(sto) = storage_data(sto,'oc_energy');
 671  c_inv_overnight_sto_p(sto) = storage_data(sto,'oc_capacity');
 672  lifetime(sto) = storage_data(sto,'lifetime');
 673  interest_rate(sto) = storage_data(sto,'interest_rate');
 674  m_sto_e(sto) = storage_data(sto,'max_energy');
 675  m_sto_p(sto) = storage_data(sto,'max_power');
 676   
      *--- Reservoir technologies ---*
      c_m_rsvr(rsvr) = reservoir_data(rsvr,'mc');
      eta_rsvr(rsvr) = reservoir_data(rsvr,'efficiency');
      c_fix_rsvr(rsvr) = reservoir_data(rsvr,'fixed_costs');
      phi_rsvr_ini(rsvr) = reservoir_data(rsvr,'level_start');
      phi_rsvr_lev_min(rsvr) = reservoir_data(rsvr,'level_min');
       
      c_inv_overnight_rsvr_e(rsvr) = reservoir_data(rsvr,'oc_energy');
      c_inv_overnight_rsvr_p(rsvr) = reservoir_data(rsvr,'oc_capacity');
      inv_lifetime_rsvr(rsvr) = reservoir_data(rsvr,'lifetime');
      inv_interest_rsvr(rsvr) = reservoir_data(rsvr,'interest_rate');
      m_rsvr_e(rsvr) = reservoir_data(rsvr,'max_energy');
      m_rsvr_p(rsvr) = reservoir_data(rsvr,'max_power');
       
       
      *--- DSM technologies ---*
      dsm_curt(dsm)$sum( (dsm_type,headers_dsm), dsm_data_upload(dsm,'curt',head
      ers_dsm)) = yes;
      dsm_shift(dsm)$sum( (dsm_type,headers_dsm), dsm_data_upload(dsm,'shift',he
      aders_dsm)) = yes;
      dsm_data(dsm,headers_dsm) = sum(dsm_type, dsm_data_upload(dsm,dsm_type,hea
      ders_dsm) ) ;
       
      c_m_dsm_cu(dsm_curt) = dsm_data(dsm_curt,'mc')     ;
      c_m_dsm_shift(dsm_shift) = dsm_data(dsm_shift,'mc')  ;
      c_fix_dsm_cu(dsm_curt) = dsm_data(dsm_curt,'fc')  ;
      c_fix_dsm_shift(dsm_shift) = dsm_data(dsm_shift,'fc') ;
       
      t_dur_dsm_cu(dsm_curt) = dsm_data(dsm_curt,'max_duration')   ;
      t_off_dsm_cu(dsm_curt) = dsm_data(dsm_curt,'recovery_time')   ;
      t_dur_dsm_shift(dsm_shift) = dsm_data(dsm_shift,'max_duration')   ;
      t_off_dsm_shift(dsm_shift) = dsm_data(dsm_shift,'recovery_time')   ;
      eta_dsm_shift(dsm_shift)  = dsm_data(dsm_shift,'efficiency')   ;
       
      c_inv_overnight_dsm_cu(dsm_curt) =  dsm_data(dsm_curt,'oc')   ;
      c_inv_overnight_dsm_shift(dsm_shift)  =  dsm_data(dsm_shift,'oc')   ;
      inv_recovery_dsm_cu(dsm_curt)  =  dsm_data(dsm_curt,'lifetime')   ;
      inv_recovery_dsm_shift(dsm_shift)   =  dsm_data(dsm_shift,'lifetime')   ;
      inv_interest_dsm_cu(dsm_curt)   =  dsm_data(dsm_curt,'interest_rate')   ;
      inv_interest_dsm_shift(dsm_shift)  =  dsm_data(dsm_shift,'interest_rate') 
        ;
      m_dsm_cu(dsm_curt) =  dsm_data(dsm_curt,'max_installable')   ;
      m_dsm_shift(dsm_shift) =  dsm_data(dsm_shift,'max_installable')   ;
 718   
 719  *--- Temporal data ---*
 720  d_y(year,h) = time_data_upload(h,year,'demand')  ;
 721  phi_res_y(year,res,h) = sum(headers_time$(sameas(res,headers_time)), time_
      data_upload(h,year,headers_time));
 722   
 723  *rsvr_in_y(year,rsvr,h) = sum(headers_time$(sameas(rsvr,headers_time)), ti
      me_data_upload(h,year,headers_time));
 724  *phi_reserves_call_y(year,reserves,h) = reserves_time_data_activation(h,ye
      ar,reserves) ;
 725  *reserves_exogenous_y(year,reserves,h) = reserves_time_data_provision(h,ye
      ar,reserves) ;
 726   
 727   
 728  *--- Spatial data ---*
 729  *inv_lifetime_ntc(l) = topology_data(l,'lifetime') ;
 730  *inv_recovery_ntc(l) = topology_data(l,'recovery_period') ;
 731  *inv_interest_ntc(l) = topology_data(l,'interest_rate') ;
 732  *c_inv_overnight_ntc(l) = topology_data(l,'overnight_costs') ;
 733  *c_fix_ntc(l) = topology_data(l,'fixed_costs') ;
 734  *m_ntc(l) = topology_data(l,'max_installable') ;
 735  *dist(l) = topology_data(l,'distance') ;
 736   
      *--- Electric vehicles ---*
      c_m_ev(ev) = ev_data(ev,'mc') ;
      pen_phevfuel(ev) = ev_data(ev,'penalty_fuel') ;
      eta_ev_in(ev) = ev_data(ev,'efficiency_charge') ;
      eta_ev_out(ev) = ev_data(ev,'efficiency_discharge') ;
      phi_ev_ini(ev) = ev_data(ev,'ev_start') ;
       
      n_ev_e(ev) = ev_data(ev,'ev_capacity') ;
      phi_ev(ev) = ev_data(ev,'share_ev') ;
      ev_phev(ev) = ev_data(ev,'ev_type') ;
       
      n_ev_p(ev,h) = ev_time_data_upload(h,'n_ev_p',ev) ;
      ev_ed(ev,h) = ev_time_data_upload(h,'ev_ed',ev) ;
      ev_ged_exog(ev,h) = ev_time_data_upload(h,'ev_ged_exog',ev) ;
 753   
 754  *--- Prosumage ---*
 755  m_res_pro(res) = prosumage_data_generation(res,'max_power') ;
 756  m_sto_pro_e(sto) = prosumage_data_storage(sto,'max_energy') ;
 757  m_sto_pro_p(sto) = prosumage_data_storage(sto,'max_power') ;
 758  phi_sto_pro_ini(sto) = prosumage_data_storage(sto,'level_start') ;
 759   
      *--- Reserves ---*
      reserves_data(reserves,headers_reserves) = sum((reserves_up_down,reserves_
      spin_nonspin,reserves_prim_nonprim), reserves_data_upload(reserves,reserve
      s_up_down,reserves_spin_nonspin,reserves_prim_nonprim,headers_reserves)) ;
      phi_reserves_share(reserves) = reserves_data(reserves,'share_sr_mr') ;
      reserves_intercept(reserves) = reserves_data(reserves,'intercept') ;
      reserves_slope(reserves,'wind_on') = reserves_data(reserves,'slope_wind_on
      ') ;
      reserves_slope(reserves,'wind_off') = reserves_data(reserves,'slope_wind_o
      ff') ;
      reserves_slope(reserves,'pv') = reserves_data(reserves,'slope_pv') ;
      reserves_reaction(reserves) = reserves_data(reserves,'reaction_time') ;
      phi_reserves_pr_up(n) = reserves_data('PR_up','fraction_pr') ;
      phi_reserves_pr_do(n) = reserves_data('PR_do','fraction_pr') ;
       
       
      *--- Heat ---*
      heat_data(bu,ch,headers_heat) = sum((heat_storage,heat_hp,heat_elec,heat_f
      ossil), heat_data_upload(bu,ch,heat_storage,heat_hp,heat_elec,heat_fossil,
      headers_heat)) ;
      phi_heat_type(bu,ch) = heat_data(bu,ch,'share') ;
      dh_y(year,bu,ch,h) = phi_heat_type(bu,ch) * dh_upload(h,year,'demand',bu) 
      ;
      d_dhw_y(year,bu,ch,h) = phi_heat_type(bu,ch) * d_dhw_upload(h,year,'demand
      ',bu) ;
       
      eta_heat_stat(bu,ch) = heat_data(bu,ch,'static_efficiency') ;
      eta_heat_dyn(bu,ch) = heat_data(bu,ch,'dynamic_efficiency') ;
      eta_dhw_aux_stat(bu,ch) = heat_data(bu,ch,'static_efficiency_sets_aux_dhw'
      ) ;
      * currently not used
      n_heat_p_in(bu,ch) = heat_data(bu,ch,'max_power') ;
      n_heat_p_out(bu,ch) = heat_data(bu,ch,'max_outflow') ;
      n_heat_e(bu,ch) = heat_data(bu,ch,'max_level') ;
      n_sets_p_in(bu,ch) = heat_data(bu,ch,'max_power') ;
      n_sets_p_out(bu,ch) = heat_data(bu,ch,'max_outflow') ;
      n_sets_e(bu,ch) = heat_data(bu,ch,'max_level') ;
      n_sets_dhw_p_in(bu,ch) = heat_data(bu,ch,'max_power_in_sets_aux_dhw') ;
      n_sets_dhw_p_out(bu,ch) = heat_data(bu,ch,'max_power_out_sets_aux_dhw') ;
      n_sets_dhw_e(bu,ch) = heat_data(bu,ch,'max_energy_sets_aux_dhw') ;
      phi_heat_ini(bu,ch) = heat_data(bu,ch,'level_ini') ;
      temp_sink(bu,ch) = heat_data(bu,ch,'temperature_sink') ;
       
      temp_source(bu,'hp_as',h) = temp_source_upload(h,'hp_as') ;
      temp_source(bu,'hp_gs',h) = heat_data(bu,'hp_gs','temperature_source') ;
       
      temp_source(bu,'gas_hp_gs',h) = heat_data(bu,'gas_hp_gs','temperature_sour
      ce') ;
      temp_source(bu,'hp_gs_elec',h) = heat_data(bu,'hp_gs_elec','temperature_so
      urce') ;
       
      pen_heat_fuel(bu,ch) = heat_data(bu,ch,'penalty_non-electric_heat_supply')
       ;
       
      area_floor(bu,ch) = heat_data(bu,ch,'area_floor') ;
 805   
 806   
 807  ***************  CALCULATE DERIVED PARAMETERS  ***************************
      ******
 808   
 809  c_m(tech) = fuelprice(tech)/eta(tech) + carbon_content(tech)/eta(tech)*CO2
      price(tech) + c_vom(tech)   ;
 810   
 811  c_i(tech) = c_inv_overnight(tech)*( interest_rate(tech) * (1+interest_rate
      (tech))**(lifetime(tech)) )
 812                    / ( (1+interest_rate(tech))**(lifetime(tech))-1 )       
      ;
 813   
 814  c_i_res(res) = c_i(res) ;
 815  c_fix_res(res) = c_fix(res) ;
 816   
 817  c_i_sto_e(sto) = c_inv_overnight_sto_e(sto)*( interest_rate(sto) * (1+inte
      rest_rate(sto))**(lifetime(sto)) )
 818                   / ( (1+interest_rate(sto))**(lifetime(sto))-1 )       ;
 819   
 820  c_i_sto_p(sto) = c_inv_overnight_sto_p(sto)*( interest_rate(sto) * (1+inte
      rest_rate(sto))**(lifetime(sto)) )
 821                   / ( (1+interest_rate(sto))**(lifetime(sto))-1 )       ;
      c_i_rsvr_e(rsvr) = c_inv_overnight_rsvr_e(rsvr)*( inv_interest_rsvr(rsvr) 
      * (1+inv_interest_rsvr(rsvr))**(inv_lifetime_rsvr(rsvr)) )
                       / ( (1+inv_interest_rsvr(rsvr))**(inv_lifetime_rsvr(rsvr)
      )-1 )       ;
       
      c_i_rsvr_p(rsvr) = c_inv_overnight_rsvr_p(rsvr)*( inv_interest_rsvr(rsvr) 
      * (1+inv_interest_rsvr(rsvr))**(inv_lifetime_rsvr(rsvr)) )
                       / ( (1+inv_interest_rsvr(rsvr))**(inv_lifetime_rsvr(rsvr)
      )-1 )       ;
       
      c_i_dsm_cu(dsm_curt) =c_inv_overnight_dsm_cu(dsm_curt)*( inv_interest_dsm_
      cu(dsm_curt) * (1+inv_interest_dsm_cu(dsm_curt))**(inv_recovery_dsm_cu(dsm
      _curt)) )
                       / ( (1+inv_interest_dsm_cu(dsm_curt))**(inv_recovery_dsm_
      cu(dsm_curt))-1 )       ;
       
      c_i_dsm_shift(dsm_shift) = c_inv_overnight_dsm_shift(dsm_shift)*( inv_inte
      rest_dsm_shift(dsm_shift) * (1+inv_interest_dsm_shift(dsm_shift))**(inv_re
      covery_dsm_shift(dsm_shift)) )
                       / ( (1+inv_interest_dsm_shift(dsm_shift))**(inv_recovery_
      dsm_shift(dsm_shift))-1 )       ;
       
      c_i_ntc(l) = c_inv_overnight_ntc(l) * (inv_interest_ntc(l) * (1 + inv_inte
      rest_ntc(l))**(inv_lifetime_ntc(l)) )
                       / ((1 + inv_interest_ntc(l)) ** (inv_lifetime_ntc(l))-1 )
       ;
       
      phi_mean_reserves_call_y(year,reserves) = sum(h, phi_reserves_call_y(year,
      reserves,h) ) / card(h) + eps ;
       
       
      theta_sets(bu,'setsh')$(smax( (heat_storage,heat_hp,heat_elec,heat_fossil,
      headers_heat) , heat_data_upload(bu,'setsh',heat_storage,heat_hp,heat_elec
      ,heat_fossil,headers_heat)) > 0 AND phi_heat_type(bu,'setsh')) = 1;
      theta_dir(bu,'dir')$(smax((heat_storage,heat_hp,heat_elec,heat_fossil,head
      ers_heat) , heat_data_upload(bu,'dir',heat_storage,heat_hp,heat_elec,heat_
      fossil,headers_heat)) > 0 AND phi_heat_type(bu,'dir')) = 1;
       
      theta_storage(bu,ch)$(sum((heat_hp,heat_elec,heat_fossil,headers_heat), he
      at_data_upload(bu,ch,'yes',heat_hp,heat_elec,heat_fossil,headers_heat)) AN
      D phi_heat_type(bu,ch)) = 1;
      theta_hp(bu,ch)$sum( (heat_storage,heat_elec,heat_fossil,headers_heat), he
      at_data_upload(bu,ch,heat_storage,'yes',heat_elec,heat_fossil,headers_heat
      ) AND phi_heat_type(bu,ch)) = 1;
       
      theta_elec(bu,ch)$sum( (heat_storage,heat_hp,heat_fossil,headers_heat), he
      at_data_upload(bu,ch,heat_storage,heat_hp,'yes',heat_fossil,headers_heat) 
      AND phi_heat_type(bu,ch)) = 1;
      theta_fossil(bu,ch)$sum( (heat_storage,heat_hp,heat_elec,headers_heat), he
      at_data_upload(bu,ch,heat_storage,heat_hp,heat_elec,'yes',headers_heat) AN
      D phi_heat_type(bu,ch)) = 1;
 850   
 851   
 852  ***************  Adjust costs to model's hourly basis ********************
      ******
 853   
 854  c_i(tech) = c_i(tech)*card(h)/8760 ;
 855  c_i_res(tech) = c_i_res(tech)*card(h)/8760 ;
 856  c_i_sto_p(sto) = c_i_sto_p(sto)*card(h)/8760 ;
 857  c_i_sto_e(sto) = c_i_sto_e(sto)*card(h)/8760 ;
 858  *c_i_rsvr_e(rsvr) = c_i_rsvr_e(rsvr)*card(h)/8760 ;
 859  *c_i_rsvr_p(rsvr) = c_i_rsvr_p(rsvr)*card(h)/8760 ;
 860  *c_i_dsm_cu(dsm_curt) = c_i_dsm_cu(dsm_curt)*card(h)/8760 ;
 861  *c_i_dsm_shift(dsm_shift) = c_i_dsm_shift(dsm_shift)*card(h)/8760 ;
 862   
 863  c_fix(tech) = c_fix(tech)*card(h)/8760 ;
 864  c_fix_sto(sto) = c_fix_sto(sto)*card(h)/8760 ;
 865  *c_fix_dsm_cu(dsm_curt) = c_fix_dsm_cu(dsm_curt)*card(h)/8760 ;
 866  *c_fix_dsm_shift(dsm_shift) = c_fix_dsm_shift(dsm_shift)*card(h)/8760 ;
 867  *c_fix_rsvr(rsvr) = c_fix_rsvr(rsvr)*card(h)/8760 ;
 868   
 869  m_e('bio') = m_e('bio')*card(h)/8760 ;
 870   
 871  *c_i_ntc(l) = c_i_ntc(l) * card(h)/8760 ;
 872   
 873  *t_dur_dsm_cu(dsm_curt) = t_dur_dsm_cu(dsm_curt) ;
 874  *t_off_dsm_cu(dsm_curt) = t_off_dsm_cu(dsm_curt) ;
 875  *t_dur_dsm_shift(dsm_shift)$(ord(dsm_shift)=2 or ord(dsm_shift)=4 or ord(d
      sm_shift)=5) = t_dur_dsm_shift(dsm_shift) / 2 ;
 876  *t_dur_dsm_shift(dsm_shift)$(ord(dsm_shift)=1 or ord(dsm_shift)=3) = 2 ;
 877   
 878   
 879   
 880  **************************************************************************
      ******
 881   
 882   
 883   
 884   
 885   
 886   
 887   
 888   
 889   
 890  **************************************************************************
      ******
 891   
 892  ***************************
 893  ***** Initialize data *****
 894  ***************************
 895   
 896  * Parameters for default base year
 897  d(h) = d_y('2030',h) ;
 898  phi_res(res,h) = phi_res_y('2030',res,h) ;
 899  phi_min_res = 0 ;
 900  phi_pro_self = 0 ;
 901  phi_pro_load = 0 ;
 902   
      phi_pro_load = 0.2 ;
      $ontext
 907   
 908   
 909  Parameter
 910  phi_min_res_exog;
 911  phi_min_res_exog = 1 ;
 912   
 913  Sets
 914  h_ini(h)                       First hour  /h1/
 915  *h_end(h)                       Last hour   /h8760/
 916  ;
 917   
 918  **************************************************************************
      ******
 919  ***** Model *****
 920  **************************************************************************
      ******
 921   
INCLUDE    C:\Users\Lenovo\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_
           Module\Modified_MCP\model.gms
 923   
 924  **************************************************************************
      ******
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DI
      ETER).
      Version 1.3.0, October 2017.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses
      /mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
 934  **************************************************************************
      ******
 935   
 936   
 937  Variables
 938  Z                  Value objective function [Euro]
 939  lambda_enerbal     Dual variable on energy balance (1a)
 940  lambda_resgen      Dual variable on renewable generation (3e)
 941  lambda_convgen     Dual variable on conventional generation level (2a)
 942  lambda_stolev      Dual variable on storage level  (4b)
 943  lambda_stolev_i
 944  ;
 945   
 946  Positive Variables
 947  G_L(tech,h)            Generation level in hour h [MWh]
 948  G_UP(tech,h)           Generation upshift in hour h [MWh]
 949  G_DO(tech,h)           Generation downshift in hour h [MWh]
 950  G_RES(tech,h)          Generation renewables type res in hour h [MWh]
 951  CU(tech,h)             Renewables curtailment technology res in hour h [MW
      h]
 952   
 953  STO_IN(sto,h)          Storage inflow technology sto hour h [MWh]
 954  STO_OUT(sto,h)         Storage outflow technology sto hour h [MWh]
 955  STO_L(sto,h)           Storage level technology sto hour h [MWh]
 956   
 957  N_TECH(tech)           Technology tech built [MW]
 958  N_STO_E(sto)           Storage technology built - Energy [MWh]
 959  N_STO_P(sto)           Storage loading and discharging capacity built - Ca
      pacity [MW]
 960   
 961  CU_PRO(tech,h)                 Prosumage: curtailment of renewable generat
      ion in hour h [MWh]
 962  G_MARKET_PRO2M(tech,h)         Prosumage. energy sent to market in hour h 
      [MWh]
 963  G_MARKET_M2PRO(h)              Prosumage: withdrawal of energy from market
       in hour h [MWh]
 964  G_RES_PRO(tech,h)              Prosumage: hourly renewables generation in 
      hour h [MWh]
 965  STO_IN_PRO2PRO(tech,sto,h)     Prosumage: storage loading from generation 
      for discharging to consumption in hour h [MWh]
 966  STO_OUT_PRO2PRO(sto,h)         Prosumage: storage discharging to consumpti
      on from generation in hour h [MWh]
 967  STO_L_PRO2PRO(sto,h)           Prosumage: storage level generation to cons
      umption in hour h [MWh]
 968  N_STO_E_PRO(sto)               Prosumage: installed storage energy [MWh]
 969  N_STO_P_PRO(sto)               Prosumage: installed storage power [MW]
 970  N_RES_PRO(tech)                Prosumage: installed renewables capacities 
      [MW]
 971   
 972   
 973  mu_stoin_cap          Dual variable on storage loading capacity constraint
       (4d)
 974  mu_stout_cap          Dual variable on storage discharging capacity constr
      aint (4e)
 975  mu_stolev_cap         Dual variable on energy capacity constraint (4c)
 976  mu_conv_cap           Dual variable on conventional generation capacity co
      nstraint (3a)
 977  mu_bio_cap            Dual variable on storage bio energy constraint (5b)
 978  mu_dis_max_i          Dual variable on dispatchable installation constrain
      t (8a)
 979  mu_nondis_max_i       Dual variable on nondispatchable installation constr
      aint (8a)
 980  mu_tech_max_i         Dual variable on tech installation constraint (8a)
 981  mu_stop_max_i         Dual variable on storage power installation constrai
      nt  (8c)
 982  mu_stoe_max_i         Dual variable on storage energy installation constra
      int  (8b)
 983  mu_minRES             Dual variable on minimum renewable share constraint 
      (5a)
 984   
 985  ;
 986   
 987  Set
 988  dis_bio(tech)          Subset of dispatchable technology: Bio mass        
      /bio/
 989  ;
 990   
 991   
 992  **************************************************************************
      ******
 993   
 994  Equations
 995  * Objective
 996  obj                      Objective cost minimization
 997   
 998  * Energy balance
 999  con1a_bal                Energy Balance
1000   
1001  * Load change costs
1002  con2a_loadlevel          Load change costs: Level
1003  con2b_loadlevelstart     Load change costs: Level for first period
1004  con2_loadlevel           Load change costs: Level of all periods (2a+2b)
1005  * Capacity contraints and flexibility constraints
1006  con3a_maxprod_dispatchable       Capacity Constraint conventionals
1007  con3e_maxprod_res                Capacity constraints renewables
1008   
1009  * Storage constraints
1010  con4a_stolev_start        Storage Level Dynamics Initial Condition
1011  con4b_stolev              Storage Level Dynamics
1012  con4_stolev               Storage Level Dynamics all periods(4a + 4b)
1013  con4c_stolev_max          Storage Power Capacity
1014  con4d_maxin_sto           Storage maximum inflow
1015  con4e_maxout_sto          Storage maximum outflow
1016  con4j_ending              End level equal to initial level
1017  con4k_PHS_EtoP            Maximum E-P ratio
1018   
1019  * Minimum restrictions for renewables and biomass
1020  con5a_minRES             Minimum yearly renewables requirement
1021  con5b_max_energy         Maximum yearly biomass energy
1022   
1023  * Maximum installation conditions
1024  con8a_max_I_power                Maximum installable capacity: Conventiona
      ls
1025  con8b_max_I_sto_e                Maximum installable energy: Storage energ
      y in MWh
1026  con8c_max_I_sto_p                Maximum installable capacity: Storage inf
      low-outflow in MW
1027   
1028  con8f_max_pro_res                Maximum installable capacity: prosumage r
      enewables
1029  con8g_max_pro_sto_e              Maximum installable capacity: prosumage s
      torage energy
1030  con8h_max_sto_pro_p              Maximum installable capacity: prosumage s
      torage power
1031   
1032  * Prosumage
1033  con11a_pro_distrib                       Prosumage: distribution of genera
      ted energy
1034  con11b_pro_balance                       Prosumage: energy balance
1035  con11c_pro_selfcon                       Prosumage: minimum self-generatio
      n requirement
1036  con11d_pro_stolev_PRO2PRO                Prosumage: storage level prosumag
      er-to-prosumagers
1037  con11h_1_pro_stolev_start_PRO2PRO        Prosumage: storage level initial 
      conditions
1038  con11j_pro_stolev_max                    Prosumage: maximum overall storag
      e level
1039  con11k_pro_maxin_sto                     Prosumage: maximum storage inflow
1040  con11l_pro_maxout_sto                    Prosumage: maximum storage outflo
      w
1041  con11o_pro_ending                        Prosumage: storage ending conditi
      on
1042   
1043   
1044  * KKT optimality conditions
1045  KKTG_L                   KKT w.r.t. G_L
1046  KKTG_UP                  KKT w.r.t. G_UP
1047  KKTG_DO                  KKT w.r.t. G_DO
1048  KKTG_RES                 KKT w.r.t. G_RES
1049  KKTCU                    KKT w.r.t. CU
1050  KKTSTO_IN                KKT w.r.t. STO_IN
1051  KKTSTO_OUT               KKT w.r.t. STO_OUT
1052  KKTSTO_L                 KKT w.r.t. STO_L
1053  KKTN_TECH_NONDIS         KKT w.r.t. N_TECH(nondis)
1054  KKTN_TECH_DIS            KKT w.r.t. N_TECH(dis)
1055  KKTN_TECH                KKT w.r.t. N_TECH
1056  KKTN_STO_E               KKT w.r.t. N_STO_E
1057  KKTN_STO_P               KKT w.r.t. N_STO_P
1058  ;
1059   
1060   
1061  **************************************************************************
      ******
1062   
1063  * ------------------------------------------------------------------------
      ---- *
1064  ***** Objective function *****
1065  * ------------------------------------------------------------------------
      ---- *
1066   
1067  obj..
1068           Z =E=
1069                     sum( (h,dis) , c_m(dis)*G_L(dis,h) )
1070                   + sum( (h,dis)$(ord(h)>1) , c_up(dis)*G_UP(dis,h) )
1071                   + sum( (h,dis) , c_do(dis)*G_DO(dis,h) )
1072                   + sum( (h,nondis) , c_cu(nondis)*CU(nondis,h) )
1073                   + sum( (h,sto) , c_m_sto(sto) * ( STO_OUT(sto,h) + STO_IN
      (sto,h) ) )
1074                   + sum( tech , c_i(tech)*N_TECH(tech) )
1075                   + sum( tech , c_fix(tech)*N_TECH(tech) )
1076                   + sum( sto , c_i_sto_e(sto)*N_STO_E(sto) )
1077                   + sum( sto , c_fix_sto(sto)/2*(N_STO_P(sto)+ N_STO_E(sto)
      ) )
1078                   + sum( sto , c_i_sto_p(sto)*N_STO_P(sto) )
                       + sum( res , c_i(res)*N_RES_PRO(res) )
                       + sum( res , c_fix(res)*N_RES_PRO(res) )
                       + sum( sto , c_i_sto_e(sto)*N_STO_E_PRO(sto) )
                       + sum( sto , c_fix_sto(sto)/2*(N_STO_P_PRO(sto) + N_STO_E
      _PRO(sto)) )
                       + sum( sto , c_i_sto_p(sto)*N_STO_P_PRO(sto) )
                       + sum( (h,sto) , c_m_sto(sto) * ( STO_OUT_PRO2PRO(sto,h) 
      + sum( res , STO_IN_PRO2PRO(res,sto,h)) ) )
      $ontext
1088  ;
1089   
1090  * ------------------------------------------------------------------------
      ---- *
1091  ***** Energy balance and load levels *****
1092  * ------------------------------------------------------------------------
      ---- *
1093   
1094  * Energy balance
1095  con1a_bal(h)..
1096   
1097             sum( dis , G_L(dis,h)) + sum( nondis , G_RES(nondis,h)) + sum( 
      sto , STO_OUT(sto,h) )
               + sum( res , G_MARKET_PRO2M(res,h) )
      $ontext
1102           -  ( 1 - phi_pro_load )* d(h)
1103           -   sum( sto , STO_IN(sto,h) )
1104   
               - G_MARKET_M2PRO(h)
      $ontext
1109   
1110         =E= 0
1111  ;
1112   
1113  con2a_loadlevel(dis,h)$(ord(h) > 1)..
1114           G_L(dis,h-1) + G_UP(dis,h) - G_DO(dis,h)  - G_L(dis,h) =E= 0
1115  ;
1116   
1117  con2b_loadlevelstart(dis,h)$(ord(h) = 1)..
1118          G_UP(dis,h) - G_L(dis,h) =E= 0
1119  ;
1120   
1121  con2_loadlevel(dis,h)..
1122             G_UP(dis,h)  - G_L(dis,h)
1123          +  (G_L(dis,h-1) - G_DO(dis,h))$(ord(h) > 1)
1124          =E= 0
1125  ;
1126   
1127   
1128   
1129  * ------------------------------------------------------------------------
      ---- *
1130  ***** Hourly maximum generation caps *****
1131  * ------------------------------------------------------------------------
      ---- *
1132   
1133  con3a_maxprod_dispatchable(dis,h)..
1134   
1135           N_TECH(dis) -  G_L(dis,h)  =G= 0
1136   
1137  ;
1138   
1139  con3e_maxprod_res(nondis,h)..
1140   
1141   
1142         phi_res(nondis,h)*N_TECH(nondis) - G_RES(nondis,h) - CU(nondis,h) =
      E= 0
1143  ;
1144   
1145  * ------------------------------------------------------------------------
      ---- *
1146  ***** Storage constraints *****
1147  * ------------------------------------------------------------------------
      ---- *
1148   
1149  con4a_stolev_start(sto,h)$h_ini(h)..
1150          phi_sto_ini(sto) * N_STO_E(sto) + STO_IN(sto,h)*(1+eta_sto(sto))/2
       - STO_OUT(sto,h)/(1+eta_sto(sto))*2  - STO_L(sto,h)  =E= 0
1151  ;
1152   
1153  con4b_stolev(sto,h)$(ord(h)>1)..
1154          STO_L(sto,h-1) + STO_IN(sto,h)*(1+eta_sto(sto))/2 - STO_OUT(sto,h)
      /(1+eta_sto(sto))*2  -  STO_L(sto,h) =E= 0
1155  ;
1156   
1157  con4_stolev(sto,h)..
1158   
1159         + STO_IN(sto,h)*(1+eta_sto(sto))/2 - STO_OUT(sto,h)/(1+eta_sto(sto)
      )*2  -  STO_L(sto,h)
1160  *       + (phi_sto_ini(sto)*N_STO_E(sto))$(ord(h) = 1)
1161         + (STO_L(sto,h-1))$(ord(h)>1)
1162         =E= 0
1163  ;
1164   
1165   
1166  con4c_stolev_max(sto,h)..
1167         N_STO_E(sto) -  STO_L(sto,h) =G= 0
1168  ;
1169   
1170  con4d_maxin_sto(sto,h)..
1171   
1172          N_STO_P(sto) -  STO_IN(sto,h)   =G= 0
1173  ;
1174   
1175  con4e_maxout_sto(sto,h)..
1176   
1177          N_STO_P(sto) - STO_OUT(sto,h)   =G= 0
1178  ;
1179   
1180  con4j_ending(sto,h)$(ord(h) = card(h))..
1181   
1182          phi_sto_ini(sto) * N_STO_E(sto) -  STO_L(sto,h) =E= 0
1183  ;
1184   
1185   
1186  con4k_PHS_EtoP(sto)..
1187           etop_max(sto) * N_STO_P(sto) - N_STO_E(sto) =G= 0
1188  ;
1189   
1190  * ------------------------------------------------------------------------
      ---- *
1191  ***** Quotas for renewables and biomass *****
1192  * ------------------------------------------------------------------------
      ---- *
1193   
1194  con5a_minRES..
1195  sum( h , G_L('bio',h) + sum(nondis , G_RES(nondis,h))
1196   
               + sum( (sto) , STO_OUT_PRO2PRO(sto,h) + sum( (res) , G_MARKET_PRO
      2M(res,h) + G_RES_PRO(res,h))
      $ontext
1201  )
1202          - phi_min_res * phi_min_res_exog * sum( h ,
1203           sum( (dis) , G_L(dis,h)) + sum( (nondis) , G_RES(nondis,h))
1204   
               + sum( (res) , phi_res(res,h) * N_RES_PRO(res) - CU_PRO(res,h))
      $ontext
1209           )  =G= 0
1210  ;
1211   
1212  con5b_max_energy(tech)$dis_bio(tech)..
1213           m_e(tech) -  sum( h , G_L(tech,h) ) =G= 0
1214  ;
1215   
1216   
1217  * ------------------------------------------------------------------------
      ---- *
1218  ***** Maximum installation constraints *****
1219  * ------------------------------------------------------------------------
      ---- *
1220   
1221  con8a_max_I_power(tech)..
1222         m_p(tech) - N_TECH(tech)     =G= 0
1223  ;
1224   
1225  con8b_max_I_sto_e(sto)..
1226         m_sto_e(sto) - N_STO_E(sto)  =G= 0
1227  ;
1228   
1229  con8c_max_I_sto_p(sto)..
1230         m_sto_p(sto) -  N_STO_P(sto) =G= 0
1231  ;
1232   
1233   
1234   
1235  con8f_max_pro_res(res)..
1236         m_res_pro(res) -  N_RES_PRO(res)     =G= 0
1237  ;
1238   
1239  con8g_max_pro_sto_e(sto)..
1240         m_sto_pro_e(sto) -  N_STO_E_PRO(sto) =G= 0
1241  ;
1242   
1243  con8h_max_sto_pro_p(sto)..
1244          m_sto_pro_p(sto) -  N_STO_P_PRO(sto) =G= 0
1245  ;
1246   
1247  * ------------------------------------------------------------------------
      ---- *
1248  ***** Prosumage constraints *****
1249  * ------------------------------------------------------------------------
      ---- *
1250   
1251  con11a_pro_distrib(res,h)..
1252           phi_res(res,h) * N_RES_PRO(res)
1253           =E=
1254           CU_PRO(res,h) + G_MARKET_PRO2M(res,h) + G_RES_PRO(res,h) + sum( s
      to , STO_IN_PRO2PRO(res,sto,h) )
1255  ;
1256   
1257  con11b_pro_balance(h)..
1258           phi_pro_load * d(h)
1259           =E=
1260           sum( res , G_RES_PRO(res,h)) + sum( sto , STO_OUT_PRO2PRO(sto,h) 
      ) + G_MARKET_M2PRO(h)
1261  ;
1262   
1263  con11c_pro_selfcon..
1264           sum( (h,res) , G_RES_PRO(res,h) ) + sum( (h,sto) , STO_OUT_PRO2PR
      O(sto,h) )
1265           =G=
1266           phi_pro_self * sum( h , phi_pro_load * d(h))
1267  ;
1268   
1269  con11d_pro_stolev_PRO2PRO(sto,h)$(ord(h) > 1 )..
1270           STO_L_PRO2PRO(sto,h) =E= STO_L_PRO2PRO(sto,h-1) + sum( res , STO_
      IN_PRO2PRO(res,sto,h))*(1+eta_sto(sto))/2 - STO_OUT_PRO2PRO(sto,h)/(1+eta_
      sto(sto))*2
1271  ;
1272   
1273   
1274  con11h_1_pro_stolev_start_PRO2PRO(sto,h)$( ord(h) = 1)..
1275          STO_L_PRO2PRO(sto,h) =E=   phi_sto_pro_ini(sto) * N_STO_E_PRO(sto)
       + sum( res , STO_IN_PRO2PRO(res,sto,h))*(1+eta_sto(sto))/2 - STO_OUT_PRO2
      PRO(sto,h)/(1+eta_sto(sto))*2
1276  ;
1277   
1278   
1279  con11j_pro_stolev_max(sto,h)..
1280         N_STO_E_PRO(sto) - STO_L_PRO2PRO(sto,h) =G= 0
1281  ;
1282   
1283  con11k_pro_maxin_sto(sto,h)..
1284          N_STO_P_PRO(sto) - sum( res , STO_IN_PRO2PRO(res,sto,h) )
1285          =G= 0
1286  ;
1287   
1288  con11l_pro_maxout_sto(sto,h)..
1289          N_STO_P_PRO(sto) - STO_OUT_PRO2PRO(sto,h)
1290          =G= 0
1291  ;
1292   
1293  con11o_pro_ending(sto,h)$( ord(h) = card(h))..
1294           STO_L_PRO2PRO(sto,h) =E= phi_sto_pro_ini(sto) * N_STO_E_PRO(sto)
1295  ;
1296   
1297  * ------------------------------------------------------------------------
      ---- *
1298  ***** FOC conditions *****
1299  * ------------------------------------------------------------------------
      ---- *
1300   
1301  KKTG_L(tech,h)$dis(tech)..
1302   
1303      + c_m(tech)
1304      - lambda_enerbal(h)
1305      +  lambda_convgen(tech,h)
1306      + mu_conv_cap(tech,h)
1307  *    + mu_minRES*phi_min_res*phi_min_res_exog
1308      + (mu_bio_cap(tech))$dis_bio(tech)
1309  *    - mu_minRES$dis_bio(tech)
1310     - (lambda_convgen(tech,h+1))$(ord(h) > 1)
1311      =G= 0
1312   
1313  ;
1314   
1315  KKTG_UP(dis,h)..
1316   
1317       - lambda_convgen(dis,h)
1318       + (c_up(dis))$(ord(h)> 1)
1319     =G= 0
1320   
1321  ;
1322   
1323  KKTG_DO(dis,h)..
1324   
1325       + c_do(dis)
1326       + (lambda_convgen(dis,h))$(ord(h) > 1)
1327       =G= 0
1328   
1329  ;
1330   
1331  KKTG_RES(nondis,h)..
1332   
1333       - lambda_enerbal(h) + lambda_resgen(nondis,h)
1334  *     + mu_minRES*(phi_min_res*phi_min_res_exog - 1)
1335       =G= 0
1336  ;
1337   
1338  KKTCU(nondis,h)..
1339   
1340       c_cu(nondis) + lambda_resgen(nondis,h) =G= 0
1341   
1342  ;
1343   
1344  KKTSTO_IN(sto,h)..
1345   
1346      c_m_sto(sto)  + lambda_enerbal(h)
1347      -  (1+eta_sto(sto))/2*lambda_stolev(sto,h)$(ord(h) > 1 )
1348      - (1+eta_sto(sto))/2*lambda_stolev_i(sto,h)$h_ini(h)
1349      + mu_stoin_cap(sto,h) =G= 0
1350  ;
1351   
1352  KKTSTO_OUT(sto,h)..
1353   
1354       c_m_sto(sto)  -  lambda_enerbal(h)
1355       +  1/(1+eta_sto(sto))*2*lambda_stolev(sto,h)$(ord(h) > 1)
1356       +  1/(1+eta_sto(sto))*2*lambda_stolev_i(sto,h)$h_ini(h)
1357       +  mu_stout_cap(sto,h)
1358        =G= 0
1359  ;
1360   
1361  KKTSTO_L(sto,h)..
1362   
1363    + lambda_stolev(sto,h)$(ord(h) > 1 )
1364    + lambda_stolev_i(sto,h)$h_ini(h)
1365    +  mu_stolev_cap(sto,h)
1366    -  (lambda_stolev(sto,h+1))$(ord(h) > 1 )
1367   
1368    =G= 0
1369   
1370  ;
1371   
      KKTN_TECH_NONDIS(nondis)..
       
          c_i(nondis) +  c_fix(nondis)
          - sum( h,  lambda_resgen(nondis,h)*phi_res(nondis,h)) + mu_nondis_max_
      i(nondis)
          =G= 0
      ;
       
      KKTN_TECH_DIS(dis)..
       
           c_i(dis) +  c_fix(dis) - sum( h,  lambda_convgen(dis,h)) +  mu_dis_ma
      x_i(dis)
           =G= 0
       
      ;
1387   
1388  KKTN_TECH(tech)..
1389   
1390            +  c_i(tech)
1391            +  c_fix(tech)
1392            +  mu_tech_max_i(tech)
1393            - sum( h,   mu_conv_cap(tech,h))$dis(tech)
1394            - sum( h,  lambda_resgen(tech,h)*phi_res(tech,h))$nondis(tech)
1395       =G= 0
1396   
1397  ;
1398   
1399   
1400   
1401  KKTN_STO_E(sto)..
1402   
1403        +  c_fix_sto(sto)/2 +  c_i_sto_e(sto)
1404        -  sum( h,   mu_stolev_cap(sto,h))
1405        +  mu_stoe_max_i(sto)
1406        -  phi_sto_ini(sto)*lambda_stolev_i(sto,'h1')
1407        =G= 0
1408  ;
1409   
1410  KKTN_STO_P(sto)..
1411   
1412   
1413       c_fix_sto(sto)/2 + c_i_sto_p(sto)
1414       - sum( h, (mu_stoin_cap(sto,h) + mu_stout_cap(sto,h)))
1415       + mu_stop_max_i(sto)
1416       =G= 0
1417   
1418  ;
1419   
1420   
1421  **************************************************************************
      ******
1422  ***** Fix unmatched variables of first period *****
1423  **************************************************************************
      ******
1424   
1425  G_DO.fx(dis,'h1') = 0;
1426   
1427  * Default for reporting
1428  G_DO.l(dis,h) = 0;
1429  G_L.l(dis,h) = 0 ;
1430  G_UP.l(dis,h) = 0 ;
1431  G_RES.l(tech,h)= 0;
1432  CU.l(tech,h) = 0;
1433   
1434  STO_IN.l(sto,h)= 0;
1435  STO_OUT.l(sto,h)= 0;
1436  STO_L.l(sto,h) = 0;
1437   
1438  N_TECH.l(tech)= 0;
1439  N_STO_E.l(sto)= 0;
1440  N_STO_P.l(sto)= 0;
1441   
1442   
1443  **************************************************************************
      ******
1444  ***** MODEL *****
1445  **************************************************************************
      ******
1446   
1447  model DIETER /
1448  obj
1449   
1450  con1a_bal
1451   
1452  *con2a_loadlevel
1453  *con2b_loadlevelstart
1454  con2_loadlevel
1455   
1456  con3a_maxprod_dispatchable
1457  con3e_maxprod_res
1458   
1459  con4a_stolev_start
1460  con4b_stolev
1461  *con4_stolev
1462  con4c_stolev_max
1463  con4d_maxin_sto
1464  con4e_maxout_sto
1465  *con4k_PHS_EtoP
1466  *con4j_ending
1467   
1468  con5a_minRES
1469  con5b_max_energy
1470   
1471  con8a_max_I_power
1472  con8b_max_I_sto_e
1473  con8c_max_I_sto_p
1474   
1475   
1476   
      con8f_max_pro_res
      con8g_max_pro_sto_e
      con8h_max_sto_pro_p
      con11a_pro_distrib
      con11b_pro_balance
      con11c_pro_selfcon
      con11d_pro_stolev_PRO2PRO
      con11h_1_pro_stolev_start_PRO2PRO
      con11j_pro_stolev_max
      con11k_pro_maxin_sto
      con11l_pro_maxout_sto
      con11o_pro_ending
      $ontext
1492   
1493  /;
1494   
1495  model DIETER_MCP /
1496   
1497   
1498  con1a_bal.lambda_enerbal
1499  con2_loadlevel.lambda_convgen
1500   
1501  con3a_maxprod_dispatchable.mu_conv_cap
1502  con3e_maxprod_res.lambda_resgen
1503   
1504  con4b_stolev.lambda_stolev
1505  con4a_stolev_start.lambda_stolev_i
1506   
1507  con4c_stolev_max.mu_stolev_cap
1508  con4d_maxin_sto.mu_stoin_cap
1509  con4e_maxout_sto.mu_stout_cap
1510  *con4j_ending
1511  *con5a_minRES.mu_minRES
1512  con5b_max_energy.mu_bio_cap
1513  con8a_max_I_power.mu_tech_max_i
1514  con8b_max_I_sto_e.mu_stoe_max_i
1515  con8c_max_I_sto_p.mu_stop_max_i
1516   
1517  KKTG_L.G_L
1518  KKTG_UP.G_UP
1519  KKTG_DO.G_DO
1520  KKTG_RES.G_RES
1521  KKTCU.CU
1522  KKTSTO_IN.STO_IN
1523  KKTSTO_OUT.STO_OUT
1524  KKTSTO_L.STO_L
1525  KKTN_TECH.N_TECH
1526  KKTN_STO_E.N_STO_E
1527  KKTN_STO_P.N_STO_P
1528   
1529  / ;
1530   
1531  **************************************************************************
      ******
1532  ***** Options, fixings, report preparation *****
1533  **************************************************************************
      ******
1534   
1535  * Solver options
1541   
      $onecho > cplex.opt
      lpmethod 4
      threads 4
      epgap 1e-3
      barcrossalg -1
      barepcomp 1e-8
      $offecho
      $ontext
1552   
1553  dieter.OptFile = 1;
1554  dieter.holdFixed = 1 ;
1555   
1556   
1557  **************************************************************************
      ******
1558  ***** Solve *****
1559  **************************************************************************
      ******
1560   
1561  * Preparation of GUSS tool for scenario analysis
1562  phi_min_res = eps ;
1563  phi_pro_self = eps ;
1564   
1566   
1567  Set
1568  modelstats       model stats collection                  /modelstat, solve
      stat, resusd/
1569  superscen        Scenarios                               /scen1*scen1000/
1570  map(superscen,loop_res_share,loop_prosumage)    /#superscen:(#loop_res_sha
      re.#loop_prosumage)/
1571  ;
1572   
1573  set
1574  scen(superscen);
1575  scen(superscen) = yes$( sum((loop_res_share,loop_prosumage) , map(supersce
      n,loop_res_share,loop_prosumage)) )    ;
1576   
1577  Parameters
1578  gussoptions                              /Logoption 2, Optfile 1, Skipbase
      case 1/
1579  modstats(superscen, modelstats)
1580  min_res
1581  pro_selfcon
1582  ;
1583   
1584  min_res(scen)     = sum( (loop_res_share,loop_prosumage)$map(scen,loop_res
      _share,loop_prosumage) , loop_res_share.val/100 ) ;
1585  pro_selfcon(scen) = sum( (loop_res_share,loop_prosumage)$map(scen,loop_res
      _share,loop_prosumage) , loop_prosumage.val/100 ) ;
1586   
1587  Parameters
1588  * Equations
1589  marginal_con5a(superscen)
1590  marginal_con1a(superscen,*)
1591  marginal_con9a(superscen,*,*,*)
1592  marginal_con9b(superscen,*,*,*)
1593   
1594  * Basic
1595  lev_Z(superscen)
1596  lev_G_L(superscen,tech,h)
1597  lev_G_UP(superscen,tech,h)
1598  lev_G_DO(superscen,tech,h)
1599  lev_G_RES(superscen,tech,h)
1600  lev_CU(superscen,tech,h)
1601  lev_STO_IN(superscen,sto,h)
1602  lev_STO_OUT(superscen,sto,h)
1603  lev_STO_L(superscen,sto,h)
1604  lev_N_TECH(superscen,tech)
1605  lev_N_STO_E(superscen,sto)
1606  lev_N_STO_P(superscen,sto)
1607   
1608   
1609  * Prosumage
1610  lev_CU_PRO(superscen,tech,h)
1611  lev_G_MARKET_PRO2M(superscen,tech,h)
1612  lev_G_MARKET_M2PRO(superscen,h)
1613  lev_G_RES_PRO(superscen,tech,h)
1614  lev_STO_IN_PRO2PRO(superscen,tech,sto,h)
1615  lev_STO_IN_PRO2M(superscen,tech,sto,h)
1616  lev_STO_IN_M2PRO(superscen,sto,h)
1617  lev_STO_IN_M2M(superscen,sto,h)
1618  lev_STO_OUT_PRO2PRO(superscen,sto,h)
1619  lev_STO_OUT_PRO2M(superscen,sto,h)
1620  lev_STO_OUT_M2PRO(superscen,sto,h)
1621  lev_STO_OUT_M2M(superscen,sto,h)
1622  lev_STO_L_PRO2PRO(superscen,sto,h)
1623  lev_STO_L_PRO2M(superscen,sto,h)
1624  lev_STO_L_M2PRO(superscen,sto,h)
1625  lev_STO_L_M2M(superscen,sto,h)
1626  lev_N_STO_E_PRO(superscen,sto)
1627  lev_N_STO_P_PRO(superscen,sto)
1628  lev_STO_L_PRO(superscen,sto,h)
1629  lev_N_RES_PRO(superscen,tech)
1630  ;
1631   
1632   
1633  * Inclusion of scenario and fixing
INCLUDE    C:\Users\Lenovo\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_
           Module\Modified_MCP\fix.gms
1635   
1636  **************************************************************************
      ******
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DI
      ETER).
      Version 1.3.0, October 2017.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses
      /mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
1646  **************************************************************************
      ******
1647   
1648   
1649   
1650  **************************************************************************
      ******
1651  **** Run of river  *******************************************************
      ******
1652  **************************************************************************
      ******
1653   
1654  * If $setglobal ror_parameter "*": choose appropriate value for N_CON.fx('
      ror') (but no reserve provision):
1655   
1656  *$ontext
1657  N_TECH.fx('ror') = 5857.47 ;
1658  G_RES.fx('ror',h) = N_TECH.l('ror') * phi_res('ror',h) ;
1661   
1662  * Fix everything to zero in case no ROR option is selected:
1663  *N_TECH.fx('ror') = 0 ;
1664  *G_RES.fx('ror',h) = 0 ;
1665  *%ror_parameter%%ror_variable%RP_NONDIS.fx('ror',h) = 0 ;
1666   
1667   
1668  **************************************************************************
      ******
1669  **** No storage and DSM in first period  *********************************
      ******
1670  **************************************************************************
      ******
1671   
1672  ** No storage inflow in first period **
1673  STO_IN.fx(sto,h)$(ord(h) = 1) = 0;
1674   
1675   
1676   
1677  **************************************************************************
      ******
1678  **** No primary reserves by heating devices  *****************************
      ******
1679  **************************************************************************
      ******
1680   
1681   
1682  **************************************************************************
      ******
1683  **** Fixing to reduce model size  ****************************************
      ******
1684  **************************************************************************
      ******
1685   
1686  *F.fx(l,h)$(m_ntc(l) = 0) = 0 ;
1687  *NTC.fx(l)$(m_ntc(l) = 0) = 0 ;
1688   
1689  G_L.fx(tech,h)$(m_p(tech) = 0) = 0 ;
1690  G_UP.fx(tech,h)$(m_p(tech) = 0) = 0 ;
1691  G_DO.fx(tech,h)$(m_p(tech) = 0) = 0 ;
1692  N_TECH.fx(tech)$(m_p(tech) = 0) = 0 ;
1693  G_RES.fx(tech,h)$(m_p(tech) = 0) = 0 ;
1694  CU.fx(tech,h)$(m_p(tech) = 0) = 0 ;
1695   
1696  N_STO_P.fx(sto)$(m_sto_p(sto) = 0) = 0 ;
1697  N_STO_E.fx(sto)$(m_sto_e(sto) = 0) = 0 ;
1698  STO_IN.fx(sto,h)$(m_sto_p(sto) = 0) = 0 ;
1699  STO_OUT.fx(sto,h)$(m_sto_p(sto) = 0) = 0 ;
1700  STO_L.fx(sto,h)$(m_sto_p(sto) = 0) = 0 ;
1701   
1702   
1703  Variables
1704  STO_IN_PRO2M(tech,sto,h)
1705  STO_IN_M2PRO(sto,h)
1706  STO_IN_M2M(sto,h)
1707  STO_OUT_PRO2M(sto,h)
1708  STO_OUT_M2PRO(sto,h)
1709  STO_OUT_M2M(sto,h)
1710  STO_L_PRO(sto,h)
1711  STO_L_PRO2M(sto,h)
1712  STO_L_M2PRO(sto,h)
1713  STO_L_M2M(sto,h)
1714  ;
1715   
      CU_PRO.fx(res,h)$(m_res_pro(res) = 0) = 0 ;
      G_MARKET_PRO2M.fx(res,h)$( m_res_pro(res) = 0) = 0 ;
      *G_MARKET_M2PRO.fx(h)$(feat_node('prosumage',n) = 0) = 0 ;
      G_RES_PRO.fx(res,h)$( m_res_pro(res) = 0) = 0 ;
      STO_IN_PRO2PRO.fx(res,sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_IN_PRO2M.fx(res,sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_IN_M2PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_IN_M2M.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_OUT_PRO2PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_OUT_PRO2M.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_OUT_M2PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_OUT_M2M.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_L_PRO2PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_L_PRO2M.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_L_M2PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_L_M2M.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      N_STO_E_PRO.fx(sto)$( m_sto_pro_p(sto) = 0) = 0 ;
      N_STO_P_PRO.fx(sto)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_L_PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      N_RES_PRO.fx(res)$( m_res_pro(res) = 0) = 0 ;
      $ontext
1739   
1740  * Deactivated market storage links
1741   
1742  STO_IN_PRO2M.fx(tech,sto,h) = 0 ;
1743  STO_IN_M2PRO.fx(sto,h)     = 0 ;
1744  STO_IN_M2M.fx(sto,h)       = 0 ;
1745  STO_OUT_PRO2M.fx(sto,h)    = 0 ;
1746  STO_OUT_M2PRO.fx(sto,h)    = 0 ;
1747  STO_OUT_M2M.fx(sto,h)      = 0 ;
1748  STO_L_PRO.fx(sto,h)        = 0 ;
1749  STO_L_PRO2M.fx(sto,h)      = 0 ;
1750  STO_L_M2PRO.fx(sto,h)      = 0 ;
1751  STO_L_M2M.fx(sto,h)        = 0 ;
1752   
1753  **************************************************************************
      ******
1754  **** DEFAULT LEVELS FOR REPORT PARAMETERS  *******************************
      ******
1755  **************************************************************************
      ******
1756   
1757  * Default level zero for report parameters
1758  lev_Z(scen) = 0 ;
1759  lev_G_L(scen,tech,h) = 0 ;
1760  lev_G_UP(scen,tech,h) = 0 ;
1761  lev_G_DO(scen,tech,h) = 0 ;
1762  lev_G_RES(scen,tech,h) = 0 ;
1763  lev_CU(scen,tech,h) = 0 ;
1764  lev_STO_IN(scen,sto,h) = 0 ;
1765  lev_STO_OUT(scen,sto,h) = 0 ;
1766  lev_STO_L(scen,sto,h) = 0 ;
1767  lev_N_TECH(scen,tech) = 0 ;
1768  lev_N_STO_E(scen,sto) = 0 ;
1769  lev_N_STO_P(scen,sto) = 0 ;
1770  marginal_con1a(scen,h) = 0 ;
1771  marginal_con5a(superscen) = 0 ;
1772   
1773  * Prosumage
1774  lev_CU_PRO(scen,tech,h) = 0 ;
1775  lev_G_MARKET_PRO2M(scen,tech,h) = 0  ;
1776  lev_G_MARKET_M2PRO(scen,h) = 0  ;
1777  lev_G_RES_PRO(scen,tech,h) = 0  ;
1778  lev_STO_IN_PRO2PRO(scen,tech,sto,h) = 0  ;
1779  lev_STO_IN_PRO2M(scen,tech,sto,h) = 0  ;
1780  lev_STO_IN_M2PRO(scen,sto,h) = 0   ;
1781  lev_STO_IN_M2M(scen,sto,h) = 0  ;
1782  lev_STO_OUT_PRO2PRO(scen,sto,h) = 0  ;
1783  lev_STO_OUT_PRO2M(scen,sto,h) = 0  ;
1784  lev_STO_OUT_M2PRO(scen,sto,h) = 0  ;
1785  lev_STO_OUT_M2M(scen,sto,h) = 0  ;
1786  lev_STO_L_PRO2PRO(scen,sto,h) = 0  ;
1787  lev_STO_L_PRO2M(scen,sto,h) = 0  ;
1788  lev_STO_L_M2PRO(scen,sto,h) = 0  ;
1789  lev_STO_L_M2M(scen,sto,h) = 0  ;
1790  lev_N_STO_E_PRO(scen,sto) = 0  ;
1791  lev_N_STO_P_PRO(scen,sto) = 0  ;
1792  lev_STO_L_PRO(scen,sto,h) = 0  ;
1793  lev_N_RES_PRO(scen,tech) = 0  ;
1794   
1795   
1796  * Fixing of report parameters for run-of-river
1797  *$ontext
1798  lev_N_TECH(scen,'ror') = 5857.47 ;
1799  lev_G_RES(scen,'ror',h) = lev_N_TECH(scen,'ror') * phi_res('ror',h) ;
      %ror_parameter%%ror_variable%lev_N_TECH(scen'ror') = 0 ;
      %ror_parameter%%ror_variable%lev_G_RES(scen'ror',h) = 0 ;
      %reserves%$ontext
      *%ror_parameter%%ror_variable%lev_RP_CON(scenreserves,'ror',h) = 0 ;
      $ontext
1809   
1810   
1811   
1812   
1813   
1814   
INCLUDE    C:\Users\Lenovo\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_
           Module\Modified_MCP\scenario.gms
1816   
1817  **************************************************************************
      ******
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DI
      ETER).
      Version 1.3.0, October 2017.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses
      /mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
1827  **************************************************************************
      ******
1828   
1829   
1830   
1831   
1832  *****************************************
1833  **** Scenario file                   ****
1834  ****                                 ****
1835  *****************************************
1836   
1837  Parameter
1838  m_exog_p(tech)
1839  m_exog_sto_e(sto)
1840  m_exog_sto_p(sto)
1841  *m_exog_rsvr_p(rsvr)
1842  *m_exog_ntc(l)
1843  ;
1844   
1845  m_exog_p(tech) = technology_data(tech,'fixed_capacities') ;
1846  m_exog_sto_e(sto) = storage_data(sto,'fixed_capacities_energy');
1847  m_exog_sto_p(sto) = storage_data(sto,'fixed_capacities_power');
1848  *m_exog_rsvr_p(rsvr) = reservoir_data(rsvr,'fixed_capacities_power');
1849  *m_exog_ntc(l) = topology_data(l,'fixed_capacities_ntc') ;
1850   
1851   
1852  *** Dispatch model
      N_TECH.lo(tech) = m_exog_p(tech) ;
      N_STO_P.lo(sto) = m_exog_sto_p(sto) ;
      N_STO_E.lo(sto) = m_exog_sto_e(sto) ;
      N_RSVR_P.lo(rsvr) =  m_exog_rsvr_p(rsvr) ;
      NTC.lo(l) = m_exog_ntc(l) ;
       
      N_TECH.up(tech) = m_exog_p(tech) + 0.1 ;
      N_STO_P.up(sto) = m_exog_sto_p(sto) + 0.1 ;
      N_STO_E.up(sto) = m_exog_sto_e(sto) + 0.1 ;
      N_RSVR_P.up(rsvr) =  m_exog_rsvr_p(rsvr) + 0.1 ;
      NTC.up(l) = m_exog_ntc(l) + 0.1 ;
       
      *N_TECH.lo('OCGT') = m_exog_p('OCGT') ;
      *N_TECH.up('OCGT') = inf ;
1869   
1870  *** Investment model
1871  *$ontext
1872  N_TECH.lo(tech) = 0 ;
1873  N_TECH.lo('wind_on') = m_exog_p('wind_on') ;
1874  N_TECH.lo('wind_off') = m_exog_p('wind_off') ;
1875  N_TECH.lo('pv') = m_exog_p('pv') ;
1876  N_STO_P.lo(sto) = m_exog_sto_p(sto) ;
1877  N_STO_E.lo(sto) = m_exog_sto_e(sto) ;
1878  *N_RSVR_P.lo(rsvr) =  m_exog_rsvr_p(rsvr) ;
1879  *NTC.lo(l) = m_exog_ntc(l) ;
1880   
1881  N_TECH.up(tech) = m_exog_p(tech) + 0.1 ;
1882  N_TECH.up('wind_on') = inf ;
1883  N_TECH.up('wind_off') = inf ;
1884  N_TECH.up('pv') = inf ;
1885  N_STO_P.up(sto) = m_exog_sto_p(sto) + 0.1 ;
1886  N_STO_E.up(sto) = m_exog_sto_e(sto) + 0.1 ;
1887  N_STO_P.up('sto1') = inf ;
1888  N_STO_P.up('sto5') = inf ;
1889  N_STO_P.up('sto7') = inf ;
1890  N_STO_E.up('sto1') = inf ;
1891  N_STO_E.up('sto5') = inf ;
1892  N_STO_E.up('sto7') = inf ;
1893  *N_RSVR_P.up(rsvr) =  m_exog_rsvr_p(rsvr) + 0.1 ;
1894  *NTC.up(l) = m_exog_ntc(l) + 0.1 ;
1895  *$offtext
1896   
1897   
1898  *** Reservoir assumption - not used here
1899  *phi_rsvr_lev_min(rsvr) = 0.0 ;
1900  *%GER_only%N_RSVR_E.lo('FR',rsvr) = 600 * m_exog_rsvr_p('FR',rsvr) ;
1901  *%GER_only%N_RSVR_E.lo('AT',rsvr) = 1700 * m_exog_rsvr_p('AT',rsvr) ;
1902  *%GER_only%N_RSVR_E.lo('CH',rsvr) = 3000 * m_exog_rsvr_p('CH',rsvr) ;
1903   
1904   
1905  *** Germany only, no infeasibility
1906  *NTC.fx(l) = 0 ;
1907  *F.fx(l,h) = 0 ;
1908  *G_INFES.fx(h) = 0 ;
1909   
1910   
      *** Heating
      Parameter
      security_margin_n_heat_out /1.0/
      ;
       
      * Parameterization of water-based heat storage
      n_heat_p_out(bu,ch) = security_margin_n_heat_out * smax( h , dh(bu,ch,h) +
       d_dhw(bu,ch,h) ) ;
      n_heat_e(bu,ch) = 3 * n_heat_p_out(bu,ch) ;
      n_heat_p_in(bu,ch) = n_heat_p_out(bu,ch) ;
      n_heat_p_in(bu,'hp_gs') = n_heat_p_out(bu,'hp_gs') / ( eta_heat_dyn(bu,'hp
      _gs') * (temp_sink(bu,'hp_gs')+273.15) / (temp_sink(bu,'hp_gs') - 10) ) ;
      * at least -5°C; applied to 98% of hoursn; minimum: -13.4
      n_heat_p_in(bu,'hp_as') = n_heat_p_out(bu,'hp_as') / ( eta_heat_dyn(bu,'hp
      _as') * (temp_sink(bu,'hp_as')+273.15) / (temp_sink(bu,'hp_as') + 5) ) ;
       
      * Parameterization of SETS
      n_sets_p_out(bu,ch) = security_margin_n_heat_out * smax( h , dh(bu,ch,h) )
       ;
      n_sets_p_in(bu,ch) = 2 * n_sets_p_out(bu,ch) ;
      n_sets_e(bu,ch) = 16 * n_sets_p_out(bu,ch) ;
       
      * Parameterization of DHW SETS
      n_sets_dhw_p_out(bu,ch) = security_margin_n_heat_out * smax( h , d_dhw(bu,
      ch,h) ) ;
      n_sets_dhw_p_in(bu,ch) = n_sets_dhw_p_out(bu,ch) ;
      n_sets_dhw_e(bu,ch) = 2.2 * n_sets_dhw_p_out(bu,ch) ;
       
      *RP_SETS_AUX.fx(reserves,bu,ch,h) = 0 ;
      *RP_SETS.fx(reserves,bu,ch,h) = 0 ;
      *RP_HP.fx(reserves,bu,ch,h) = 0 ;
      *RP_H_ELEC.fx(reserves,bu,ch,h) = 0 ;
       
1941   
1942   
1943  * Definition of dictionary set for GUSS tool
1944   
1945  Set dict(*,*,*) /
1946  scen             .scenario       .''
1947  gussoptions      .opt            .modstats
1948   
1949  phi_min_res      .param          .min_res
1950   
      phi_pro_self     .param          .pro_selfcon
      $ontext
1955   
1956   
1957  con5a_minRES     .marginal       .marginal_con5a
1958  con1a_bal        .marginal       .marginal_con1a
1959   
1960   
      Z                .level          .lev_Z
      $ontext
1965  G_L              .level          .lev_G_L
1966  G_UP             .level          .lev_G_UP
1967  G_DO             .level          .lev_G_DO
1968  G_RES            .level          .lev_G_RES
1969  CU               .level          .lev_CU
1970  STO_IN           .level          .lev_STO_IN
1971  STO_OUT          .level          .lev_STO_OUT
1972  STO_L            .level          .lev_STO_L
1973  N_TECH           .level          .lev_N_TECH
1974  N_STO_E          .level          .lev_N_STO_E
1975  N_STO_P          .level          .lev_N_STO_P
1976   
1977   
      CU_PRO           .level          .lev_CU_PRO
      G_MARKET_PRO2M   .level          .lev_G_MARKET_PRO2M
      G_MARKET_M2PRO   .level          .lev_G_MARKET_M2PRO
      G_RES_PRO        .level          .lev_G_RES_PRO
      STO_IN_PRO2PRO   .level          .lev_STO_IN_PRO2PRO
      STO_OUT_PRO2PRO  .level          .lev_STO_OUT_PRO2PRO
      STO_L_PRO2PRO    .level          .lev_STO_L_PRO2PRO
      N_STO_E_PRO      .level          .lev_N_STO_E_PRO
      N_STO_P_PRO      .level          .lev_N_STO_P_PRO
      N_RES_PRO        .level          .lev_N_RES_PRO
      $ontext
1991  /
1992  ;
1993   
1994   
1995   
      solve  DIETER using lp min Z scenario dict;
       
       
       
      * Reporting
      $include report.gms
       
       
      execute_unload "results", report, report_tech, report_node,
      *report_line,
      report_tech_hours, report_hours, report_cost
      %prosumage%$ontext
      , report_prosumage, report_prosumage_tech, report_prosumage_tech_hours, re
      port_market, report_market_tech, report_market_tech_hours
      $ontext
2012  ;
2013   
2014   
      $include report_to_excel.gms
      $ontext
2019   
2020   
2023   
2024  *$ontext
2025  solve   DIETER_MCP using mcp ;
2026  *scenario dict;
2027   
2028   
2029  Parameters
2030  Z_MCP
2031  ;
2032   
2033  Z_MCP =            sum( (h,dis) , c_m(dis)*G_L.l(dis,h) )
2034                   + sum( (h,dis)$(ord(h)>1) , c_up(dis)*G_UP.l(dis,h) )
2035                   + sum( (h,dis) , c_do(dis)*G_DO.l(dis,h) )
2036                   + sum( (h,nondis) , c_cu(nondis)*CU.l(nondis,h) )
2037                   + sum( (h,sto) , c_m_sto(sto) * ( STO_OUT.l(sto,h) + STO_
      IN.l(sto,h) ) )
2038                   + sum( tech , c_i(tech)*N_TECH.l(tech) )
2039                   + sum( tech , c_fix(tech)*N_TECH.l(tech) )
2040                   + sum( sto , c_i_sto_e(sto)*N_STO_E.l(sto) )
2041                   + sum( sto , c_fix_sto(sto)/2*(N_STO_P.l(sto)+ N_STO_E.l(
      sto)) )
2042                   + sum( sto , c_i_sto_p(sto)*N_STO_P.l(sto) )
2043  ;
2044   
2045   
2046  Display
2047  Z_MCP,
2048  N_TECH.l,
2049  N_STO_E.l,
2050  N_STO_P.l,
2051  G_L.l,
2052  G_UP.l,
2053  G_DO.l,
2054  G_RES.l,
2055  CU.l,
2056  STO_IN.l,
2057  STO_OUT.l,
2058  STO_L.l
2059  lambda_enerbal.m,
2060  lambda_enerbal.l,
2061  lambda_resgen.m,
2062  lambda_convgen.m,
2063  lambda_stolev.m
2064  ;
2065   
2068   
2069  * ------------------------------------------------------------------------
      ---- *
2070  * ------------------------------------------------------------------------
      ---- *
2071  * ------------------------------------------------------------------------
      ---- *
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows 11/24/18 00:00:29 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\Lenovo\Documents\GitHub\prosu
                                          mage\Code\Prosumage_Opt\Dieter_Module\
                                          Modified_MCP\DIETER.gms
     2      127 INCLUDE        1     127  .C:\Users\Lenovo\Documents\GitHub\pros
                                           umage\Code\Prosumage_Opt\Dieter_Modul
                                           e\Modified_MCP\dataload.gms
     3      531 CALL           2     404  .gdxxrw data_input.xlsx @temp.tmp o=Da
                                           ta_input maxdupeerrors=100
     4      533 GDXIN          2     406  .C:\Users\Lenovo\Documents\GitHub\pros
                                           umage\Code\Prosumage_Opt\Dieter_Modul
                                           e\Modified_MCP\Data_input.gdx
     5      581 CALL           2     454  .gdxxrw time_series.xlsx @temp2.tmp o=
                                           time_series
     6      582 GDXIN          2     455  .C:\Users\Lenovo\Documents\GitHub\pros
                                           umage\Code\Prosumage_Opt\Dieter_Modul
                                           e\Modified_MCP\time_series.gdx
     7      922 INCLUDE        1     162  .C:\Users\Lenovo\Documents\GitHub\pros
                                           umage\Code\Prosumage_Opt\Dieter_Modul
                                           e\Modified_MCP\model.gms
     8     1634 INCLUDE        1     267  .C:\Users\Lenovo\Documents\GitHub\pros
                                           umage\Code\Prosumage_Opt\Dieter_Modul
                                           e\Modified_MCP\fix.gms
     9     1815 INCLUDE        1     268  .C:\Users\Lenovo\Documents\GitHub\pros
                                           umage\Code\Prosumage_Opt\Dieter_Modul
                                           e\Modified_MCP\scenario.gms


COMPILATION TIME     =       18.671 SECONDS      3 MB  24.7.4 r58773 WEX-WEI
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows 11/24/18 00:00:29 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Model Statistics    SOLVE DIETER_MCP Using MCP From line 2025


MODEL STATISTICS

BLOCKS OF EQUATIONS          24     SINGLE EQUATIONS       10,143
BLOCKS OF VARIABLES          24     SINGLE VARIABLES       10,143  5 projected
NON ZERO ELEMENTS        30,965     NON LINEAR N-Z              0
DERIVATIVE POOL              20     CONSTANT POOL              16
CODE LENGTH                   0


GENERATION TIME      =        0.031 SECONDS      8 MB  24.7.4 r58773 WEX-WEI


EXECUTION TIME       =        0.047 SECONDS      8 MB  24.7.4 r58773 WEX-WEI
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows 11/24/18 00:00:29 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE DIETER_MCP Using MCP From line 2025


               S O L V E      S U M M A R Y

     MODEL   DIETER_MCP          
     TYPE    MCP                 
     SOLVER  PATH                FROM LINE  2025

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      1 Optimal                   

 RESOURCE USAGE, LIMIT          3.641  10000000.000
 ITERATION COUNT, LIMIT     11483    2000000000
 EVALUATION ERRORS              0             0
8557 row/cols, 22252 non-zeros, 0.03% dense.

Path 4.7.04 (Mon Sep 19 11:18:59 2016)
Written by Todd Munson, Steven Dirkse, and Michael Ferris

INITIAL POINT STATISTICS
Maximum of X. . . . . . . . . .  6.3959e+004 var: (N_TECH(pv))
Maximum of F. . . . . . . . . .  6.0349e+005 eqn: (con5b_max_energy(bio))
Maximum of Grad F . . . . . . .  1.3736e+000 eqn: (KKTSTO_OUT(Sto7,h2))
                                            var: (lambda_stolev(Sto7,h2))

INITIAL JACOBIAN NORM STATISTICS
Maximum Row Norm. . . . . . . .  1.9700e+002 eqn: (KKTN_STO_P(Sto1))
Minimum Row Norm. . . . . . . .  1.0006e+000 eqn: (con3e_maxprod_res(wind_off,h1
                                                                               )
Maximum Column Norm . . . . . .  1.9700e+002 var: (N_STO_P(Sto1))
Minimum Column Norm . . . . . .  1.0000e+000 var: (lambda_convgen(lig,h2))

FINAL STATISTICS
Inf-Norm of Complementarity . .  8.2408e-008 eqn: (KKTSTO_L(Sto5,h82))
Inf-Norm of Normal Map. . . . .  2.5175e-009 eqn: (con3a_maxprod_dispatchable(CC
                                                                               )
Inf-Norm of Minimum Map . . . .  2.5175e-009 eqn: (con3a_maxprod_dispatchable(CC
                                                                               )
Inf-Norm of Fischer Function. .  2.5175e-009 eqn: (con3a_maxprod_dispatchable(CC
                                                                               )
Inf-Norm of Grad Fischer Fcn. .  5.6134e-009 eqn: (KKTG_L(CCGT,h86))
Two-Norm of Grad Fischer Fcn. .  1.5612e-008

FINAL POINT STATISTICS
Maximum of X. . . . . . . . . .  6.3959e+004 var: (N_TECH(pv))
Maximum of F. . . . . . . . . .  4.5500e+004 eqn: (con4c_stolev_max(Sto5,h21))
Maximum of Grad F . . . . . . .  1.3736e+000 eqn: (KKTSTO_OUT(Sto7,h2))
                                            var: (lambda_stolev(Sto7,h2))



**** REPORT SUMMARY :        0     NONOPT
                             0 INFEASIBLE
                             0  UNBOUNDED
                           594  REDEFINED (REDEF)
                             0     ERRORS
GAMS 24.7.4  r58773 Released Sep 19, 2016 WEX-WEI x86 64bit/MS Windows 11/24/18 00:00:29 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----   2047 PARAMETER Z_MCP                =     302530598.678  

----   2047 VARIABLE N_TECH.L  Technology tech built [MW]

ror       5857.470,    lig      14928.521,    CCGT     11154.980
OCGT      2521.934,    bio       6305.206,    wind_on  55282.481
wind_off 11931.471,    pv       63959.325


----   2047 VARIABLE N_STO_E.L  Storage technology built - Energy [MWh]

Sto1   777.111,    Sto5 45500.000


----   2047 VARIABLE N_STO_P.L  Storage loading and discharging capacity built -
                                Capacity [MW]

Sto1  746.027,    Sto5 7673.343


----   2047 VARIABLE G_L.L  Generation level in hour h [MWh]

                    h1               h2               h3               h4

lig                            7242.734         7896.108         9046.179
bio           2849.560         6305.206         6305.206         6305.206

    +               h5               h6               h7               h8

lig           9383.513        10745.810        14928.517        14928.521
CCGT                                                              532.117
bio           6305.206         6305.206         6305.206         6305.206

    +               h9              h10              h11              h12

lig          14928.521        14928.521        14928.521        14928.521
CCGT          2838.436         5517.930         7313.104         9453.516
bio           6305.206         6305.206         6305.206         6305.206

    +              h13              h14              h15              h16

lig          14928.521        14928.521        14928.521        14928.521
CCGT         10417.623        11154.980        11154.980        11154.980
bio           6305.206         6305.206         6305.206         6305.206

    +              h17              h18              h19              h20

lig          14928.521        14928.521        14928.521        14928.521
CCGT         11154.980        11154.980        11154.980        11154.980
OCGT          1105.227         2521.934         2521.934
bio           6305.206         6305.206         6305.206         6305.206

    +              h21              h22              h23              h24

lig          14928.521        14928.521        14928.521        11927.957
CCGT         11154.980        10776.565         1451.513
bio           6305.206         6305.206         6305.206         6305.206

    +              h25              h26              h27              h28

lig           8118.678         3409.775         3409.775         3409.775
bio           6305.206         6305.206         6305.206         6305.206

    +              h29              h30              h31              h32

lig           3409.775         3409.775         3409.775         3409.775
bio           6305.206         6305.206         6305.206         6305.206

    +              h33              h34              h35              h36

lig           5694.208         7788.588         8152.169         8152.169
bio           6305.206         6305.206         6305.206         6305.206

    +              h37              h38              h39              h40

lig           8152.169         8152.169         8152.169         8152.169
bio           6305.206         6305.206         6305.206         6305.206

    +              h41              h42              h43              h44

lig           8152.169         8152.169         8152.169         8152.169
bio           6305.206         6305.206         6305.206         6305.206

    +              h45              h46              h47              h48

lig           8152.169         7897.589
bio           6305.206         6305.206         5469.569         4556.736

    +              h49              h50              h51              h52

bio           4556.736         4514.619         3519.227         3519.227

    +              h53              h54              h55              h56

bio           3519.227         3519.227         6305.201         6305.201

    +              h57              h58              h59              h60

lig           2009.062         5032.283         6925.499         8523.167
bio           6305.206         6305.206         6305.206         6305.206

    +              h61              h62              h63              h64

lig           8523.167         8523.167         8523.167         8523.167
bio           6305.206         6305.206         6305.206         6305.206

    +              h65              h66              h67              h68

lig           8523.167         8523.167         8523.167         8523.167
bio           6305.206         6305.206         6305.206         6305.206

    +              h69              h70              h71              h72

lig           8523.167         8523.167         3137.081         3137.081
bio           6305.206         6305.206         6305.206         6305.206

    +              h73              h74              h75              h76

lig           3137.081         3137.081         3137.081         3137.081
bio           6305.206         6305.206         6305.206         6305.206

    +              h77              h78              h79              h80

lig           3137.081         3137.081        14928.521        14928.521
CCGT                                            2501.623         8786.847
bio           6305.206         6305.206         6305.206         6305.206

    +              h81              h82              h83              h84

lig          14928.521        14928.521        14928.521        14928.521
CCGT         11154.980        11154.980        11154.980        11154.980
OCGT          1415.656         2521.934         2521.934         2521.934
bio           6305.206         6305.206         6305.206         6305.206

    +              h85              h86              h87              h88

lig          14928.521        14928.521        14928.521        14928.521
CCGT         11154.980        11154.980        11154.980        11154.980
OCGT          2521.934         2521.934         2521.934         2521.934
bio           6305.206         6305.206         6305.206         6305.206

    +              h89              h90              h91              h92

lig          14928.521        14928.521        14928.521        14928.521
CCGT         11154.980        11154.980        11154.980        11154.980
OCGT          2521.934         2521.934         2521.934         2521.934
bio           6305.206         6305.206         6305.206         6305.206

    +              h93              h94              h95              h96

lig          14928.521        14928.521        14928.521        11895.924
CCGT         11154.980        11154.980          378.966
OCGT          2521.934         1412.043
bio           6305.206         6305.206         6305.206         6305.206

    +              h97              h98              h99

lig           9380.748         7902.574         6982.059
bio           6305.206         6305.206         6305.206


----   2047 VARIABLE G_UP.L  Generation upshift in hour h [MWh]

                    h1               h2               h3               h4

lig                            7242.734          653.374         1150.071
bio           2849.560         3455.646

    +               h5               h6               h7               h8

lig            337.334         1362.298         4182.707            0.004
CCGT                                                              532.117

    +               h9              h10              h11              h12

CCGT          2306.320         2679.494         1795.173         2140.412

    +              h13              h14              h17              h18

CCGT           964.107          737.357
OCGT                                            1105.227         1416.707

    +              h33              h34              h35              h55

lig           2284.433         2094.379          363.581
bio                                                              2785.974

    +              h57              h58              h59              h60

lig           2009.062         3023.221         1893.215         1597.669
bio              0.005

    +              h79              h80              h81              h82

lig          11791.440
CCGT          2501.623         6285.224         2368.133
OCGT                                            1415.656         1106.279


----   2047 VARIABLE G_DO.L  Generation downshift in hour h [MWh]

                   h20              h22              h23              h24

lig                                                              3000.564
CCGT                            378.415         9325.052         1451.513
OCGT          2521.934

    +              h25              h26              h46              h47

lig           3809.279         4708.903          254.580         7897.589
bio                                                               835.637

    +              h48              h50              h51              h71

lig                                                              5386.086
bio            912.832           42.117          995.393

    +              h94              h95              h96              h97

lig                                             3032.596         2515.176
CCGT                          10776.014          378.966
OCGT          1109.892         1412.043

    +              h98              h99

lig           1478.174          920.515


----   2047 VARIABLE G_RES.L  Generation renewables type res in hour h [MWh]

                       h1               h2               h3               h4

ror              2964.503         2964.503         2964.503         2964.503
wind_on          8585.369         8474.804         8502.446         8662.765
wind_off         8269.702         8306.690         8099.082         7310.412

       +               h5               h6               h7               h8

ror              2964.503         2964.503         2964.503         2964.503
wind_on          8557.728         7728.491         7065.101         6291.146
wind_off         7061.044         5750.969         4831.053         3458.933

       +               h9              h10              h11              h12

ror              2964.503         2964.503         2964.503         2964.503
wind_on          5378.985         4433.655         3322.477         2227.884
wind_off         2367.204         1611.942         1120.365          633.561
pv                223.858         1586.191         4131.772         6178.471

       +              h13              h14              h15              h16

ror              2964.503         2964.503         2964.503         2964.503
wind_on          1553.438          950.859          602.579          536.240
wind_off          482.031          303.059          176.586           23.863
pv               6754.105         6088.928         4003.854         1381.521

       +              h17              h18              h19              h20

ror              2964.503         2964.503         2964.503         2964.503
wind_on           895.576         1741.398         2764.124         4179.356
wind_off            7.159           17.897          342.433          967.642
pv                 83.147

       +              h21              h22              h23              h24

ror              2964.503         2964.503         2964.503         2964.503
wind_on          5080.460         6064.488         6722.350         7418.909
wind_off         2219.254         3296.665         4327.544         5274.903

       +              h25              h26              h27              h28

ror              2964.503         2964.503         2964.503         2964.503
wind_on          7822.471         8894.951        11050.968        12416.445
wind_off         6020.620         7850.908         9121.609         9915.052

       +              h29              h30              h31              h32

ror              2964.503         2964.503         2964.503         2964.503
wind_on         14373.445        15932.411        17065.702        17867.298
wind_off        10110.728        10210.953        10219.305        10175.158

       +              h33              h34              h35              h36

ror              2964.503         2964.503         2964.503         2964.503
wind_on         18563.857        19575.527        20360.538        20874.665
wind_off        10194.249        10142.943        10071.354        10057.037
pv                172.690          972.182         2200.201         3057.256

       +              h37              h38              h39              h40

ror              2964.503         2964.503         2964.503         2964.503
wind_on         20963.117        21062.625        21256.114        21526.998
wind_off        10049.878        10016.470        10031.981        10065.389
pv               3351.469         3063.652         1931.572          626.801

       +              h41              h42              h43              h44

ror              2964.503         2964.503         2964.503         2964.503
wind_on         22151.690        23141.247        23555.865        23412.131
wind_off         9986.641         9923.404         9906.700         9905.507
pv                 44.772

       +              h45              h46              h47              h48

ror              2964.503         2964.503         2964.503         2964.503
wind_on         22848.249        22195.916        21200.832        21620.978
wind_off         9922.211         9900.734         9881.644         9889.996

       +              h49              h50              h51              h52

ror              2964.503         2964.503         2964.503         2964.503
wind_on         21836.580        21416.433        21444.074        21222.945
wind_off         9855.395         9799.317         9744.432         9756.364

       +              h53              h54              h55              h56

ror              2964.503         2964.503         2964.503         2964.503
wind_on         21012.871        21051.569        21222.945        20907.834
wind_off         9748.012         9712.217         9694.320         9700.286

       +              h57              h58              h59              h60

ror              2964.503         2964.503         2964.503         2964.503
wind_on         20305.255        19581.055        18895.552        17491.377
wind_off         9722.956         9685.968         9662.105         9622.731
pv                108.731         1048.933         2699.084         4298.067

       +              h61              h62              h63              h64

ror              2964.503         2964.503         2964.503         2964.503
wind_on         16042.976        15749.979        15794.205        16640.027
wind_off         9658.526         9693.127         9399.613         9186.039
pv               5001.619         4764.970         3082.839         1074.517

       +              h65              h66              h67              h68

ror              2964.503         2964.503         2964.503         2964.503
wind_on         17259.191        18469.877        19879.580        20377.123
wind_off         9312.513         9425.862         9213.482         9155.018
pv                 76.751

       +              h69              h70              h71              h72

ror              2964.503         2964.503         2964.503         2964.503
wind_on         20493.216        20266.558        19387.566        19077.984
wind_off         9201.550         9236.152         9307.740         9378.136

       +              h73              h74              h75              h76

ror              2964.503         2964.503         2964.503         2964.503
wind_on         18619.140        17635.112        16761.648        15910.298
wind_off         9425.862         9427.055         9436.600         9440.180

       +              h77              h78              h79              h80

ror              2964.503         2964.503         2964.503         2964.503
wind_on         14843.346        14229.711        14351.332        14058.335
wind_off         9466.429         9490.292         9553.529         9643.015

       +              h81              h82              h83              h84

ror              2964.503         2964.503         2964.503         2964.503
wind_on         13748.753        12858.705        11852.564        10663.991
wind_off         9685.968         9658.526         9671.650         9685.968
pv                115.127          876.243         2212.993         3274.717

       +              h85              h86              h87              h88

ror              2964.503         2964.503         2964.503         2964.503
wind_on         10116.694         9574.926         9536.228         9878.979
wind_off         9674.036         9684.775         9716.990         9743.239
pv               3652.077         3287.509         2123.450          876.243

       +              h89              h90              h91              h92

ror              2964.503         2964.503         2964.503         2964.503
wind_on         10271.485        11100.722        11343.965        11017.799
wind_off         9701.479         9740.853         9716.990         9746.818
pv                 95.939

       +              h93              h94              h95              h96

ror              2964.503         2964.503         2964.503         2964.503
wind_on         10780.084        10232.787         9818.169         9414.607
wind_off         9762.329         9765.909         9758.750         9764.716

       +              h97              h98              h99

ror              2964.503         2964.503         2964.503
wind_on          9215.590         8922.592         8778.858
wind_off         9765.909         9736.080         9762.329


----   2047 VARIABLE CU.L  Renewables curtailment technology res in hour h [MWh]

                      ( ALL            0.000 )


----   2047 VARIABLE STO_IN.L  Storage inflow technology sto hour h [MWh]

                   h2               h3               h4               h5

Sto1           34.344          167.608          160.231          279.160
Sto5         4100.102         6118.246         7673.343         7673.343

   +               h6               h7              h26              h27

Sto1          168.145            0.003                            63.375
Sto5         7673.343         1512.664          118.865         3926.209

   +              h28              h29              h30              h31

Sto1                                            746.027            0.006
Sto5         5886.503         7315.179         7673.343         1555.772

   +              h32              h47              h48              h49

Sto1            0.084
Sto5          275.430          410.849         2637.674         5770.675

   +              h50              h51              h52              h53

Sto1                           139.354          277.156
Sto5         7673.333         7673.343         7673.343         7673.343

   +              h54              h55              h56              h71

Sto1          461.633
Sto5         7673.343         2512.255          857.397         2941.029

   +              h72              h73              h74              h75

Sto1                                            378.704          430.786
Sto5         5755.001         7487.882         7673.343         7673.343

   +              h76              h77              h78

Sto5         7138.359         4936.656         1756.883


----   2047 VARIABLE STO_OUT.L  Storage outflow technology sto hour h [MWh]

                   h1              h14              h15              h16

Sto1          373.013
Sto5         7673.343          156.658         2307.720         5514.114

   +              h17              h18              h19              h20

Sto1                           746.027
Sto5         7673.343         7673.343         7673.343         7019.454

   +              h21              h35              h36              h37

Sto1                             0.098            0.015
Sto5         2932.025          146.879          641.811          644.085

   +              h38              h39              h40              h41

Sto1                                                               0.004
Sto5          290.089          641.404         1652.882         3235.677

   +              h42              h43              h44              h45

Sto1                                            507.326          238.584
Sto5         5174.280         5094.601         3267.820          879.026

   +              h53              h60              h61              h62

Sto1           63.270            0.004            0.003            0.003
Sto5                          1231.607         1951.426          968.758

   +              h63              h64              h65              h66

Sto1            0.004                                              0.003
Sto5         1479.411         2879.489         4717.330         6907.191

   +              h67              h68              h69              h70

Sto1                                                             746.010
Sto5         6942.106         5181.645         3120.306         1364.353

   +              h82              h83              h84              h85

Sto1            0.015            0.007            0.004            0.003
Sto5          492.316         1340.591         2720.837         3033.471

   +              h86              h87              h88              h89

Sto1            0.002            0.002            0.002            0.002
Sto5         3193.357         3090.135         3329.341         4478.613

   +              h90              h91              h92              h93

Sto1            0.002                           339.908          406.079
Sto5         6753.089         6718.945         4865.992          933.312


----   2047 VARIABLE STO_L.L  Storage level technology sto hour h [MWh]

                   h1               h2               h3               h4

Sto1                            32.970          193.874          347.696
Sto5        14224.063        17914.155        23420.577        30326.585

   +               h5               h6               h7               h8

Sto1          615.689          777.108          777.111          777.111
Sto5        37232.594        44138.603        45500.000        45500.000

   +               h9              h10              h11              h12

Sto1          777.111          777.111          777.111          777.111
Sto5        45500.000        45500.000        45500.000        45500.000

   +              h13              h14              h15              h16

Sto1          777.111          777.111          777.111          777.111
Sto5        45500.000        45325.936        42761.802        36635.009

   +              h17              h18              h19              h20

Sto1          777.111
Sto5        28109.072        19583.136        11057.199         3257.806

   +              h26              h27              h28              h29

Sto1                            60.840           60.840           60.840
Sto5          106.978         3640.566         8938.419        15522.081

   +              h30              h31              h32              h33

Sto1          777.025          777.031          777.111          777.111
Sto5        22428.089        23828.284        24076.171        24076.171

   +              h34              h35              h36              h37

Sto1          777.111          777.009          776.993          776.993
Sto5        24076.171        23912.972        23199.849        22484.198

   +              h38              h39              h40              h41

Sto1          776.993          776.993          776.993          776.990
Sto5        22161.878        21449.207        19612.671        16017.474

   +              h42              h43              h44              h47

Sto1          776.990          776.990          248.525
Sto5        10268.274         4607.606          976.695          369.764

   +              h48              h49              h50              h51

Sto1                                                             133.780
Sto5         2743.671         7937.278        14843.278        21749.287

   +              h52              h53              h54              h55

Sto1          399.849          333.943          777.111          777.111
Sto5        28655.295        35561.304        42467.313        44728.342

   +              h56              h57              h58              h59

Sto1          777.111          777.111          777.111          777.111
Sto5        45500.000        45500.000        45500.000        45500.000

   +              h60              h61              h62              h63

Sto1          777.108          777.104          777.101          777.096
Sto5        44131.548        41963.297        40886.899        39243.110

   +              h64              h65              h66              h67

Sto1          777.096          777.096          777.093          777.093
Sto5        36043.677        30802.199        23127.543        15414.092

   +              h68              h69              h70              h71

Sto1          777.093          777.093
Sto5         9656.708         6189.702         4673.754         7320.680

   +              h72              h73              h74              h75

Sto1                                            363.556          777.111
Sto5        12500.181        19239.275        26145.283        33051.292

   +              h76              h77              h78              h79

Sto1          777.111          777.111          777.111          777.111
Sto5        39475.815        43918.805        45500.000        45500.000

   +              h80              h81              h82              h83

Sto1          777.111          777.111          777.095          777.088
Sto5        45500.000        45500.000        44952.982        43463.437

   +              h84              h85              h86              h87

Sto1          777.084          777.080          777.078          777.076
Sto5        40440.285        37069.761        33521.586        30088.103

   +              h88              h89              h90              h91

Sto1          777.074          777.072          777.070          777.070
Sto5        26388.835        21412.598        13909.167         6443.672

   +              h92

Sto1          422.999
Sto5         1037.014


----   2047 VARIABLE lambda_enerbal.M  Dual variable on energy balance (1a)

                      ( ALL            0.000 )


----   2047 VARIABLE lambda_enerbal.L  Dual variable on energy balance (1a)

h1   32.558,    h2   45.418,    h3   45.418,    h4   45.418,    h5   45.418
h6   45.418,    h7   45.418,    h8   60.383,    h9   60.383,    h10  60.383
h11  60.383,    h12  60.383,    h13  60.383,    h14  60.676,    h15  60.676
h16  60.676,    h17  81.818,    h18 346.165,    h19 205.048,    h20  60.676
h21  60.676,    h22  60.383,    h23  60.383,    h24  45.418,    h25  45.418
h26  40.301,    h27  40.301,    h28  40.301,    h29  40.301,    h30  16.114
h31  40.301,    h32  40.301,    h33  45.418,    h34  45.418,    h35  50.872
h36  50.872,    h37  50.872,    h38  50.872,    h39  50.872,    h40  50.872
h41  50.872,    h42  50.872,    h43  50.872,    h44  50.872,    h45  50.872
h46  45.418,    h47  32.558,    h48  32.558,    h49  32.558,    h50  32.558
h51  19.385,    h52  19.385,    h53  22.077,    h54  19.385,    h55  32.558
h56  32.558,    h57  45.418,    h58  45.418,    h59  45.418,    h60  50.872
h61  50.872,    h62  50.872,    h63  50.872,    h64  50.872,    h65  50.872
h66  50.872,    h67  50.872,    h68  50.872,    h69  50.872,    h70  50.872
h71  40.301,    h72  40.301,    h73  40.301,    h74  30.766,    h75  30.766
h76  40.301,    h77  40.301,    h78  40.301,    h79  60.383,    h80  60.383
h81  81.818,    h82  92.761,    h83  92.761,    h84  92.761,    h85  92.761
h86  92.761,    h87  92.761,    h88  92.761,    h89  92.761,    h90  92.761
h91  92.761,    h92  92.761,    h93  92.761,    h94  81.818,    h95  60.383
h96  45.418,    h97  45.418,    h98  45.418,    h99  15.418


----   2047 VARIABLE lambda_resgen.M  Dual variable on renewable generation (3e)

                      ( ALL            0.000 )


----   2047 VARIABLE lambda_convgen.M  Dual variable on conventional generation 
                                       level (2a)

                      ( ALL            0.000 )


----   2047 VARIABLE lambda_stolev.M  Dual variable on storage level  (4b)

                      ( ALL            0.000 )



EXECUTION TIME       =        0.016 SECONDS      6 MB  24.7.4 r58773 WEX-WEI


USER: Medium MUD - 10 User License                   S170316:1123AO-GEN
      Deutsches Institut fuer Wirtschaftsforschung DIW, AbteilungDC3975
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\Lenovo\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_
           Module\Modified_MCP\DIETER.gms
Output     C:\Users\Lenovo\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_
           Module\Modified_MCP\DIETER.lst
