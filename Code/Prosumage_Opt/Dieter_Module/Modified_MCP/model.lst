GAMS 24.2.1  r43572 Released Dec  9, 2013 WEX-WEI x86_64/MS Windows 10/22/18 14:40:33 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1   
   2  **************************************************************************
      ******
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DI
      ETER).
      Version 1.3.0, October 2017.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses
      /mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
  12  **************************************************************************
      ******
  13   
  14   
  15  Variables
  16  Z                Value objective function [Euro]
  17  F(l,h)           Energy flow over link l in hour h [MWh]
****    $120,120
  18  ;
  19   
  20  Positive Variables
  21  G_L(n,tech,h)            Generation level in hour h [MWh]
****      $120 $120
  22  G_UP(n,tech,h)           Generation upshift in hour h [MWh]
  23  G_DO(n,tech,h)           Generation downshift in hour h [MWh]
  24   
  25  G_RES(n,tech,h)          Generation renewables type res in hour h [MWh]
  26  CU(n,tech,h)             Renewables curtailment technology res in hour h [
      MWh]
  27   
  28  STO_IN(n,sto,h)          Storage inflow technology sto hour h [MWh]
****             $120
  29  STO_OUT(n,sto,h)         Storage outflow technology sto hour h [MWh]
  30  STO_L(n,sto,h)           Storage level technology sto hour h [MWh]
  31   
  32  EV_CHARGE(n,ev,h)        Electric vehicle charging vehicle profile ev hour
****               $120
       h [MWh]
  33  EV_DISCHARGE(n,ev,h)     Electric vehicle discharging vehicle profile ev h
      our h [MWh]
  34  EV_L(n,ev,h)             Electric vehicle charging level vehicle profile e
      v hour h [MWh]
  35  EV_PHEVFUEL(n,ev,h)      Plug in hybrid electric vehicle conventional fuel
       use vehicle profile ev hour h [MWh]
  36  EV_GED(n,ev,h)           Grid electricity demand for mobility vehicle prof
      ile ev hour h [MWh]
  37   
  38  N_TECH(n,tech)           Technology tech built [MW]
  39  N_STO_E(n,sto)           Storage technology built - Energy [MWh]
  40  N_STO_P(n,sto)           Storage loading and discharging capacity built - 
      Capacity [MW]
  41   
  42  DSM_CU(n,dsm,h)          DSM: Load curtailment hour h [MWh]
****             $120
  43  DSM_UP(n,dsm,h)          DSM: Load shifting up hour h technology dsm [MWh]
  44  DSM_DO(n,dsm,h,hh)       DSM: Load shifting down in hour hh to account for
****                  $120
       upshifts in hour h technology dsm [MWh]
  45   
  46  DSM_UP_DEMAND(n,dsm,h)   DSM: Load shifting up active for wholesale demand
       in hour h of technology dsm [MWh]
  47  DSM_DO_DEMAND(n,dsm,h)   DSM: Load shifting down active for wholesale dema
      nd in hour h of technology dsm [MWh]
  48   
  49  N_DSM_CU(n,dsm)          DSM: Load curtailment capacity [MW]
  50  N_DSM_SHIFT(n,dsm)       DSM: Load shifting capacity [MWh]
  51   
  52  RP_DIS(n,reserves,tech,h)        Reserve provision by conventionals in hou
****                  $120
      r h [MW]
  53  RP_NONDIS(n,reserves,tech,h)     Reserve provision by renewables in hour h
       [MW]
  54  RP_STO_IN(n,reserves,sto,h)      Reserve provision by storage in in hour h
       [MW]
  55  RP_STO_OUT(n,reserves,sto,h)     Reserve provision by storage out in hour 
      h [MW]
  56  RP_EV_V2G(n,reserves,ev,h)       Reserve provision by electric vehicles V2
      G hour h [MW]
  57  RP_EV_G2V(n,reserves,ev,h)       Reserve provision by electric vehicles G2
      V hour h [MW]
  58  RP_DSM_CU(n,reserves,dsm,h)      Reserve provision by DSM load curtailment
       in hour h [MW]
  59  RP_DSM_SHIFT(n,reserves,dsm,h)   Reserve provision by DSM load shifting in
       hour h [MW]
  60  RP_RSVR(n,reserves,rsvr,h)       Reserve provision by reservoirs h [MW]
****                        $120
  61  RP_SETS(n,reserves,bu,ch,h)      Reserve provision by SETS [MW]
****                      $120,120
  62  RP_SETS_AUX(n,reserves,bu,ch,h)  Reserve provision by SETS auxiliary DHW m
      odules [MW]
  63  RP_HP(n,reserves,bu,ch,h)        Reserve provision by heat pumps [MW]
  64  RP_H_ELEC(n,reserves,bu,ch,h)    Reserve provision by hybrid electric heat
      ers [MW]
  65   
  66  CU_PRO(n,tech,h)                 Prosumage: curtailment of renewable gener
      ation in hour h [MWh]
  67  G_MARKET_PRO2M(n,tech,h)         Prosumage. energy sent to market in hour 
      h [MWh]
  68  G_MARKET_M2PRO(n,h)              Prosumage: withdrawal of energy from mark
      et in hour h [MWh]
  69  G_RES_PRO(n,tech,h)              Prosumage: hourly renewables generation i
      n hour h [MWh]
  70  STO_IN_PRO2PRO(n,tech,sto,h)     Prosumage: storage loading from generatio
      n for discharging to consumption in hour h [MWh]
  71  STO_IN_PRO2M(n,tech,sto,h)       Prosumage: storage loading from generatio
      n for discharging to market in hour h [MWh]
  72  STO_IN_M2PRO(n,sto,h)            Prosumage: storage loading from market fo
      r discharging to consumption in hour h [MWh]
  73  STO_IN_M2M(n,sto,h)              Prosumage: storage loading from market fo
      r discharging to market in hour h [MWh]
  74  STO_OUT_PRO2PRO(n,sto,h)         Prosumage: storage discharging to consump
      tion from generation in hour h [MWh]
  75  STO_OUT_PRO2M(n,sto,h)           Prosumage: storage discharging to market 
      from generation in hour h [MWh]
  76  STO_OUT_M2PRO(n,sto,h)           Prosumage: storage discharging to consump
      tion from market in hour h [MWh]
  77  STO_OUT_M2M(n,sto,h)             Prosumage: storage discharging to market 
      from market in hour h [MWh]
  78  STO_L_PRO2PRO(n,sto,h)           Prosumage: storage level generation to co
      nsumption in hour h [MWh]
  79  STO_L_PRO2M(n,sto,h)             Prosumage: storage level generation to ma
      rket in hour h [MWh]
  80  STO_L_M2PRO(n,sto,h)             Prosumage: storage level market to consum
      otion in hour h [MWh]
  81  STO_L_M2M(n,sto,h)               Prosumage: storage level market to market
       in hour h [MWh]
  82  N_STO_E_PRO(n,sto)               Prosumage: installed storage energy [MWh]
  83  N_STO_P_PRO(n,sto)               Prosumage: installed storage power [MW]
  84  STO_L_PRO(n,sto,h)               Prosumage: overall storage level in hour 
      h [MWh]
  85  N_RES_PRO(n,tech)                Prosumage: installed renewables capacitie
      s [MW]
  86   
  87  NTC(l)                           Trade: installed NTC on line l [MW]
  88   
  89  RSVR_OUT(n,rsvr,h)               Reservoirs: outflow in hour h [MWh]
  90  RSVR_L(n,rsvr,h)                 Reservoirs: level in hour h [MWh]
  91  N_RSVR_E(n,rsvr)                 Reservoirs: installed energy capacity [MW
      h]
  92  N_RSVR_P(n,rsvr)                 Reservoirs: installed power capacity [MW]
  93   
  94  H_DIR(n,bu,ch,h)                 Heating: direct heating in hour h for bui
      lding type bu with haeting technology ch [MWh]
  95  H_SETS_LEV(n,bu,ch,h)            Heating: storage level SETS technologies 
      [MWh]
  96  H_SETS_IN(n,bu,ch,h)             Heating: storage inflow SETS technologies
       [MWh]
  97  H_SETS_OUT(n,bu,ch,h)            Heating: storage outflow SETS technologie
      s [MWh]
  98  H_HP_IN(n,bu,ch,hh)              Heating: electricity demand heat pump tec
      hnologies [MWh]
  99  H_STO_LEV(n,bu,ch,h)             Heating: storage level storage technologi
      es [MWh]
 100  H_STO_IN_HP(n,bu,ch,h)           Heating: storage inflow from heat pumps t
      o storage technologies [MWh]
 101  H_STO_IN_ELECTRIC(n,bu,ch,h)     Heating: storage inflow from electric hea
      ting to storage technologies [MWh]
 102  H_ELECTRIC_IN(n,bu,ch,h)         Heating: hybrid electric heaters electric
      ity demand [MWh]
 103  H_STO_IN_FOSSIL(n,bu,ch,h)       Heating: storage inflow from nonelectric 
      heating to storage technologies [MWh]
 104  H_STO_OUT(n,bu,ch,h)             Heating: storage outflow from storage tec
      hnologies [MWh]
 105   
 106  H_DHW_DIR(n,bu,ch,h)             Heating - domestic hot water: provision i
      n case of direct electric heating [MWh]
 107  H_DHW_STO_OUT(n,bu,ch,h)         Heating - domestic hot water: DHW storage
       outflow [MWh]
 108   
 109  H_DHW_AUX_ELEC_IN(n,bu,ch,h)     Heating - domestic hot water: electrical 
      energy input of auxiliary hot water tank for SETS [MWh]
 110  H_DHW_AUX_LEV(n,bu,ch,h)         Heating - domestic hot water: level of au
      xiliary hot water tank for SETS [MWh]
 111  H_DHW_AUX_OUT(n,bu,ch,h)         Heating - domestic hot water: auxiliary D
      HW provision for SETS [MWh]
 112  ;
 113   
 114   
 115   
 116   
 117  **************************************************************************
      ******
 118   
 119  Equations
 120  * Objective
 121  obj                      Objective cost minimization
 122   
 123  * Energy balance
 124  con1a_bal                Energy Balance
 125   
 126  * Load change costs
 127  con2a_loadlevel          Load change costs: Level
 128  con2b_loadlevelstart     Load change costs: Level for first period
 129   
 130  * Capacity contraints and flexibility constraints
 131  con3a_maxprod_dispatchable       Capacity Constraint conventionals
 132  con3e_maxprod_res
 133   
 134  * Storage constraints
 135  con4a_stolev_start        Storage Level Dynamics Initial Condition
 136  con4b_stolev              Storage Level Dynamics
 137  con4c_stolev_max          Storage Power Capacity
 138  con4d_maxin_sto           Storage maximum inflow
 139  con4e_maxout_sto          Storage maximum outflow
 140  con4j_ending              End level equal to initial level
 141  con4k_PHS_EtoP            Maximum E to P ratio for PHS
 142   
 143  * Minimum restrictions for renewables and biomass
 144  con5a_minRES             Minimum yearly renewables requirement
 145  con5b_max_energy         Maximum yearly biomass energy
 146   
 147   
 148  * Maximum installation conditions
 149  con8a_max_I_power                Maximum installable capacity: Conventiona
      ls
 150  con8b_max_I_sto_e                Maximum installable energy: Storage in MW
      h
 151  con8c_max_I_sto_p                Maximum installable capacity: Storage inf
      low-outflow in MW
 152  con8f_max_pro_res                Maximum installable capacity: prosumage r
      enewables
 153  con8g_max_pro_sto_e              Maximum installable capacity: prosumage s
      torage energy
 154  con8h_max_sto_pro_p              Maximum installable capacity: prosumage s
      torage power
 155   
 156  * Prosumage
 157  con11a_pro_distrib                       Prosumage: distribution of genera
      ted energy
 158  con11b_pro_balance                       Prosumage: energy balance
 159  con11c_pro_selfcon                       Prosumage: minimum self-generatio
      n requirement
 160  con11d_pro_stolev_PRO2PRO                Prosumage: storage level prosumag
      er-to-prosumagers
 161  con11e_pro_stolev_PRO2M                  Prosumage: storage level prosumag
      ers-to-market
 162  con11f_pro_stolev_M2PRO                  Prosumage: storage level market-t
      o-prosumagers
 163  con11g_pro_stolev_M2M                    Prosumage: storage level market-t
      o-market
 164  con11h_1_pro_stolev_start_PRO2PRO        Prosumage: storage level initial 
      conditions
 165  con11h_2_pro_stolev_start_PRO2M          Prosumage: storage level initial 
      conditions
 166  con11h_3_pro_stolev_start_M2PRO          Prosumage: storage level initial 
      conditions
 167  con11h_4_pro_stolev_start_M2M            Prosumage: storage level initial 
      conditions
 168  con11i_pro_stolev                        Prosumage: storage level total
 169  con11j_pro_stolev_max                    Prosumage: maximum overall storag
      e level
 170  con11k_pro_maxin_sto                     Prosumage: maximum storage inflow
 171  con11l_pro_maxout_sto                    Prosumage: maximum storage outflo
      w
 172  con11m_pro_maxout_lev                    Prosumage: maximum storage outflo
      w linked to level
 173  con11n_pro_maxin_lev                     Prosumage: maximum storage inflow
       linked to level
 174  con11o_pro_ending                        Prosumage: storage ending conditi
      on
 175  ;
 176   
 177   
 178   
 179  **************************************************************************
      ******
 180   
 181  * ------------------------------------------------------------------------
      ---- *
 182  ***** Objective function *****
 183  * ------------------------------------------------------------------------
      ---- *
 184   
 185  obj..
 186           Z =E=
 187                     sum( (h,map_n_tech(n,dis)) , c_m(n,dis)*G_L(n,dis,h) )
****                                      $120  $120    $140
 188                   + sum( (h,map_n_tech(n,dis))$(ord(h)>1) , c_up(n,dis)*G_U
****                                                                $140        
      P(n,dis,h) )
             $171
 189                   + sum( (h,map_n_tech(n,dis)) , c_do(n,dis)*G_DO(n,dis,h) 
****                                                     $140               $171
      )
 190                   + sum( (h,map_n_tech(n,nondis)) , c_cu(n,nondis)*CU(n,non
****                                               $120     $140                
      dis,h) )
         $171
 191                   + sum( (h,map_n_sto(n,sto)) , c_m_sto(n,sto) * ( STO_OUT(
****                                     $120              $140
      n,sto,h) + STO_IN(n,sto,h) ) )
 192  %DSM$ontext
****  $409
 193                   + sum( (h,map_n_dsm(n,dsm_curt)) , c_m_dsm_cu(n,dsm_curt)
      *DSM_CU(n,dsm_curt,h) )
 194                   + sum( (h,map_n_dsm(n,dsm_shift)) , c_m_dsm_shift(n,dsm_s
      hift) * DSM_UP_DEMAND(n,dsm_shift,h) )
 195                   + sum( (h,map_n_dsm(n,dsm_shift)) , c_m_dsm_shift(n,dsm_s
      hift) * DSM_DO_DEMAND(n,dsm_shift,h) )
 198  %EV$ontext
 199                   + sum( (h,map_n_ev(n,ev)) , c_m_ev(n,ev) * EV_DISCHARGE(n
      ,ev,h) )
 200                   + sum( (h,map_n_ev(n,ev)) , pen_phevfuel(n,ev) * EV_PHEVF
      UEL(n,ev,h) )
 203                   + sum( map_n_tech(n,tech) , c_i(n,tech)*N_TECH(n,tech) )
 204                   + sum( map_n_tech(n,tech) , c_fix(n,tech)*N_TECH(n,tech) 
      )
 205                   + sum( map_n_sto(n,sto) , c_i_sto_e(n,sto)*N_STO_E(n,sto)
       )
 206                   + sum( map_n_sto(n,sto) , c_fix_sto(n,sto)/2*(N_STO_P(n,s
      to)+N_STO_E(n,sto)) )
 207                   + sum( map_n_sto(n,sto) , c_i_sto_p(n,sto)*N_STO_P(n,sto)
       )
 208  %DSM$ontext
 209                   + sum( map_n_dsm(n,dsm_curt) , c_i_dsm_cu(n,dsm_curt)*N_D
      SM_CU(n,dsm_curt) )
 210                   + sum( map_n_dsm(n,dsm_curt) , c_fix_dsm_cu(n,dsm_curt)*N
      _DSM_CU(n,dsm_curt) )
 211                   + sum( map_n_dsm(n,dsm_shift) , c_i_dsm_shift(n,dsm_shift
      )*N_DSM_SHIFT(n,dsm_shift) )
 212                   + sum( map_n_dsm(n,dsm_shift) , c_fix_dsm_shift(n,dsm_shi
      ft)*N_DSM_SHIFT(n,dsm_shift) )
 215  %reserves$ontext
 216                   + sum( (h,map_n_sto(n,sto),reserves_up) , phi_reserves_ca
      ll(n,reserves_up,h) * c_m_sto(n,sto) * (RP_STO_OUT(n,reserves_up,sto,h) - 
      RP_STO_IN(n,reserves_up,sto,h)) )
 217                   - sum( (h,map_n_sto(n,sto),reserves_do) , phi_reserves_ca
      ll(n,reserves_do,h) * c_m_sto(n,sto) * (RP_STO_OUT(n,reserves_do,sto,h) - 
      RP_STO_IN(n,reserves_do,sto,h)) )
 218                   + sum( (h,map_n_rsvr(n,rsvr),reserves_up) , RP_RSVR(n,res
      erves_up,rsvr,h) * phi_reserves_call(n,reserves_up,h) * c_m_rsvr(n,rsvr) )
 219                   - sum( (h,map_n_rsvr(n,rsvr),reserves_do) , RP_RSVR(n,res
      erves_do,rsvr,h) * phi_reserves_call(n,reserves_do,h) * c_m_rsvr(n,rsvr) )
 222  %reserves$ontext
 223  %EV$ontext
 224  %EV_EXOG%        + sum( (h,map_n_ev(n,ev),reserves_up) , RP_EV_V2G(n,reser
      ves_up,ev,h) * phi_reserves_call(n,reserves_up,h) * c_m_ev(n,ev) )
 225  %EV_EXOG%        - sum( (h,map_n_ev(n,ev),reserves_do) , RP_EV_V2G(n,reser
      ves_do,ev,h) * phi_reserves_call(n,reserves_do,h) * c_m_ev(n,ev) )
 228  %DSM$ontext
 229  %reserves$ontext
 230                   + sum( (h,map_n_dsm(n,dsm_curt),reserves_up) , RP_DSM_CU(
      n,reserves_up,dsm_curt,h) * phi_reserves_call(n,reserves_up,h) * c_m_dsm_c
      u(n,dsm_curt) )
 231                   + sum( (h,map_n_dsm(n,dsm_shift),reserves) , RP_DSM_SHIFT
      (n,reserves,dsm_shift,h) * phi_reserves_call(n,reserves,h) * c_m_dsm_shift
      (n,dsm_shift) )
 234  %prosumage$ontext
 235                   + sum( map_n_res_pro(n,res) , c_i(n,res)*N_RES_PRO(n,res)
       )
 236                   + sum( map_n_res_pro(n,res) , c_fix(n,res)*N_RES_PRO(n,re
      s) )
 237   
 238                   + sum( map_n_sto_pro(n,sto) , c_i_sto_e(n,sto)*N_STO_E_PR
      O(n,sto) )
 239                   + sum( map_n_sto_pro(n,sto) , c_fix_sto(n,sto)/2*(N_STO_P
      _PRO(n,sto) + N_STO_E_PRO(n,sto)) )
 240                   + sum( map_n_sto_pro(n,sto) , c_i_sto_p(n,sto)*N_STO_P_PR
      O(n,sto) )
 241   
 242                   + sum( (h,map_n_sto_pro(n,sto)) , c_m_sto(n,sto) * ( STO_
      OUT_PRO2PRO(n,sto,h) + STO_OUT_M2PRO(n,sto,h) + STO_OUT_PRO2M(n,sto,h) + S
      TO_OUT_M2M(n,sto,h) + sum( res , STO_IN_PRO2PRO(n,res,sto,h) + STO_IN_PRO2
      M(n,res,sto,h)) + STO_OUT_PRO2M(n,sto,h) + STO_OUT_M2M(n,sto,h) ) )
 245                   + sum( map_l(l) , c_i_ntc(l) * NTC(l)*dist(l) )
 246   
 247                   + sum( (h,map_n_rsvr(n,rsvr)), c_m_rsvr(n,rsvr) * RSVR_OU
      T(n,rsvr,h) )
 248                   + sum( map_n_rsvr(n,rsvr) , c_i_rsvr_e(n,rsvr) * N_RSVR_E
      (n,rsvr) )
 249                   + sum( map_n_rsvr(n,rsvr) , c_i_rsvr_p(n,rsvr) * N_RSVR_P
      (n,rsvr) )
 250                   + sum( map_n_rsvr(n,rsvr) , c_fix_rsvr(n,rsvr) * N_RSVR_P
      (n,rsvr) )
 251  %heat$ontext
 252                   + sum( (h,n,bu,hfo) , pen_heat_fuel(n,bu,hfo) * H_STO_IN_
      FOSSIL(n,bu,hfo,h))
 255                   + sum( (h,n) , c_infes * G_INFES(n,h) )
 256  ;
 257   
 258  * ------------------------------------------------------------------------
      ---- *
 259  ***** Energy balance and load levels *****
 260  * ------------------------------------------------------------------------
      ---- *
 261   
 262  * Energy balance
 263  con1a_bal(n,hh)..
 264           ( 1 - phi_pro_load(n) ) * d(n,hh) + sum( map_n_sto(n,sto) , STO_I
****                            $140     $140
      N(n,sto,hh) )
 265  %DSM$ontext
****  $37,409
 266           + sum( map_n_dsm(n,dsm_shift) , DSM_UP_DEMAND(n,dsm_shift,hh) )
 269  %EV$ontext
 270           + sum( map_n_ev(n,ev) , EV_CHARGE(n,ev,hh) )
 273  %prosumage$ontext
 274           + G_MARKET_M2PRO(n,hh)
 275           + sum( map_n_sto_pro(n,sto) , STO_IN_M2PRO(n,sto,hh))
 276           + sum( map_n_sto_pro(n,sto) , STO_IN_M2M(n,sto,hh))
 279  %heat$ontext
 280          + sum( (bu,ch) , theta_dir(n,bu,ch) * (H_DIR(n,bu,ch,hh) + H_DHW_D
      IR(n,bu,ch,hh)) )
 281          + sum( (bu,ch) , theta_sets(n,bu,ch) * (H_SETS_IN(n,bu,ch,hh) + H_
      DHW_AUX_ELEC_IN(n,bu,ch,hh)) )
 282          + sum( (bu,hp) , theta_hp(n,bu,hp) * H_HP_IN(n,bu,hp,hh) )
 283          + sum( (bu,hel) , theta_elec(n,bu,hel) * H_ELECTRIC_IN(n,bu,hel,hh
      ) )
 286           =E=
 287           sum( map_n_tech(n,dis) , G_L(n,dis,hh)) + sum( map_n_tech(n,nondi
      s) , G_RES(n,nondis,hh)) + sum( sto , STO_OUT(n,sto,hh) ) + sum( map_n_rsv
      r(n,rsvr) , RSVR_OUT(n,rsvr,hh))
 288  %GER_only%       + sum( map_l(l) , inc(l,n) * F(l,hh))
 289  %reserves$ontext
 290  *Balancing Correction Factor
 291          + sum( map_n_tech(n,dis) ,
 292            sum( reserves_do ,  RP_DIS(n,reserves_do,dis,hh) * phi_reserves_
      call(n,reserves_do,hh))
 293          - sum( reserves_up ,  RP_DIS(n,reserves_up,dis,hh) * phi_reserves_
      call(n,reserves_up,hh))
 294           )
 297  %DSM$ontext
 298           + sum( map_n_dsm(n,dsm_curt) , DSM_CU(n,dsm_curt,hh))
 299           + sum( map_n_dsm(n,dsm_shift) , DSM_DO_DEMAND(n,dsm_shift,hh))
 302  %EV$ontext
 303          + sum( map_n_ev(n,ev) , EV_DISCHARGE(n,ev,hh) )
 306  %prosumage$ontext
 307           + sum( map_n_res_pro(n,res) , G_MARKET_PRO2M(n,res,hh) )
 308           + sum( map_n_sto_pro(n,sto) , STO_OUT_PRO2M(n,sto,hh))
 309           + sum( map_n_sto_pro(n,sto) , STO_OUT_M2M(n,sto,hh))
 312           + G_INFES(n,hh)
 313  ;
 314   
 315  con2a_loadlevel(n,dis,h)$(ord(h) > 1 AND map_n_tech(n,dis))..
 316          G_L(n,dis,h) =E= G_L(n,dis,h-1) + G_UP(n,dis,h) - G_DO(n,dis,h)
****                                                      $171            $171
 317  ;
 318   
 319  con2b_loadlevelstart(n,dis,h)$(ord(h) = 1 AND map_n_tech(n,dis))..
 320           G_L(n,dis,h) =E= G_UP(n,dis,h)
****                                      $171
 321  ;
 322   
 323  * ------------------------------------------------------------------------
      ---- *
 324  ***** Hourly maximum generation caps and constraints related to reserves  
       *****
 325  * ------------------------------------------------------------------------
      ---- *
 326   
 327  con3a_maxprod_dispatchable(n,dis,h)$(map_n_tech(n,dis))..
 328          G_L(n,dis,h)
 329  %reserves$ontext
****  $37,409
 330          + sum( reserves_up , RP_DIS(n,reserves_up,dis,h))
 331  *Balancing Correction Factor
 332          + sum( reserves_do ,  RP_DIS(n,reserves_do,dis,h) * phi_reserves_c
      all(n,reserves_do,h))
 333          - sum( reserves_up ,  RP_DIS(n,reserves_up,dis,h) * phi_reserves_c
      all(n,reserves_up,h))
 336          =L= N_TECH(n,dis)
 337  ;
 338   
 339   
 340  con3e_maxprod_res(n,nondis,h)$(map_n_tech(n,nondis))..
 341          G_RES(n,nondis,h) + CU(n,nondis,h)
****                        $171             $171
 342  %reserves$ontext
****  $37,409
 343          + sum( reserves_up , RP_NONDIS(n,reserves_up,nondis,h))
 346          =E= phi_res(n,nondis,h) * N_TECH(n,nondis)
 347  ;
 348   
 349  * ------------------------------------------------------------------------
      ---- *
 350  ***** Storage constraints *****
 351  * ------------------------------------------------------------------------
      ---- *
 352   
 353  con4a_stolev_start(n,sto,h)$(map_n_sto(n,sto) AND ord(h) = 1)..
 354          STO_L(n,sto,h) =E= phi_sto_ini(n,sto) * N_STO_E(n,sto) + STO_IN(n,
****                                       $140                                 
      sto,h)*(1+eta_sto(n,sto))/2 - STO_OUT(n,sto,h)/(1+eta_sto(n,sto))*2
                      $140
 355  ;
 356   
 357  con4b_stolev(n,sto,h)$((ord(h)>1) AND map_n_sto(n,sto))..
 358           STO_L(n,sto,h) =E= STO_L(n,sto,h-1) + STO_IN(n,sto,h)*(1+eta_sto(
      n,sto))/2 - STO_OUT(n,sto,h)/(1+eta_sto(n,sto))*2
 359  %reserves$ontext
****  $409
 360           + sum( reserves_do , phi_reserves_call(n,reserves_do,h) * ( RP_ST
      O_IN(n,reserves_do,sto,h)*(1+eta_sto(n,sto))/2 + RP_STO_OUT(n,reserves_do,
      sto,h)/(1+eta_sto(n,sto))*2 ))
 361           - sum( reserves_up , phi_reserves_call(n,reserves_up,h) * ( RP_ST
      O_IN(n,reserves_up,sto,h)*(1+eta_sto(n,sto))/2 + RP_STO_OUT(n,reserves_up,
      sto,h)/(1+eta_sto(n,sto))*2 ))
 364  ;
 365   
 366  con4c_stolev_max(n,sto,h)$(map_n_sto(n,sto))..
 367          STO_L(n,sto,h) =L= N_STO_E(n,sto)
 368  ;
 369   
 370  con4d_maxin_sto(n,sto,h)$(map_n_sto(n,sto))..
 371          STO_IN(n,sto,h)
 372  %reserves$ontext
****  $37,409
 373          + sum( reserves_do , RP_STO_IN(n,reserves_do,sto,h))
 376          =L= N_STO_P(n,sto)
 377  ;
 378   
 379  con4e_maxout_sto(n,sto,h)$(map_n_sto(n,sto))..
 380          STO_OUT(n,sto,h)
 381  %reserves$ontext
****  $37,409
 382          + sum( reserves_up , RP_STO_OUT(n,reserves_up,sto,h))
 385          =L= N_STO_P(n,sto)
 386  ;
 387   
 388  con4j_ending(n,sto,h)$(ord(h) = card(h) AND map_n_sto(n,sto))..
 389           STO_L(n,sto,h) =E= phi_sto_ini(n,sto) * N_STO_E(n,sto)
 390  ;
 391   
 392  con4k_PHS_EtoP(n,sto)$(map_n_sto(n,sto))..
 393          N_STO_E(n,sto) =L= etop_max(n,sto) * N_STO_P(n,sto)
****                                    $140
 394  ;
 395   
 396  * ------------------------------------------------------------------------
      ---- *
 397  ***** Quotas for renewables and biomass *****
 398  * ------------------------------------------------------------------------
      ---- *
 399   
 400  con5a_minRES(n)..
 401  sum( h , G_L(n,'bio',h) + sum( map_n_tech(n,nondis) , G_RES(n,nondis,h)) +
****                                                                      $171  
       sum( map_n_rsvr(n,rsvr) , RSVR_OUT(n,rsvr,h))
                     $120,340
 402  %reserves$ontext
****  $8,37,409
 403           - sum( reserves_do , (sum( map_n_tech(n,nondis) , RP_NONDIS(n,res
      erves_do,nondis,h)) + sum( map_n_rsvr(n,rsvr) , RP_RSVR(n,reserves_do,rsvr
      ,h))) * phi_reserves_call(n,reserves_do,h))
 404           + sum( reserves_up , (sum( map_n_tech(n,nondis) , RP_NONDIS(n,res
      erves_up,nondis,h)) + sum( map_n_rsvr(n,rsvr) , RP_RSVR(n,reserves_up,rsvr
      ,h))) * phi_reserves_call(n,reserves_up,h))
 407  %prosumage$ontext
 408           + sum( map_n_sto_pro(n,sto) , STO_OUT_PRO2PRO(n,sto,h) + STO_OUT_
      PRO2M(n,sto,h)) + sum( map_n_res_pro(n,res) , G_MARKET_PRO2M(n,res,h) + G_
      RES_PRO(n,res,h))
 411  )
 412          =G= phi_min_res * phi_min_res_exog(n) * sum( h ,
 413           sum( map_n_tech(n,dis) , G_L(n,dis,h)) + sum( map_n_tech(n,nondis
      ) , G_RES(n,nondis,h)) + sum( map_n_rsvr(n,rsvr) , RSVR_OUT(n,rsvr,h))
 414  %reserves$ontext
 415           - sum( reserves_do , (sum( map_n_tech(n,nondis) , RP_NONDIS(n,res
      erves_do,nondis,h)) + sum( map_n_rsvr(n,rsvr) , RP_RSVR(n,reserves_do,rsvr
      ,h))) * phi_reserves_call(n,reserves_do,h))
 416           + sum( reserves_up , (sum( map_n_tech(n,nondis) , RP_NONDIS(n,res
      erves_up,nondis,h)) + sum( map_n_rsvr(n,rsvr) , RP_RSVR(n,reserves_up,rsvr
      ,h))) * phi_reserves_call(n,reserves_up,h))
 419  %prosumage$ontext
 420           + sum( map_n_res_pro(n,res) , phi_res(n,res,h) * N_RES_PRO(n,res)
       - CU_PRO(n,res,h))
 423           )
 424  ;
 425   
 426  con5b_max_energy(n,dis)$(map_n_tech(n,dis) AND m_e(n,dis))..
****                                                   $140
 427           sum( h , G_L(n,dis,h) ) =L= m_e(n,dis)
 428  ;
 429   
 430  * ------------------------------------------------------------------------
      ---- *
 431  ***** Maximum installation constraints *****
 432  * ------------------------------------------------------------------------
      ---- *
 433   
 434  con8a_max_I_power(n,tech)$(map_n_tech(n,tech))..
 435           N_TECH(n,tech) =L= m_p(n,tech)
****                                $140
 436  ;
 437   
 438  con8b_max_I_sto_e(n,sto)$(map_n_sto(n,sto))..
 439           N_STO_E(n,sto) =L= m_sto_e(n,sto)
****                                    $140
 440  ;
 441   
 442  con8c_max_I_sto_p(n,sto)$(map_n_sto(n,sto))..
 443           N_STO_P(n,sto) =L= m_sto_p(n,sto)
****                                    $140
 444  ;
 445   
 446   
 447  con8f_max_pro_res(n,res)$(map_n_res_pro(n,res))..
****                        $120,340        $140
 448           N_RES_PRO(n,res) =L= m_res_pro(n,res)
****                          $171          $140
 449  ;
 450   
 451  con8g_max_pro_sto_e(n,sto)$(map_n_sto_pro(n,sto))..
****                                          $140
 452           N_STO_E_PRO(n,sto) =L= m_sto_pro_e(n,sto)
****                                            $140
 453  ;
 454   
 455  con8h_max_sto_pro_p(n,sto)$(map_n_sto_pro(n,sto))..
 456           N_STO_P_PRO(n,sto) =L= m_sto_pro_p(n,sto)
****                                            $140
 457  ;
 458   
 459  * ------------------------------------------------------------------------
      ---- *
 460  ***** Prosumage constraints *****
 461  * ------------------------------------------------------------------------
      ---- *
 462   
 463  con11a_pro_distrib(n,res,h)$(map_n_res_pro(n,res))..
 464           phi_res(n,res,h) * N_RES_PRO(n,res)
****                 $140                        $171
 465           =E=
 466           CU_PRO(n,res,h) + G_MARKET_PRO2M(n,res,h) + G_RES_PRO(n,res,h) + 
****                       $171                      $171                 $171  
      sum( map_n_sto_pro(n,sto) , STO_IN_PRO2PRO(n,res,sto,h) + STO_IN_PRO2M(n,r
                                                      $171                      
      es,sto,h) )
        $171
 467  ;
 468   
 469  con11b_pro_balance(n,h)..
 470           phi_pro_load(n) * d(n,h)
 471           =E=
 472           sum( map_n_res_pro(n,res) , G_RES_PRO(n,res,h)) + sum( map_n_sto_
****                                                      $171
      pro(n,sto) , STO_OUT_PRO2PRO(n,sto,h) + STO_OUT_M2PRO(n,sto,h) ) + G_MARKE
      T_M2PRO(n,h)
 473  ;
 474   
 475  con11c_pro_selfcon(n)..
 476           sum( (h,map_n_res_pro(n,res)) , G_RES_PRO(n,res,h) ) + sum( (h,st
****                                                          $171
      o) , STO_OUT_PRO2PRO(n,sto,h) )
 477           =G=
 478           phi_pro_self * sum( h , phi_pro_load(n) * d(n,h))
****                      $140
 479  ;
 480   
 481  con11d_pro_stolev_PRO2PRO(n,sto,h)$(map_n_sto_pro(n,sto) AND ord(h) > 1 ).
      .
 482           STO_L_PRO2PRO(n,sto,h) =E= STO_L_PRO2PRO(n,sto,h-1) + sum( map_n_
      res_pro(n,res) , STO_IN_PRO2PRO(n,res,sto,h))*(1+eta_sto(n,sto))/2 - STO_O
****                                       $171
      UT_PRO2PRO(n,sto,h)/(1+eta_sto(n,sto))*2
 483  ;
 484   
 485  con11e_pro_stolev_PRO2M(n,sto,h)$(map_n_sto_pro(n,sto) AND ord(h) > 1)..
 486           STO_L_PRO2M(n,sto,h) =E= STO_L_PRO2M(n,sto,h-1) + sum( map_n_res_
      pro(n,res) , STO_IN_PRO2M(n,res,sto,h))*(1+eta_sto(n,sto))/2 - STO_OUT_PRO
****                                 $171
      2M(n,sto,h)/(1+eta_sto(n,sto))*2
 487  ;
 488   
 489  con11f_pro_stolev_M2PRO(n,sto,h)$(map_n_sto_pro(n,sto) AND ord(h) > 1)..
 490           STO_L_M2PRO(n,sto,h) =E= STO_L_M2PRO(n,sto,h-1) + STO_IN_M2PRO(n,
      sto,h)*(1+eta_sto(n,sto))/2 - STO_OUT_M2PRO(n,sto,h)/(1+eta_sto(n,sto))*2
 491  ;
 492   
 493  con11g_pro_stolev_M2M(n,sto,h)$(ord(h) > 1)..
 494           STO_L_M2M(n,sto,h) =E= STO_L_M2M(n,sto,h-1) + STO_IN_M2M(n,sto,h)
      *(1+eta_sto(n,sto))/2 - STO_OUT_M2M(n,sto,h)/(1+eta_sto(n,sto))*2
 495  ;
 496   
 497  con11h_1_pro_stolev_start_PRO2PRO(n,sto,h)$(map_n_sto_pro(n,sto) AND ord(h
      ) = 1)..
 498          STO_L_PRO2PRO(n,sto,h) =E= 0.25 * phi_sto_pro_ini(n,sto) * N_STO_E
****                                                          $140              
      _PRO(n,sto) + sum( map_n_res_pro(n,res) , STO_IN_PRO2PRO(n,res,sto,h))*(1+
                                                                    $171
      eta_sto(n,sto))/2 - STO_OUT_PRO2PRO(n,sto,h)/(1+eta_sto(n,sto))*2
 499  ;
 500   
 501  con11h_2_pro_stolev_start_PRO2M(n,sto,h)$(map_n_sto_pro(n,sto) AND ord(h) 
      = 1)..
 502          STO_L_PRO2M(n,sto,h) =E= 0.25 * phi_sto_pro_ini(n,sto) * N_STO_E_P
      RO(n,sto) + sum( map_n_res_pro(n,res) , STO_IN_PRO2M(n,res,sto,h))*(1+eta_
****                                                            $171
      sto(n,sto))/2 - STO_OUT_PRO2M(n,sto,h)/(1+eta_sto(n,sto))*2
 503  ;
 504   
 505  con11h_3_pro_stolev_start_M2PRO(n,sto,h)$(map_n_sto_pro(n,sto) AND ord(h) 
      = 1)..
 506          STO_L_M2PRO(n,sto,h) =E= 0.25 * phi_sto_pro_ini(n,sto) * N_STO_E_P
      RO(n,sto) + STO_IN_M2PRO(n,sto,h)*(1+eta_sto(n,sto))/2 - STO_OUT_M2PRO(n,s
      to,h)/(1+eta_sto(n,sto))*2
 507  ;
 508   
 509  con11h_4_pro_stolev_start_M2M(n,sto,h)$(map_n_sto_pro(n,sto) AND ord(h) = 
      1)..
 510          STO_L_M2M(n,sto,h) =E= 0.25 * phi_sto_pro_ini(n,sto) * N_STO_E_PRO
      (n,sto) + STO_IN_M2M(n,sto,h)*(1+eta_sto(n,sto))/2 - STO_OUT_M2M(n,sto,h)/
      (1+eta_sto(n,sto))*2
 511  ;
 512   
 513  con11i_pro_stolev(n,sto,h)$(map_n_sto_pro(n,sto) AND ord(h)>1)..
 514           STO_L_PRO(n,sto,h) =E=   STO_L_PRO2PRO(n,sto,h) +  STO_L_PRO2M(n,
      sto,h) + STO_L_M2PRO(n,sto,h) + STO_L_M2M(n,sto,h)
 515  ;
 516   
 517  con11j_pro_stolev_max(n,sto,h)..
 518          STO_L_PRO(n,sto,h) =L= N_STO_E_PRO(n,sto)
 519  ;
 520   
 521  con11k_pro_maxin_sto(n,sto,h)$(map_n_sto_pro(n,sto))..
 522          sum( map_n_res_pro(n,res) , STO_IN_PRO2PRO(n,res,sto,h) + STO_IN_P
****                                                          $171              
      RO2M(n,res,sto,h) ) + STO_IN_M2PRO(n,sto,h) + STO_IN_M2M(n,sto,h)
                $171
 523          =L= N_STO_P_PRO(n,sto)
 524  ;
 525   
 526  con11l_pro_maxout_sto(n,sto,h)$(map_n_sto_pro(n,sto))..
 527          STO_OUT_PRO2PRO(n,sto,h) + STO_OUT_PRO2M(n,sto,h) + STO_OUT_M2PRO(
      n,sto,h) + STO_OUT_M2M(n,sto,h)
 528          =L= N_STO_P_PRO(n,sto)
 529  ;
 530   
 531  con11m_pro_maxout_lev(n,sto,h)$(map_n_sto_pro(n,sto))..
 532          ( STO_OUT_PRO2PRO(n,sto,h) + STO_OUT_M2PRO(n,sto,h) + STO_OUT_PRO2
      M(n,sto,h) + STO_OUT_M2M(n,sto,h) ) / (1+eta_sto(n,sto))*2
 533          =L= STO_L_PRO(n,sto,h-1)
 534  ;
 535   
 536  con11n_pro_maxin_lev(n,sto,h)$(map_n_sto_pro(n,sto))..
 537          ( sum( map_n_res_pro(n,res) , STO_IN_PRO2PRO(n,res,sto,h) + STO_IN
****                                                            $171            
      _PRO2M(n,res,sto,h) ) + STO_IN_M2PRO(n,sto,h) + STO_IN_M2M(n,sto,h) ) * (1
                  $171
      +eta_sto(n,sto))/2
 538          =L= N_STO_E_PRO(n,sto) - STO_L_PRO(n,sto,h-1)
 539  ;
 540   
 541  con11o_pro_ending(n,sto,h)$(map_n_sto_pro(n,sto) AND ord(h) = card(h))..
 542           STO_L_PRO(n,sto,h) =E= phi_sto_pro_ini(n,sto) * N_STO_E_PRO(n,sto
      )
 543  ;
 544   
 545  **************************************************************************
      ******
 546  ***** MODEL *****
 547  **************************************************************************
      ******
 548   
 549  model DIETER /
 550  obj
 551   
 552  con1a_bal
 553   
 554  con2a_loadlevel
 555  con2b_loadlevelstart
 556   
 557  con3a_maxprod_dispatchable
 558   
 559  con3e_maxprod_res
 560   
 561   
 562   
 563  con4a_stolev_start
 564  con4b_stolev
 565  con4c_stolev_max
 566  con4d_maxin_sto
 567  con4e_maxout_sto
 568   
 569  con4j_ending
 570  con4k_PHS_EtoP
 571   
 572  con5a_minRES
 573  con5b_max_energy
 574   
 575   
 576  con8a_max_I_power
 577  con8b_max_I_sto_e
 578  con8c_max_I_sto_p
 579   
 580  %prosumage$ontext
****  $2       $140,2 $140
 581  con8f_max_pro_res
 582  con8g_max_pro_sto_e
 583  con8h_max_sto_pro_p
 584  con11a_pro_distrib
 585  con11b_pro_balance
 586  con11c_pro_selfcon
 587  con11d_pro_stolev_PRO2PRO
 588  con11e_pro_stolev_PRO2M
 589  con11f_pro_stolev_M2PRO
 590  con11g_pro_stolev_M2M
 591  con11h_1_pro_stolev_start_PRO2PRO
 592  con11h_2_pro_stolev_start_PRO2M
 593  con11h_3_pro_stolev_start_M2PRO
 594  con11h_4_pro_stolev_start_M2M
 595  con11i_pro_stolev
 596  con11j_pro_stolev_max
 597  con11k_pro_maxin_sto
 598  con11l_pro_maxout_sto
 599  con11m_pro_maxout_lev
 600  con11n_pro_maxin_lev
 601  con11o_pro_ending
 604   
 605   
 606  /;
GAMS 24.2.1  r43572 Released Dec  9, 2013 WEX-WEI x86_64/MS Windows 10/22/18 14:40:33 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Error Messages


  2  Identifier expected
  8  ')' expected
 37  '=l=' or '=e=' or '=g=' operator expected
120  Unknown identifier entered as set
140  Unknown symbol
171  Domain violation for set
340  A label/element with the same name exist. You may have forgotten
        to quote a label/element reference. For example,
        set i / a,b,c /; parameter x(i); x('a') = 10;
409  Unrecognizable item - skip to find a new statement
       looking for a ';' or a key word to get started again

**** 87 ERROR(S)   0 WARNING(S)


COMPILATION TIME     =        0.265 SECONDS      3 MB  24.2.1 r43572 WEX-WEI


USER: Abteilung Energie, Verkehr, Umwelt, 5 User     S131220:0515AN-GEN
      Deutsches Institut fuer Wirtschaftsforschung DIW           DC3975
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Diet
           er_Module\Modified_MCP\model.gms
Output     C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Diet
           er_Module\Modified_MCP\model.lst

**** USER ERROR(S) ENCOUNTERED
