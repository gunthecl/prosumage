GAMS 25.1.2  r67455 Released Aug  1, 2018 WEX-WEI x86 64bit/MS Windows - 11/30/18 10:48:27 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1   
   2  ********************************************************************************
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DIETER).
      Version 1.3.0, October 2018.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses/mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
  12  ********************************************************************************
  13   
  14   
  15   
  16   
  17  **************************
  18  ***** GLOBAL OPTIONS *****
  19  **************************
  20   
  21  * Set star to skip Excel upload and load data from gdx
  23   
  24   
  25  * Choose base year
  27   
  28  ***** Set star to activate options
  29   
  30  * Germany only - also adjust Excel inputs!
  32   
  33  * Dispatch only - used fixed capacities (also deactivates bio energy restriction)
  35   
  37   
  39   
  40  * Set to "*" to select linear program, leave blank to select MCP
  42   
  43  * Set star to select run-of-river options either as exogenous parameter or as endogenous variable including reserve provision:
  44  * if nothing is selected, ROR capacity will be set to zero
  45  * if parameter option is selected, set appropriate values in fix.gmx
  46  * if variable option is selected, set appropriate bound in data_input excel
  49   
  50  * Set star to determine loops, otherwise default 100% renewables
  52   
  53  * Set star for no crossover to speed up calculation time by skipping crossover in LP solver
  55   
  56  * Set star for reporting to Excel
  58   
  59   
  60  * --------------------- Do not change these lines ------------------------------
  61   
  62   
  63  ******************************Do not change these lines ************************
  64   
  65  * Definition of strings for report parameters and sanity checks
  67   
  68  * Sanity checks
  70   
  71  * LP or MCP
  74   
  75  * Dispatch or investment
  78   
  79  ********************************************************************************
  80   
  81  ****************************
  82  ***** INITIALIZE LOOPS *****
  83  ****************************
  84   
  85  sets
  86  *$ontext
  87  loop_res_share   Solution loop for different shares of renewables       /50/
  90   
      loop_prosumage   Solution loop for different prosumer self-consumption levels    /50/
      $ontext
  95   
  96  *      loop_res_share                          /50/
  97                        loop_prosumage                          /0/
  98  ;
  99   
 100   
 101   
 102   
 103  ********************************************************************************
 104   
 105  **************************
 106  ***** SOLVER OPTIONS *****
 107  **************************
 108   
 109  options
 110  optcr = 0.00
 111  reslim = 10000000
 112  lp = cplex
 113  mip = cplex
 114  nlp = conopt
 115  limrow = 0
 116  limcol = 0
 117  ;
 118   
 119  options
 120  dispwidth = 15
 121  limrow = 0
 122  limcol = 0
 123  solprint = off
 124  sysout = off
 125  ;
 126   
 127   
 128   
 129   
 130  ********************************************************************************
 131   
 132  **************************
 133  ***** Dataload *****
 134  **************************
 135   
INCLUDE    C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\dataload.gms
 137   
 138  ********************************************************************************
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DIETER).
      Version 1.3.0, October 2017.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses/mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
 148  ********************************************************************************
 149   
 150   
 151   
 152   
 153  ***************  SETS  *********************************************************
 154   
 155  ***** Sets used in the model *****
 156  Sets
 157  tech                     Generation technologies
 158   dis(tech)               Dispatchable generation technologies
 159   nondis(tech)            Nondispatchable generation technologies
 160   con(tech)               Conventional generation technologies
 161   res(tech)               Renewable generation technologies
 162  sto                      Storage technologies
 163  rsvr                     Reservoir technologies
 164  dsm                      DSM technologies
 165   dsm_shift(dsm)          DSM load shifting technologies
 166   dsm_curt(dsm)           DSM load curtailment technologies
 167  year                     Base year for temporal data
 168  h                        Hours
 169  n                        Nodes
 170  l                        Lines
 171  ev                       EV types
 172  reserves                         Reserve qualities
 173   reserves_up(reserves)           Positive reserves
 174   reserves_do(reserves)           Negative reserves
 175   reserves_spin(reserves)         Spinning reserves
 176   reserves_nonspin(reserves)      Nonspinning reserves
 177   reserves_prim(reserves)         Primary reserves
 178   reserves_nonprim(reserves)      Nonprimary reserves
 179   reserves_prim_up(reserves)      Primary positive reserves
 180   reserves_nonprim_up(reserves)   Nonprimary positive reserves
 181   reserves_prim_do(reserves)      Primary negative reserves
 182   reserves_nonprim_do(reserves)   Nonprimary negative reserves
 183  bu                       Building archtypes
 184  ch                       Heating combination type
 185   hst(ch)                 Heating technology that feeds to storage
 186   hp(ch)                  Heat pump technologies
 187   hel(ch)                 Hybrid electric heating technologies - electric part
 188   hfo(ch)                 Hybrid electric heating technologies - fossil part
 189   
 190   
 191  ***** Sets used for data upload *****
 192  headers_tech                     Generation technologies - upload headers
 193   tech_dispatch                   Generation technologies - dispatchable or nondispatchable
 194   tech_res_con                    Generation technologies - renewable or "conventional"
 195  headers_sto                      Storage technologies - upload headers
 196  headers_reservoir                Reservoir technologies - upload headers
 197  headers_dsm                      DSM technologies - upload headers
 198   dsm_type                        DSM technologies - shifting or curtailment
 199  headers_time                     Temporal data - upload headers
 200  headers_topology                 Spatial data - upload headers
 201  headers_ev                       EV data - upload headers
 202  headers_time_ev                  EV temporal data - upload headers
 203  headers_prosumage_generation     Prosumage generation data - upload headers
 204  headers_prosumage_storage        Prosumage storage data - upload headers
 205  headers_reserves                 Reserve data - upload headers
 206   reserves_up_down                Reserve data - positive and neagtive reserves
 207   reserves_spin_nonspin           Reserve data - spinning and nonspinning reserves
 208   reserves_prim_nonprim           Reserve data - primary and nonprimary reserves
 209  headers_heat                     Heat data - upload headers
 210   heat_storage                    Heat data - storage technologies
 211   heat_hp                         Heat data - heat pump technologies
 212   heat_elec                       Heat data - hybrid heating technologies - electric part
 213   heat_fossil                     Heat data - hybrid heating technologies - fossil part
 214  headers_time_heat                Heat data - upload headers time data
 215  headers_time_dhw                 Heat data - upload headers time data on DHW
 216  ;
 217   
 218   
 219   
 220   
 221  ***************  PARAMETERS  ***************************************************
 222   
 223  Parameters
 224   
 225  ***** Generation technologies *****
 226  *--- Variable and fixed costs ---*
 227  eta              Efficiency of conventional technologies [0 1]
 228  carbon_content   CO2 emissions per fuel unit used [tons per MWh thermal]
 229  c_up             Load change costs UP [EUR per MWh]
 230  c_do             Load change costs DOWN [EUR per MWh]
 231  c_fix            Annual fixed costs [EUR per MW per year]
 232  c_vom            Variable O&M costs [EUR per MWh]
 233  CO2price         CO2 price in [EUR per ton]
 234   
 235  *--- Investment ---*
 236  c_inv_overnight  Investment costs: Overnight [EUR per MW]
 237  lifetime         Investment costs: technical lifetime [a]
 238  recovery         Investment costs: Recovery period according to depreciation tables [a]
 239  interest_rate    Investment costs: Interest rate [%]
 240  m_p              Investment: maximum installable capacity per technology [MW]
 241  m_e              Investment: maximum installable energy [TWh per a]
 242   
 243  *--- Flexibility ---*
 244  grad_per_min     Maximum load change relative to installed capacity [% of installed capacity per minute]
 245   
 246   
 247  ***** Fuel and CO2 costs *****
 248  fuelprice        Fuel price conventionals [EUR per MWh thermal]
 249   
 250   
 251  ***** Renewables *****
 252  c_cu             Hourly Curtailment costs for renewables [Euro per MW]
 253  phi_min_res      Minimum renewables share [0 1]
 254   
 255   
 256  ***** Storage *****
 257  *--- Variable and fixed costs ---*
 258  c_m_sto          Marginal costs of storing in or out [EUR per MWh]
 259  eta_sto          Storage efficiency [0 1]
 260  phi_sto_ini      Initial storage level [0 1]
 261  etop_max         Maximum E to P ratio of storage types [#]
 262  c_fix_sto        Annual fixed costs [EUR per MW]
 263   
 264  *--- Investment ---*
 265  c_inv_overnight_sto_e       Investment costs for storage energy: Overnight [EUR per MWh]
 266  c_inv_overnight_sto_p       Investment costs for storage capacity: Overnight [EUR per MW]
 267  m_sto_e                     Investment into storage: maximum installable energy [MWh]
 268  m_sto_p                     Investment into storage: maximum installable power [MW]
 269   
 270   
 271  ***** Reservoir*****
 272  *--- Variable and fixed costs ---*
 273  c_m_rsvr                 Marginal costs of generating energy from reservoir [EUR per MWh]
 274  eta_rsvr                 Generation efficiency [0 1]
 275  phi_rsvr_ini             Initial reservoir level [0 1]
 276  c_fix_rsvr               Annual fixed costs [EUR per MW per a]
 277  phi_rsvr_min             Minimum hourly reservoir outflow as fraction of annual energy [0 1]
 278  phi_rsvr_lev_min         Minimum filling level [0 1]
 279   
 280  *--- Investment ---*
 281  c_inv_overnight_rsvr_e   Investment costs for reservoir energy: Overnight [EUR per MWh]
 282  c_inv_overnight_rsvr_p   Investment costs for reservoir capacity: Overnight [EUR per MW]
 283  inv_lifetime_rsvr        Investment costs for reservoir: technical lifetime [a]
 284  inv_interest_rsvr        Investment costs for reservoir: Interest rate [%]
 285  m_rsvr_e                 Investment into reservoir: maximum installable energy [MWh]
 286  m_rsvr_p                 Investment into reservoir: maximum installable capacity [MW]
 287   
 288   
 289  ***** DSM *****
 290  *--- Variable and fixed costs ---*
 291  c_m_dsm_cu       DSM: hourly costs of load curtailment [EUR per MWh]
 292  c_m_dsm_shift    DSM: costs for load shifting [EUR per MWh]
 293  c_fix_dsm_cu     Annual fixed costs load curtailment capacity [EUR per MW per a]
 294  c_fix_dsm_shift  Annual fixed costs load shifting capacity [EUR per MW per a]
 295   
 296  *--- Flexibility, efficiency, recovery ---*
 297  t_dur_dsm_cu     DSM: Maximum duration load curtailment [h]
 298  t_off_dsm_cu     DSM: Minimum recovery time between two load curtailment instances [h]
 299   
 300  t_dur_dsm_shift  DSM: Maximum duration load shifting [h]
 301  t_off_dsm_shift  DSM: Minimum recovery time between two granular load upshift instances [h]
 302  eta_dsm_shift    DSM: Efficiency of load shifting technologies [0 1]
 303   
 304  *--- Investment ---*
 305  c_inv_overnight_dsm_cu           Investment costs for DSM load curtailment: Overnight [EUR per MW]
 306  c_inv_overnight_dsm_shift        Investment costs for DSM load shifting: Overnight [EUR per MW]
 307  inv_recovery_dsm_cu              Investment costs for DSM load curtailment: Recovery period [a]
 308  inv_recovery_dsm_shift           Investment costs for DSM load shifting: Recovery period [a]
 309  inv_interest_dsm_cu              Investment costs for DSM load curtailment: Interest rate [%]
 310  inv_interest_dsm_shift           Investment costs for DSM load shifting: Interest rate [%]
 311  m_dsm_cu                         DSM: Maximum installable capacity load curtailment [MW]
 312  m_dsm_shift                      DSM: Maximum installable capacity load shifting [MW]
 313   
 314   
 315  ***** Time Data *****
 316  d_y                      Demand hour h for different years [MWh]
 317  d                        Demand hour h [MWh]
 318  phi_res_y                Renewables availability technology res in hour h for different years [0 1]
 319  phi_res                  Renewables availability technology res in hour h [0 1]
 320  phi_ror_y                Run-of-river availability technology ror in hour h for different years [0 1]
 321  phi_ror                  Run-of-river availability technology ror in hour h [0 1]
 322  rsvr_in_y                Reservoir inflow in hour h for different years [0 1]
 323  rsvr_in                  Reservoir inflow in hour h [0 1]
 324  n_ev_p_upload            Power rating of the charging connection in hour h [MW - 0 when car is in use or parked without grid connection]
 325  ev_ed_upload             Electricity demand for mobility vehicle profile ev in hour h [MW]
 326  ev_ged_exog_upload       Electricity demand for mobility in case of uncontrolled charging vehicle profile ev in hour h [MW]
 327  phi_reserves_call_y      Hourly share of reserve provision that is actually activated for different years [0 1]
 328  phi_reserves_call        Hourly share of reserve provision that is actually activated [0 1]
 329  reserves_exogenous_y     Hourly reserve provision for different years [MW]
 330  reserves_exogenous       Hourly reserve provision [MW]
 331   
 332  ***** Transmission *****
 333  *--- Investment ---*
 334  c_inv_overnight_ntc       Investment costs in: overnight [EUR per MW]
 335  c_fix_ntc                 Fixed costs [EUR per MW per a]
 336  inv_lifetime_ntc          Investment costs: technical lifetime [a]
 337  inv_recovery_ntc          Investment costs: Recovery period in [a]
 338  inv_interest_ntc          Investment costs: Interest rate [%]
 339  m_ntc                     Investment into NTC: maximum installable capacity [MW]
 340   
 341  *--- Topology and distance ---*
 342  inc              Incidence index of link l on node n
 343  dist             Distance covered by link l [km]
 344   
 345   
 346  ***** Electric vehicles *****
 347  *--- Costs and attributes ---*
 348  c_m_ev           Marginal costs of discharging V2G [EUR per MWh]
 349  pen_phevfuel     Penalty for non-electric PHEV operation mode [EUR per MWh]
 350  eta_ev_in        Electric vehicle efficiency of charging (G2V) [0 1]
 351  eta_ev_out       Electric vehicle efficiency of discharging (V2G) [0 1]
 352  phi_ev_ini       Electric vehicle charging level in initial period [0 1]
 353   
 354  n_ev_e           Electric vehicle battery capacity [MWh]
 355  ev_quant         Overall number of electirc vehicles [#]
 356  phi_ev           Share of electric vehicles per load profile in actual scenario [0 1]
 357  ev_phev          Defines whether an electric vehicle is a PHEV REEV [1 if yes 0 otherwise]
 358   
 359  *--- Temporal data ---*
 360  n_ev_p           Electric vehicle power rating [MWh]
 361  ev_ed            Electric vehicle electricity demand [MWh]
 362  ev_ged_exog      Electric vehicle grid electricity demand for exogenous charging pattern [MWh]
 363   
 364   
 365  ***** Prosumage *****
 366  phi_pro_load             Share of prosumagers among total load [0 1]
 367  phi_pro_self             Minimum self-generation shares for prosumagers [0 1]
 368  m_res_pro                Maximum installable: renewables capacity [MW]
 369  m_sto_pro_e              Maximum installable: storage energy [MWh]
 370  m_sto_pro_p              Maximum installable: storage capacity [MW]
 371  phi_sto_pro_ini          Prosumagers' initial storage loading [0 1]
 372   
 373   
 374  ***** Reserves *****
 375  phi_reserves_share       Shares of SRL and MRL up and down [0 1]
 376  reserves_intercept       Intercept of regression line determining reserves demand
 377  reserves_slope           Slope of regression line determining reserves demand
 378  reserves_reaction        Activation reaction time for reserves qualities [min]
 379  phi_reserves_pr_up       Positive primary reserves fraction of total nonprimary reserves demand [0 1]
 380  phi_reserves_pr_do       Negative primary reserves fraction of total nonprimary reserves demand [0 1]
 381  *reserves_exog
 382   
 383   
 384  ***** Heat *****
 385  *--- Time data ---*
 386  dh_upload                Hourly heat demand per year for upload [MWh per m2]
 387  dh_y                     Hourly heat demand per year [MWh per m2]
 388  dh                       Hourly heat demand [MWh per m2]
 389  temp_source              Heat pumps - source temperature [°Celsius]
 390  d_dhw_upload             Hourly DHW demand per year for upload [MWh per m2]
 391  d_dhw_y                  Hourly DHW demand per year [MWh per m2]
 392  d_dhw                    Hourly DHW demand [MWh per m2]
 393  nets_profile(h)          Hourly exogenous heat demand by nonsmart night-time storage heaters [MWh per m2]
 394   
 395  *--- Technololgy attributes ---*
 396  phi_heat_type            Share of heating type ch per building archetype bu [0 1]
 397  eta_heat_stat            Static efficiency for heating technologies [0 1]
 398  eta_heat_dyn             Static efficiency for heating technologies [0 1]
 399  eta_dhw_aux_stat         Static efficiency for auxiliary DHW technologies [0 1]
 400  n_heat_p_in              Maximum power inflow into heating technologies [MW]
 401  n_heat_p_out             Maximum power outflow from heating technologies [MW]
 402  n_heat_e                 Maximum energy level of heating storage technologies [MWh]
 403  n_sets_p_in              SETS - Power rating - electricity intake [MW]
 404  n_sets_p_out             SETS - Power rating - heat output [MW]
 405  n_sets_e                 SETS - Energy storage capacity [MWh]
 406  n_sets_dhw_p_in          SETS auxiliary DHW module - power rating - electricity intake [MW]
 407  n_sets_dhw_p_out         SETS auxiliary DHW module - power rating - DHW output [MW]
 408  n_sets_dhw_e             SETS auxiliary DHW module - energy storage capacity [MWh]
 409  phi_heat_ini             Inititial storage level of heating technologies [0 1]
 410  temp_sink                Heat pumps - sink temperature [°Celsius]
 411  pen_heat_fuel            Penalty term for non-electric fuel usage for hybrid heating technologies [EUR per MWh]
 412  area_floor               Floor area subject to specific heating technology in specific building type [m2]
 413  theta_night              Indicator for night hours {0 1}
 414   
 415   
 416   
 417  ***************  DERIVED PARAMETERS  *******************************************
 418   
 419  c_m              Marginal production costs for conventional plants including variable O and M costs [EUR per MWh]
 420  c_i              Annualized investment costs by conventioanl plant [EUR per MW]
 421   
 422  c_i_res          Annualized investment costs by renewable plant [EUR per MW]
 423  c_fix_res        Annualized fixed costs by renewable plant [EUR per MW per a]
 424   
 425  c_i_sto_e        Annualized investment costs storage energy [EUR per MWh]
 426  c_i_sto_p        Annualized investment costs storage capacity [EUR per MW]
 427   
 428  c_i_rsvr_e       Annualized investment costs storage energy [EUR per MWh]
 429  c_i_rsvr_p       Annualized investment costs storage capacity [EUR per MW]
 430   
 431  c_i_dsm_cu       DSM: Annualized investment costs load curtailment [EUR per MW]
 432  c_i_dsm_shift    DSM: Annualized investment costs load shifting [EUR per MW]
 433   
 434  c_i_ntc          Investment for net transfer capacity [EUR per MW and km]
 435   
 436  phi_mean_reserves_call_y         Hourly mean of share reserves called per year [0 1]
 437  phi_mean_reserves_call           Hourly mean of share reserves called [0 1]
 438   
 439  theta_dir        Dummy equal to 1 if building type bu has direct heating type ch [0 1]
 440  theta_sets       Dummy equal to 1 if building type bu has SETS heating type ch [0 1]
 441  theta_hp         Dummy equal to 1 if building type bu has heat pump heating type ch [0 1]
 442  theta_elec       Dummy equal to 1 if building type bu has hybrif electric heating - electric part [0 1]
 443  theta_fossil     Dummy equal to 1 if building type bu has hybrif electric heating - fossil part [0 1]
 444  theta_storage    Dummy equal to 1 if building type ch has storage heating type ch [0 1]
 445   
 446   
 447   
 448   
 449  ***************  PARAMETERS FOR DATA UPLOAD  ***********************************
 450   
 451  technology_data_upload(tech,tech_res_con,tech_dispatch,headers_tech)
 452  technology_data(tech,headers_tech)
 453  storage_data(sto,headers_sto)
 454  reservoir_data(rsvr,headers_reservoir)
 455  time_data_upload(h,year,headers_time)
 456  dsm_data_upload(dsm,dsm_type,headers_dsm)
 457  dsm_data(dsm,headers_dsm)
 458  topology_data(l,headers_topology)
 459  ev_data(ev,headers_ev)
 460  ev_time_data_upload(h,headers_time_ev,ev)
 461  prosumage_data_generation(tech,headers_prosumage_generation)
 462  prosumage_data_storage(sto,headers_prosumage_storage)
 463  reserves_time_data_activation(h,year,reserves)
 464  reserves_time_data_provision(h,year,reserves)
 465  reserves_data_upload(reserves,reserves_up_down,reserves_spin_nonspin,reserves_prim_nonprim,headers_reserves)
 466  reserves_data(reserves,headers_reserves)
 467  heat_data_upload(bu,ch,heat_storage,heat_hp,heat_elec,heat_fossil,headers_heat)
 468  heat_data(bu,ch,headers_heat)
 469  dh_upload(h,year,headers_time_heat,bu)
 470  d_dhw_upload(h,year,headers_time_heat,bu)
 471  temp_source_upload
 472  ;
 473   
 474   
 475   
 476   
 477  ***************  UPLOAD TIME-CONSTANT SETS AND PARAMETERS  *********************
 478   
 538   
 539  *%skip_Excel%
 541   
GDXIN   C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\Data_input.gdx
--- LOAD  tech = 2:tech
--- LOAD  headers_tech = 3:headers_tech
--- LOAD  tech_dispatch = 4:tech_dispatch
--- LOAD  tech_res_con = 5:tech_res_con
--- LOAD  sto = 6:sto
--- LOAD  headers_sto = 7:headers_sto
--- LOAD  rsvr = 8:rsvr
--- LOAD  headers_reservoir = 9:headers_reservoir
--- LOAD  reservoir_data = 31:reservoir_data
--- LOAD  dsm = 10:dsm
--- LOAD  headers_dsm = 11:headers_dsm
--- LOAD  dsm_type = 12:dsm_type
--- LOAD  technology_data_upload = 29:technology_data_upload
--- LOAD  storage_data = 30:storage_data
--- LOAD  dsm_data_upload = 32:dsm_data_upload
 546   
--- LOAD  ev = 13:ev
--- LOAD  headers_ev = 14:headers_ev
--- LOAD  ev_data = 34:ev_data
--- LOAD  headers_prosumage_generation = 15:headers_prosumage_generation
--- LOAD  headers_prosumage_storage = 16:headers_prosumage_storage
--- LOAD  prosumage_data_generation = 35:prosumage_data_generation
--- LOAD  prosumage_data_storage = 36:prosumage_data_storage
--- LOAD  reserves = 17:reserves
--- LOAD  reserves_up_down = 19:reserves_up_down
--- LOAD  reserves_spin_nonspin = 20:reserves_spin_nonspin
--- LOAD  reserves_prim_nonprim = 21:reserves_prim_nonprim
--- LOAD  headers_reserves = 18:headers_reserves
--- LOAD  reserves_data_upload = 37:reserves_data_upload
--- LOAD  bu = 22:bu
--- LOAD  ch = 23:ch
--- LOAD  heat_storage = 24:heat_storage
--- LOAD  heat_hp = 25:heat_hp
--- LOAD  heat_elec = 26:heat_elec
--- LOAD  heat_fossil = 27:heat_fossil
--- LOAD  headers_heat = 28:headers_heat
--- LOAD  heat_data_upload = 38:heat_data_upload
 551  ;
 552   
      parameter inc ;
      inc(l,n) = 1 ;
      $ontext
 558   
 559   
 560  ***************  UPLOAD TIME-SERIES SETS AND PARAMETERS  ***********************
 561   
 587   
 588   
 589  *
GDXIN   C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\time_series.gdx
--- LOAD  h = 1:h
--- LOAD  headers_time = 2:headers_time
--- LOAD  year = 3:year
--- LOAD  time_data_upload = 4:time_data_upload
 593  *$load headers_time_ev ev_time_data_upload
 594  *$load reserves_time_data_activation
 595  *$load reserves_time_data_provision
 596  *$load headers_time_heat dh_upload
 597  *$load theta_night
 598  *$load temp_source_upload
 599  *$load headers_time_dhw d_dhw_upload nets_profile
 600  ;
 601   
 602   
 603   
 604   
 605  ***************  ASSIGNMENTS  **************************************************
 606   
 607   
 608   
 609  ***** Aliases *****
 610  alias (h,hh) ;
 611  alias (res,resres) ;
 612  alias (reserves,reservesreserves) ;
 613  alias (nondis,nondisnondis) ;
 614   
 615   
 616   
 617  ***** Derived sets *****
 618  dis(tech)$sum( (tech_res_con,headers_tech), technology_data_upload(tech,tech_res_con,'dis',headers_tech)) = yes;
 619  nondis(tech)$sum( (tech_res_con,headers_tech), technology_data_upload(tech,tech_res_con,'nondis',headers_tech)) = yes;
 620   
 621  con(tech)$sum( (tech_dispatch,headers_tech), technology_data_upload(tech,'con',tech_dispatch,headers_tech)) = yes;
 622  res(tech)$sum( (tech_dispatch,headers_tech), technology_data_upload(tech,'res',tech_dispatch,headers_tech)) = yes;
 623   
      reserves_up(reserves)$sum( (reserves_spin_nonspin,reserves_prim_nonprim,headers_reserves), reserves_data_upload(reserves,'up',reserves_spin_nonspin,reserves_prim_nonprim,headers_reserves)) = yes;
      reserves_do(reserves)$sum( (reserves_spin_nonspin,reserves_prim_nonprim,headers_reserves), reserves_data_upload(reserves,'do',reserves_spin_nonspin,reserves_prim_nonprim,headers_reserves)) = yes;
       
      reserves_spin(reserves)$sum( (reserves_up_down,reserves_prim_nonprim,headers_reserves), reserves_data_upload(reserves,reserves_up_down,'spin',reserves_prim_nonprim,headers_reserves)) = yes;
      reserves_nonspin(reserves)$sum( (reserves_up_down,reserves_prim_nonprim,headers_reserves), reserves_data_upload(reserves,reserves_up_down,'nonspin',reserves_prim_nonprim,headers_reserves)) = yes;
       
      reserves_prim(reserves)$sum( (reserves_up_down,reserves_spin_nonspin,headers_reserves), reserves_data_upload(reserves,reserves_up_down,reserves_spin_nonspin,'prim',headers_reserves)) = yes;
      reserves_nonprim(reserves)$sum( (reserves_up_down,reserves_spin_nonspin,headers_reserves), reserves_data_upload(reserves,reserves_up_down,reserves_spin_nonspin,'nonprim',headers_reserves)) = yes;
       
      reserves_prim_up(reserves)$sum( (reserves_spin_nonspin,headers_reserves), reserves_data_upload(reserves,'up',reserves_spin_nonspin,'prim',headers_reserves)) = yes;
      reserves_prim_do(reserves)$sum( (reserves_spin_nonspin,headers_reserves), reserves_data_upload(reserves,'do',reserves_spin_nonspin,'prim',headers_reserves)) = yes;
      reserves_nonprim_up(reserves)$sum( (reserves_spin_nonspin,headers_reserves), reserves_data_upload(reserves,'up',reserves_spin_nonspin,'nonprim',headers_reserves)) = yes;
      reserves_nonprim_do(reserves)$sum( (reserves_spin_nonspin,headers_reserves), reserves_data_upload(reserves,'do',reserves_spin_nonspin,'nonprim',headers_reserves)) = yes;
       
      hst(ch)$sum( (bu,heat_hp,heat_elec,heat_fossil,headers_heat), heat_data_upload(bu,ch,'yes',heat_hp,heat_elec,heat_fossil,headers_heat)) = yes;
      hp(ch)$sum( (bu,heat_storage,heat_elec,heat_fossil,headers_heat), heat_data_upload(bu,ch,heat_storage,'yes',heat_elec,heat_fossil,headers_heat)) = yes;
       
      hel(ch)$sum( (bu,heat_storage,heat_hp,heat_fossil,headers_heat), heat_data_upload(bu,ch,heat_storage,heat_hp,'yes',heat_fossil,headers_heat)) = yes;
      hfo(ch)$sum( (bu,heat_storage,heat_hp,heat_elec,headers_heat), heat_data_upload(bu,ch,heat_storage,heat_hp,heat_elec,'yes',headers_heat)) = yes;
 645   
 646   
 647   
 648  ***** Parameters *****
 649   
 650  *--- Generation technologies ---*
 651  technology_data(tech,headers_tech) = sum((tech_res_con,tech_dispatch), technology_data_upload(tech,tech_res_con,tech_dispatch,headers_tech)) ;
 652  eta(tech) = technology_data(tech,'eta_con') ;
 653  carbon_content(tech) = technology_data(tech,'carbon_content') ;
 654  c_up(dis) =technology_data(dis,'load change costs up') ;
 655  c_do(dis) = technology_data(dis,'load change costs down') ;
 656  c_fix(tech) = technology_data(tech,'fixed_costs') ;
 657  c_vom(tech) = technology_data(tech,'variable_om') ;
 658  CO2price(tech) = technology_data(tech,'CO2_price') ;
 659   
 660  c_inv_overnight(tech) = technology_data(tech,'oc') ;
 661  lifetime(tech) = technology_data(tech,'lifetime') ;
 662  recovery(tech) = technology_data(tech,'recovery_period') ;
 663  interest_rate(tech) = technology_data(tech,'interest_rate') ;
 664  m_p(tech) = technology_data(tech,'max_installable') ;
 665  m_e(tech) = technology_data(tech,'max_energy') ;
 666  grad_per_min(dis) = technology_data(dis,'load change flexibility') ;
 667  fuelprice(tech) = technology_data(tech,'fuel costs') ;
 668   
 669  c_cu(res) = technology_data(res,'curtailment_costs') ;
 670   
 671   
 672  *--- Storage technologies ---*
 673  c_m_sto(sto) = storage_data(sto,'mc');
 674  eta_sto(sto) = storage_data(sto,'efficiency');
 675  c_fix_sto(sto) = storage_data(sto,'fixed_costs');
 676  phi_sto_ini(sto) = storage_data(sto,'level_start');
 677  etop_max(sto) = storage_data(sto,'etop_max') ;
 678   
 679  c_inv_overnight_sto_e(sto) = storage_data(sto,'oc_energy');
 680  c_inv_overnight_sto_p(sto) = storage_data(sto,'oc_capacity');
 681  lifetime(sto) = storage_data(sto,'lifetime');
 682  interest_rate(sto) = storage_data(sto,'interest_rate');
 683  m_sto_e(sto) = storage_data(sto,'max_energy');
 684  m_sto_p(sto) = storage_data(sto,'max_power');
 685   
      *--- Reservoir technologies ---*
      c_m_rsvr(rsvr) = reservoir_data(rsvr,'mc');
      eta_rsvr(rsvr) = reservoir_data(rsvr,'efficiency');
      c_fix_rsvr(rsvr) = reservoir_data(rsvr,'fixed_costs');
      phi_rsvr_ini(rsvr) = reservoir_data(rsvr,'level_start');
      phi_rsvr_lev_min(rsvr) = reservoir_data(rsvr,'level_min');
       
      c_inv_overnight_rsvr_e(rsvr) = reservoir_data(rsvr,'oc_energy');
      c_inv_overnight_rsvr_p(rsvr) = reservoir_data(rsvr,'oc_capacity');
      inv_lifetime_rsvr(rsvr) = reservoir_data(rsvr,'lifetime');
      inv_interest_rsvr(rsvr) = reservoir_data(rsvr,'interest_rate');
      m_rsvr_e(rsvr) = reservoir_data(rsvr,'max_energy');
      m_rsvr_p(rsvr) = reservoir_data(rsvr,'max_power');
       
       
      *--- DSM technologies ---*
      dsm_curt(dsm)$sum( (dsm_type,headers_dsm), dsm_data_upload(dsm,'curt',headers_dsm)) = yes;
      dsm_shift(dsm)$sum( (dsm_type,headers_dsm), dsm_data_upload(dsm,'shift',headers_dsm)) = yes;
      dsm_data(dsm,headers_dsm) = sum(dsm_type, dsm_data_upload(dsm,dsm_type,headers_dsm) ) ;
       
      c_m_dsm_cu(dsm_curt) = dsm_data(dsm_curt,'mc')     ;
      c_m_dsm_shift(dsm_shift) = dsm_data(dsm_shift,'mc')  ;
      c_fix_dsm_cu(dsm_curt) = dsm_data(dsm_curt,'fc')  ;
      c_fix_dsm_shift(dsm_shift) = dsm_data(dsm_shift,'fc') ;
       
      t_dur_dsm_cu(dsm_curt) = dsm_data(dsm_curt,'max_duration')   ;
      t_off_dsm_cu(dsm_curt) = dsm_data(dsm_curt,'recovery_time')   ;
      t_dur_dsm_shift(dsm_shift) = dsm_data(dsm_shift,'max_duration')   ;
      t_off_dsm_shift(dsm_shift) = dsm_data(dsm_shift,'recovery_time')   ;
      eta_dsm_shift(dsm_shift)  = dsm_data(dsm_shift,'efficiency')   ;
       
      c_inv_overnight_dsm_cu(dsm_curt) =  dsm_data(dsm_curt,'oc')   ;
      c_inv_overnight_dsm_shift(dsm_shift)  =  dsm_data(dsm_shift,'oc')   ;
      inv_recovery_dsm_cu(dsm_curt)  =  dsm_data(dsm_curt,'lifetime')   ;
      inv_recovery_dsm_shift(dsm_shift)   =  dsm_data(dsm_shift,'lifetime')   ;
      inv_interest_dsm_cu(dsm_curt)   =  dsm_data(dsm_curt,'interest_rate')   ;
      inv_interest_dsm_shift(dsm_shift)  =  dsm_data(dsm_shift,'interest_rate')   ;
      m_dsm_cu(dsm_curt) =  dsm_data(dsm_curt,'max_installable')   ;
      m_dsm_shift(dsm_shift) =  dsm_data(dsm_shift,'max_installable')   ;
 727   
 728  *--- Temporal data ---*
 729  d_y(year,h) = time_data_upload(h,year,'demand')  ;
 730  phi_res_y(year,res,h) = sum(headers_time$(sameas(res,headers_time)), time_data_upload(h,year,headers_time));
 731   
 732  *rsvr_in_y(year,rsvr,h) = sum(headers_time$(sameas(rsvr,headers_time)), time_data_upload(h,year,headers_time));
 733  *phi_reserves_call_y(year,reserves,h) = reserves_time_data_activation(h,year,reserves) ;
 734  *reserves_exogenous_y(year,reserves,h) = reserves_time_data_provision(h,year,reserves) ;
 735   
 736   
 737  *--- Spatial data ---*
 738  *inv_lifetime_ntc(l) = topology_data(l,'lifetime') ;
 739  *inv_recovery_ntc(l) = topology_data(l,'recovery_period') ;
 740  *inv_interest_ntc(l) = topology_data(l,'interest_rate') ;
 741  *c_inv_overnight_ntc(l) = topology_data(l,'overnight_costs') ;
 742  *c_fix_ntc(l) = topology_data(l,'fixed_costs') ;
 743  *m_ntc(l) = topology_data(l,'max_installable') ;
 744  *dist(l) = topology_data(l,'distance') ;
 745   
      *--- Electric vehicles ---*
      c_m_ev(ev) = ev_data(ev,'mc') ;
      pen_phevfuel(ev) = ev_data(ev,'penalty_fuel') ;
      eta_ev_in(ev) = ev_data(ev,'efficiency_charge') ;
      eta_ev_out(ev) = ev_data(ev,'efficiency_discharge') ;
      phi_ev_ini(ev) = ev_data(ev,'ev_start') ;
       
      n_ev_e(ev) = ev_data(ev,'ev_capacity') ;
      phi_ev(ev) = ev_data(ev,'share_ev') ;
      ev_phev(ev) = ev_data(ev,'ev_type') ;
       
      n_ev_p(ev,h) = ev_time_data_upload(h,'n_ev_p',ev) ;
      ev_ed(ev,h) = ev_time_data_upload(h,'ev_ed',ev) ;
      ev_ged_exog(ev,h) = ev_time_data_upload(h,'ev_ged_exog',ev) ;
 762   
 763  *--- Prosumage ---*
 764  m_res_pro(res) = prosumage_data_generation(res,'max_power') ;
 765  m_sto_pro_e(sto) = prosumage_data_storage(sto,'max_energy') ;
 766  m_sto_pro_p(sto) = prosumage_data_storage(sto,'max_power') ;
 767  phi_sto_pro_ini(sto) = prosumage_data_storage(sto,'level_start') ;
 768   
      *--- Reserves ---*
      reserves_data(reserves,headers_reserves) = sum((reserves_up_down,reserves_spin_nonspin,reserves_prim_nonprim), reserves_data_upload(reserves,reserves_up_down,reserves_spin_nonspin,reserves_prim_nonprim,headers_reserves)) ;
      phi_reserves_share(reserves) = reserves_data(reserves,'share_sr_mr') ;
      reserves_intercept(reserves) = reserves_data(reserves,'intercept') ;
      reserves_slope(reserves,'wind_on') = reserves_data(reserves,'slope_wind_on') ;
      reserves_slope(reserves,'wind_off') = reserves_data(reserves,'slope_wind_off') ;
      reserves_slope(reserves,'pv') = reserves_data(reserves,'slope_pv') ;
      reserves_reaction(reserves) = reserves_data(reserves,'reaction_time') ;
      phi_reserves_pr_up(n) = reserves_data('PR_up','fraction_pr') ;
      phi_reserves_pr_do(n) = reserves_data('PR_do','fraction_pr') ;
       
       
      *--- Heat ---*
      heat_data(bu,ch,headers_heat) = sum((heat_storage,heat_hp,heat_elec,heat_fossil), heat_data_upload(bu,ch,heat_storage,heat_hp,heat_elec,heat_fossil,headers_heat)) ;
      phi_heat_type(bu,ch) = heat_data(bu,ch,'share') ;
      dh_y(year,bu,ch,h) = phi_heat_type(bu,ch) * dh_upload(h,year,'demand',bu) ;
      d_dhw_y(year,bu,ch,h) = phi_heat_type(bu,ch) * d_dhw_upload(h,year,'demand',bu) ;
       
      eta_heat_stat(bu,ch) = heat_data(bu,ch,'static_efficiency') ;
      eta_heat_dyn(bu,ch) = heat_data(bu,ch,'dynamic_efficiency') ;
      eta_dhw_aux_stat(bu,ch) = heat_data(bu,ch,'static_efficiency_sets_aux_dhw') ;
      * currently not used
      n_heat_p_in(bu,ch) = heat_data(bu,ch,'max_power') ;
      n_heat_p_out(bu,ch) = heat_data(bu,ch,'max_outflow') ;
      n_heat_e(bu,ch) = heat_data(bu,ch,'max_level') ;
      n_sets_p_in(bu,ch) = heat_data(bu,ch,'max_power') ;
      n_sets_p_out(bu,ch) = heat_data(bu,ch,'max_outflow') ;
      n_sets_e(bu,ch) = heat_data(bu,ch,'max_level') ;
      n_sets_dhw_p_in(bu,ch) = heat_data(bu,ch,'max_power_in_sets_aux_dhw') ;
      n_sets_dhw_p_out(bu,ch) = heat_data(bu,ch,'max_power_out_sets_aux_dhw') ;
      n_sets_dhw_e(bu,ch) = heat_data(bu,ch,'max_energy_sets_aux_dhw') ;
      phi_heat_ini(bu,ch) = heat_data(bu,ch,'level_ini') ;
      temp_sink(bu,ch) = heat_data(bu,ch,'temperature_sink') ;
       
      temp_source(bu,'hp_as',h) = temp_source_upload(h,'hp_as') ;
      temp_source(bu,'hp_gs',h) = heat_data(bu,'hp_gs','temperature_source') ;
       
      temp_source(bu,'gas_hp_gs',h) = heat_data(bu,'gas_hp_gs','temperature_source') ;
      temp_source(bu,'hp_gs_elec',h) = heat_data(bu,'hp_gs_elec','temperature_source') ;
       
      pen_heat_fuel(bu,ch) = heat_data(bu,ch,'penalty_non-electric_heat_supply') ;
       
      area_floor(bu,ch) = heat_data(bu,ch,'area_floor') ;
 814   
 815   
 816  ***************  CALCULATE DERIVED PARAMETERS  *********************************
 817   
 818  c_m(tech) = fuelprice(tech)/eta(tech) + carbon_content(tech)/eta(tech)*CO2price(tech) + c_vom(tech)   ;
 819   
 820  c_i(tech) = c_inv_overnight(tech)*( interest_rate(tech) * (1+interest_rate(tech))**(lifetime(tech)) )
 821                    / ( (1+interest_rate(tech))**(lifetime(tech))-1 )       ;
 822   
 823  c_i_res(res) = c_i(res) ;
 824  c_fix_res(res) = c_fix(res) ;
 825   
 826  c_i_sto_e(sto) = c_inv_overnight_sto_e(sto)*( interest_rate(sto) * (1+interest_rate(sto))**(lifetime(sto)) )
 827                   / ( (1+interest_rate(sto))**(lifetime(sto))-1 )       ;
 828   
 829  c_i_sto_p(sto) = c_inv_overnight_sto_p(sto)*( interest_rate(sto) * (1+interest_rate(sto))**(lifetime(sto)) )
 830                   / ( (1+interest_rate(sto))**(lifetime(sto))-1 )       ;
      c_i_rsvr_e(rsvr) = c_inv_overnight_rsvr_e(rsvr)*( inv_interest_rsvr(rsvr) * (1+inv_interest_rsvr(rsvr))**(inv_lifetime_rsvr(rsvr)) )
                       / ( (1+inv_interest_rsvr(rsvr))**(inv_lifetime_rsvr(rsvr))-1 )       ;
       
      c_i_rsvr_p(rsvr) = c_inv_overnight_rsvr_p(rsvr)*( inv_interest_rsvr(rsvr) * (1+inv_interest_rsvr(rsvr))**(inv_lifetime_rsvr(rsvr)) )
                       / ( (1+inv_interest_rsvr(rsvr))**(inv_lifetime_rsvr(rsvr))-1 )       ;
       
      c_i_dsm_cu(dsm_curt) =c_inv_overnight_dsm_cu(dsm_curt)*( inv_interest_dsm_cu(dsm_curt) * (1+inv_interest_dsm_cu(dsm_curt))**(inv_recovery_dsm_cu(dsm_curt)) )
                       / ( (1+inv_interest_dsm_cu(dsm_curt))**(inv_recovery_dsm_cu(dsm_curt))-1 )       ;
       
      c_i_dsm_shift(dsm_shift) = c_inv_overnight_dsm_shift(dsm_shift)*( inv_interest_dsm_shift(dsm_shift) * (1+inv_interest_dsm_shift(dsm_shift))**(inv_recovery_dsm_shift(dsm_shift)) )
                       / ( (1+inv_interest_dsm_shift(dsm_shift))**(inv_recovery_dsm_shift(dsm_shift))-1 )       ;
       
      c_i_ntc(l) = c_inv_overnight_ntc(l) * (inv_interest_ntc(l) * (1 + inv_interest_ntc(l))**(inv_lifetime_ntc(l)) )
                       / ((1 + inv_interest_ntc(l)) ** (inv_lifetime_ntc(l))-1 ) ;
       
      phi_mean_reserves_call_y(year,reserves) = sum(h, phi_reserves_call_y(year,reserves,h) ) / card(h) + eps ;
       
       
      theta_sets(bu,'setsh')$(smax( (heat_storage,heat_hp,heat_elec,heat_fossil,headers_heat) , heat_data_upload(bu,'setsh',heat_storage,heat_hp,heat_elec,heat_fossil,headers_heat)) > 0 AND phi_heat_type(bu,'setsh')) = 1;
      theta_dir(bu,'dir')$(smax((heat_storage,heat_hp,heat_elec,heat_fossil,headers_heat) , heat_data_upload(bu,'dir',heat_storage,heat_hp,heat_elec,heat_fossil,headers_heat)) > 0 AND phi_heat_type(bu,'dir')) = 1;
       
      theta_storage(bu,ch)$(sum((heat_hp,heat_elec,heat_fossil,headers_heat), heat_data_upload(bu,ch,'yes',heat_hp,heat_elec,heat_fossil,headers_heat)) AND phi_heat_type(bu,ch)) = 1;
      theta_hp(bu,ch)$sum( (heat_storage,heat_elec,heat_fossil,headers_heat), heat_data_upload(bu,ch,heat_storage,'yes',heat_elec,heat_fossil,headers_heat) AND phi_heat_type(bu,ch)) = 1;
       
      theta_elec(bu,ch)$sum( (heat_storage,heat_hp,heat_fossil,headers_heat), heat_data_upload(bu,ch,heat_storage,heat_hp,'yes',heat_fossil,headers_heat) AND phi_heat_type(bu,ch)) = 1;
      theta_fossil(bu,ch)$sum( (heat_storage,heat_hp,heat_elec,headers_heat), heat_data_upload(bu,ch,heat_storage,heat_hp,heat_elec,'yes',headers_heat) AND phi_heat_type(bu,ch)) = 1;
 859   
 860   
 861  ***************  Adjust costs to model's hourly basis **************************
 862   
 863  c_i(tech) = c_i(tech)*card(h)/8760 ;
 864  c_i_res(tech) = c_i_res(tech)*card(h)/8760 ;
 865  c_i_sto_p(sto) = c_i_sto_p(sto)*card(h)/8760 ;
 866  c_i_sto_e(sto) = c_i_sto_e(sto)*card(h)/8760 ;
 867  *c_i_rsvr_e(rsvr) = c_i_rsvr_e(rsvr)*card(h)/8760 ;
 868  *c_i_rsvr_p(rsvr) = c_i_rsvr_p(rsvr)*card(h)/8760 ;
 869  *c_i_dsm_cu(dsm_curt) = c_i_dsm_cu(dsm_curt)*card(h)/8760 ;
 870  *c_i_dsm_shift(dsm_shift) = c_i_dsm_shift(dsm_shift)*card(h)/8760 ;
 871   
 872  c_fix(tech) = c_fix(tech)*card(h)/8760 ;
 873  c_fix_sto(sto) = c_fix_sto(sto)*card(h)/8760 ;
 874  *c_fix_dsm_cu(dsm_curt) = c_fix_dsm_cu(dsm_curt)*card(h)/8760 ;
 875  *c_fix_dsm_shift(dsm_shift) = c_fix_dsm_shift(dsm_shift)*card(h)/8760 ;
 876  *c_fix_rsvr(rsvr) = c_fix_rsvr(rsvr)*card(h)/8760 ;
 877   
 878  m_e('bio') = m_e('bio')*card(h)/8760 ;
 879   
 880  *c_i_ntc(l) = c_i_ntc(l) * card(h)/8760 ;
 881   
 882  *t_dur_dsm_cu(dsm_curt) = t_dur_dsm_cu(dsm_curt) ;
 883  *t_off_dsm_cu(dsm_curt) = t_off_dsm_cu(dsm_curt) ;
 884  *t_dur_dsm_shift(dsm_shift)$(ord(dsm_shift)=2 or ord(dsm_shift)=4 or ord(dsm_shift)=5) = t_dur_dsm_shift(dsm_shift) / 2 ;
 885  *t_dur_dsm_shift(dsm_shift)$(ord(dsm_shift)=1 or ord(dsm_shift)=3) = 2 ;
 886   
 887   
 888   
 889  ********************************************************************************
 890   
 891   
 892   
 893   
 894   
 895   
 896   
 897   
 898   
 899  ********************************************************************************
 900   
 901  ***************************
 902  ***** Initialize data *****
 903  ***************************
 904   
 905  * Parameters for default base year
 906  d(h) = d_y('2030',h) ;
 907  phi_res(res,h) = phi_res_y('2030',res,h) ;
 908  phi_min_res = 0 ;
 909  phi_pro_self = 0 ;
 910  phi_pro_load = 0 ;
 911   
      phi_pro_load = 0.2 ;
      $ontext
 916   
 917   
 918  Parameter
 919  phi_min_res_exog;
 920  phi_min_res_exog = 1 ;
 921   
 922  Sets
 923  h_ini(h)                       First hour  /h1/
 924  *h_end(h)                       Last hour   /h8760/
 925  ;
 926   
 927  ********************************************************************************
 928  ***** Model *****
 929  ********************************************************************************
 930   
INCLUDE    C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\model.gms
 932   
 933  ********************************************************************************
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DIETER).
      Version 1.3.0, October 2017.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses/mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
 943  ********************************************************************************
 944   
 945   
 946  Variables
 947  Z                  Value objective function [Euro]
 948  lambda_enerbal     Dual variable on energy balance (1a)
 949  lambda_resgen      Dual variable on renewable generation (3e)
 950  lambda_convgen     Dual variable on conventional generation level (2a)
 951  lambda_stolev      Dual variable on storage level  (4b)
 952  ;
 953   
 954  Positive Variables
 955  G_L(tech,h)            Generation level in hour h [MWh]
 956  G_UP(tech,h)           Generation upshift in hour h [MWh]
 957  G_DO(tech,h)           Generation downshift in hour h [MWh]
 958  G_RES(tech,h)          Generation renewables type res in hour h [MWh]
 959  CU(tech,h)             Renewables curtailment technology res in hour h [MWh]
 960   
 961  STO_IN(sto,h)          Storage inflow technology sto hour h [MWh]
 962  STO_OUT(sto,h)         Storage outflow technology sto hour h [MWh]
 963  STO_L(sto,h)           Storage level technology sto hour h [MWh]
 964   
 965  N_TECH(tech)           Technology tech built [MW]
 966  N_STO_E(sto)           Storage technology built - Energy [MWh]
 967  N_STO_P(sto)           Storage loading and discharging capacity built - Capacity [MW]
 968   
 969  CU_PRO(tech,h)                 Prosumage: curtailment of renewable generation in hour h [MWh]
 970  G_MARKET_PRO2M(tech,h)         Prosumage. energy sent to market in hour h [MWh]
 971  G_MARKET_M2PRO(h)              Prosumage: withdrawal of energy from market in hour h [MWh]
 972  G_RES_PRO(tech,h)              Prosumage: hourly renewables generation in hour h [MWh]
 973  STO_IN_PRO2PRO(tech,sto,h)     Prosumage: storage loading from generation for discharging to consumption in hour h [MWh]
 974  STO_OUT_PRO2PRO(sto,h)         Prosumage: storage discharging to consumption from generation in hour h [MWh]
 975  STO_L_PRO2PRO(sto,h)           Prosumage: storage level generation to consumption in hour h [MWh]
 976  N_STO_E_PRO(sto)               Prosumage: installed storage energy [MWh]
 977  N_STO_P_PRO(sto)               Prosumage: installed storage power [MW]
 978  N_RES_PRO(tech)                Prosumage: installed renewables capacities [MW]
 979   
 980   
 981  mu_stoin_cap          Dual variable on storage loading capacity constraint (4d)
 982  mu_stout_cap          Dual variable on storage discharging capacity constraint (4e)
 983  mu_stolev_cap         Dual variable on energy capacity constraint (4c)
 984  mu_conv_cap           Dual variable on conventional generation capacity constraint (3a)
 985  mu_bio_cap            Dual variable on storage bio energy constraint (5b)
 986  mu_dis_max_i          Dual variable on dispatchable installation constraint (8a)
 987  mu_nondis_max_i       Dual variable on nondispatchable installation constraint (8a)
 988  mu_tech_max_i         Dual variable on tech installation constraint (8a)
 989  mu_stop_max_i         Dual variable on storage power installation constraint  (8c)
 990  mu_stoe_max_i         Dual variable on storage energy installation constraint  (8b)
 991  mu_minRES             Dual variable on minimum renewable share constraint (5a)
 992   
 993  ;
 994   
 995  Set
 996  dis_bio(tech)          Subset of dispatchable technology: Bio mass        /bio/
 997  ;
 998   
 999   
1000  ********************************************************************************
1001   
1002  Equations
1003  * Objective
1004  obj                      Objective cost minimization
1005   
1006  * Energy balance
1007  con1a_bal                Energy Balance
1008   
1009  * Load change costs
1010  con2a_loadlevel          Load change costs: Level
1011  con2b_loadlevelstart     Load change costs: Level for first period
1012  con2_loadlevel           Load change costs: Level of all periods (2a+2b)
1013  * Capacity contraints and flexibility constraints
1014  con3a_maxprod_dispatchable       Capacity Constraint conventionals
1015  con3e_maxprod_res                Capacity constraints renewables
1016   
1017  * Storage constraints
1018  con4a_stolev_start        Storage Level Dynamics Initial Condition
1019  con4b_stolev              Storage Level Dynamics
1020  con4_stolev               Storage Level Dynamics all periods(4a + 4b)
1021  con4c_stolev_max          Storage Power Capacity
1022  con4d_maxin_sto           Storage maximum inflow
1023  con4e_maxout_sto          Storage maximum outflow
1024  con4j_ending              End level equal to initial level
1025  con4k_PHS_EtoP            Maximum E-P ratio
1026   
1027  * Minimum restrictions for renewables and biomass
1028  con5a_minRES             Minimum yearly renewables requirement
1029  con5b_max_energy         Maximum yearly biomass energy
1030   
1031  * Maximum installation conditions
1032  con8a_max_I_power                Maximum installable capacity: Conventionals
1033  con8b_max_I_sto_e                Maximum installable energy: Storage energy in MWh
1034  con8c_max_I_sto_p                Maximum installable capacity: Storage inflow-outflow in MW
1035   
1036  con8f_max_pro_res                Maximum installable capacity: prosumage renewables
1037  con8g_max_pro_sto_e              Maximum installable capacity: prosumage storage energy
1038  con8h_max_sto_pro_p              Maximum installable capacity: prosumage storage power
1039   
1040  * Prosumage
1041  con11a_pro_distrib                       Prosumage: distribution of generated energy
1042  con11b_pro_balance                       Prosumage: energy balance
1043  con11c_pro_selfcon                       Prosumage: minimum self-generation requirement
1044  con11d_pro_stolev_PRO2PRO                Prosumage: storage level prosumager-to-prosumagers
1045  con11h_1_pro_stolev_start_PRO2PRO        Prosumage: storage level initial conditions
1046  con11j_pro_stolev_max                    Prosumage: maximum overall storage level
1047  con11k_pro_maxin_sto                     Prosumage: maximum storage inflow
1048  con11l_pro_maxout_sto                    Prosumage: maximum storage outflow
1049  con11o_pro_ending                        Prosumage: storage ending condition
1050   
1051   
1052  * KKT optimality conditions
1053  KKTG_L                   KKT w.r.t. G_L
1054  KKTG_UP                  KKT w.r.t. G_UP
1055  KKTG_DO                  KKT w.r.t. G_DO
1056  KKTG_RES                 KKT w.r.t. G_RES
1057  KKTCU                    KKT w.r.t. CU
1058  KKTSTO_IN                KKT w.r.t. STO_IN
1059  KKTSTO_OUT               KKT w.r.t. STO_OUT
1060  KKTSTO_L                 KKT w.r.t. STO_L
1061  KKTN_TECH_NONDIS         KKT w.r.t. N_TECH(nondis)
1062  KKTN_TECH_DIS            KKT w.r.t. N_TECH(dis)
1063  KKTN_TECH                KKT w.r.t. N_TECH
1064  KKTN_STO_E               KKT w.r.t. N_STO_E
1065  KKTN_STO_P               KKT w.r.t. N_STO_P
1066  ;
1067   
1068   
1069  ********************************************************************************
1070   
1071  * ---------------------------------------------------------------------------- *
1072  ***** Objective function *****
1073  * ---------------------------------------------------------------------------- *
1074   
1075  obj..
1076           Z =E=
1077                     sum( (h,dis) , c_m(dis)*G_L(dis,h) )
1078                   + sum( (h,dis)$(ord(h)>1) , c_up(dis)*G_UP(dis,h) )
1079                   + sum( (h,dis) , c_do(dis)*G_DO(dis,h) )
1080                   + sum( (h,nondis) , c_cu(nondis)*CU(nondis,h) )
1081                   + sum( (h,sto) , c_m_sto(sto) * ( STO_OUT(sto,h) + STO_IN(sto,h) ) )
1082                   + sum( tech , c_i(tech)*N_TECH(tech) )
1083                   + sum( tech , c_fix(tech)*N_TECH(tech) )
1084                   + sum( sto , c_i_sto_e(sto)*N_STO_E(sto) )
1085                   + sum( sto , c_fix_sto(sto)/2*(N_STO_P(sto)+ N_STO_E(sto)) )
1086                   + sum( sto , c_i_sto_p(sto)*N_STO_P(sto) )
                       + sum( res , c_i(res)*N_RES_PRO(res) )
                       + sum( res , c_fix(res)*N_RES_PRO(res) )
                       + sum( sto , c_i_sto_e(sto)*N_STO_E_PRO(sto) )
                       + sum( sto , c_fix_sto(sto)/2*(N_STO_P_PRO(sto) + N_STO_E_PRO(sto)) )
                       + sum( sto , c_i_sto_p(sto)*N_STO_P_PRO(sto) )
                       + sum( (h,sto) , c_m_sto(sto) * ( STO_OUT_PRO2PRO(sto,h) + sum( res , STO_IN_PRO2PRO(res,sto,h)) ) )
      $ontext
1096  ;
1097   
1098  * ---------------------------------------------------------------------------- *
1099  ***** Energy balance and load levels *****
1100  * ---------------------------------------------------------------------------- *
1101   
1102  * Energy balance
1103  con1a_bal(h)..
1104   
1105             sum( dis , G_L(dis,h)) + sum( nondis , G_RES(nondis,h)) + sum( sto , STO_OUT(sto,h) )
               + sum( res , G_MARKET_PRO2M(res,h) )
      $ontext
1110           -  ( 1 - phi_pro_load )* d(h)
1111           -   sum( sto , STO_IN(sto,h) )
1112   
               - G_MARKET_M2PRO(h)
      $ontext
1117   
1118         =E= 0
1119  ;
1120   
1121  con2a_loadlevel(dis,h)$(ord(h) > 1)..
1122           G_L(dis,h-1) + G_UP(dis,h) - G_DO(dis,h)  - G_L(dis,h) =E= 0
1123  ;
1124   
1125  con2b_loadlevelstart(dis,h)$(ord(h) = 1)..
1126          G_UP(dis,h) - G_L(dis,h) =E= 0
1127  ;
1128   
1129  con2_loadlevel(dis,h)..
1130             G_UP(dis,h)  - G_L(dis,h)
1131          +  (G_L(dis,h-1) - G_DO(dis,h))$(ord(h) > 1)
1132          =E= 0
1133  ;
1134   
1135   
1136   
1137  * ---------------------------------------------------------------------------- *
1138  ***** Hourly maximum generation caps *****
1139  * ---------------------------------------------------------------------------- *
1140   
1141  con3a_maxprod_dispatchable(dis,h)..
1142   
1143           N_TECH(dis) -  G_L(dis,h)  =G= 0
1144   
1145  ;
1146   
1147  con3e_maxprod_res(nondis,h)..
1148   
1149   
1150         phi_res(nondis,h)*N_TECH(nondis) - G_RES(nondis,h) - CU(nondis,h) =E= 0
1151  ;
1152   
1153  * ---------------------------------------------------------------------------- *
1154  ***** Storage constraints *****
1155  * ---------------------------------------------------------------------------- *
1156   
1157  con4a_stolev_start(sto,h)$(ord(h) = 1)..
1158          phi_sto_ini(sto) * N_STO_E(sto) + STO_IN(sto,h)*(1+eta_sto(sto))/2 - STO_OUT(sto,h)/(1+eta_sto(sto))*2  - STO_L(sto,h)  =E= 0
1159  ;
1160   
1161  con4b_stolev(sto,h)$(ord(h)>1)..
1162          STO_L(sto,h-1) + STO_IN(sto,h)*(1+eta_sto(sto))/2 - STO_OUT(sto,h)/(1+eta_sto(sto))*2  -  STO_L(sto,h) =E= 0
1163  ;
1164   
1165  con4_stolev(sto,h)..
1166   
1167         + STO_IN(sto,h)*(1+eta_sto(sto))/2 - STO_OUT(sto,h)/(1+eta_sto(sto))*2  -  STO_L(sto,h)
1168         + (STO_L(sto,h-1))$(ord(h)>1)
1169         =E= 0
1170  ;
1171   
1172   
1173  con4c_stolev_max(sto,h)..
1174         N_STO_E(sto) -  STO_L(sto,h) =G= 0
1175  ;
1176   
1177  con4d_maxin_sto(sto,h)..
1178   
1179          N_STO_P(sto) -  STO_IN(sto,h)   =G= 0
1180  ;
1181   
1182  con4e_maxout_sto(sto,h)..
1183   
1184          N_STO_P(sto) - STO_OUT(sto,h)   =G= 0
1185  ;
1186   
1187  con4j_ending(sto,h)$(ord(h) = card(h))..
1188   
1189          phi_sto_ini(sto) * N_STO_E(sto) -  STO_L(sto,h) =E= 0
1190  ;
1191   
1192   
1193  con4k_PHS_EtoP(sto)..
1194           etop_max(sto) * N_STO_P(sto) - N_STO_E(sto) =G= 0
1195  ;
1196   
1197  * ---------------------------------------------------------------------------- *
1198  ***** Quotas for renewables and biomass *****
1199  * ---------------------------------------------------------------------------- *
1200   
1201  con5a_minRES..
1202  sum( h , G_L('bio',h) + sum(nondis , G_RES(nondis,h))
1203   
               + sum( (sto) , STO_OUT_PRO2PRO(sto,h) + sum( (res) , G_MARKET_PRO2M(res,h) + G_RES_PRO(res,h))
      $ontext
1208  )
1209          - phi_min_res * phi_min_res_exog * sum( h ,
1210           sum( (dis) , G_L(dis,h)) + sum( (nondis) , G_RES(nondis,h))
1211   
               + sum( (res) , phi_res(res,h) * N_RES_PRO(res) - CU_PRO(res,h))
      $ontext
1216           )  =G= 0
1217  ;
1218   
1219  con5b_max_energy(tech)$dis_bio(tech)..
1220           m_e(tech) -  sum( h , G_L(tech,h) ) =G= 0
1221  ;
1222   
1223   
1224  * ---------------------------------------------------------------------------- *
1225  ***** Maximum installation constraints *****
1226  * ---------------------------------------------------------------------------- *
1227   
1228  con8a_max_I_power(tech)..
1229         m_p(tech) - N_TECH(tech)     =G= 0
1230  ;
1231   
1232  con8b_max_I_sto_e(sto)..
1233         m_sto_e(sto) - N_STO_E(sto)  =G= 0
1234  ;
1235   
1236  con8c_max_I_sto_p(sto)..
1237         m_sto_p(sto) -  N_STO_P(sto) =G= 0
1238  ;
1239   
1240   
1241   
1242  con8f_max_pro_res(res)..
1243         m_res_pro(res) -  N_RES_PRO(res)     =G= 0
1244  ;
1245   
1246  con8g_max_pro_sto_e(sto)..
1247         m_sto_pro_e(sto) -  N_STO_E_PRO(sto) =G= 0
1248  ;
1249   
1250  con8h_max_sto_pro_p(sto)..
1251          m_sto_pro_p(sto) -  N_STO_P_PRO(sto) =G= 0
1252  ;
1253   
1254  * ---------------------------------------------------------------------------- *
1255  ***** Prosumage constraints *****
1256  * ---------------------------------------------------------------------------- *
1257   
1258  con11a_pro_distrib(res,h)..
1259           phi_res(res,h) * N_RES_PRO(res)
1260           =E=
1261           CU_PRO(res,h) + G_MARKET_PRO2M(res,h) + G_RES_PRO(res,h) + sum( sto , STO_IN_PRO2PRO(res,sto,h) )
1262  ;
1263   
1264  con11b_pro_balance(h)..
1265           phi_pro_load * d(h)
1266           =E=
1267           sum( res , G_RES_PRO(res,h)) + sum( sto , STO_OUT_PRO2PRO(sto,h) ) + G_MARKET_M2PRO(h)
1268  ;
1269   
1270  con11c_pro_selfcon..
1271           sum( (h,res) , G_RES_PRO(res,h) ) + sum( (h,sto) , STO_OUT_PRO2PRO(sto,h) )
1272           =G=
1273           phi_pro_self * sum( h , phi_pro_load * d(h))
1274  ;
1275   
1276  con11d_pro_stolev_PRO2PRO(sto,h)$(ord(h) > 1 )..
1277           STO_L_PRO2PRO(sto,h) =E= STO_L_PRO2PRO(sto,h-1) + sum( res , STO_IN_PRO2PRO(res,sto,h))*(1+eta_sto(sto))/2 - STO_OUT_PRO2PRO(sto,h)/(1+eta_sto(sto))*2
1278  ;
1279   
1280   
1281  con11h_1_pro_stolev_start_PRO2PRO(sto,h)$( ord(h) = 1)..
1282          STO_L_PRO2PRO(sto,h) =E=   phi_sto_pro_ini(sto) * N_STO_E_PRO(sto) + sum( res , STO_IN_PRO2PRO(res,sto,h))*(1+eta_sto(sto))/2 - STO_OUT_PRO2PRO(sto,h)/(1+eta_sto(sto))*2
1283  ;
1284   
1285   
1286  con11j_pro_stolev_max(sto,h)..
1287         N_STO_E_PRO(sto) - STO_L_PRO2PRO(sto,h) =G= 0
1288  ;
1289   
1290  con11k_pro_maxin_sto(sto,h)..
1291          N_STO_P_PRO(sto) - sum( res , STO_IN_PRO2PRO(res,sto,h) )
1292          =G= 0
1293  ;
1294   
1295  con11l_pro_maxout_sto(sto,h)..
1296          N_STO_P_PRO(sto) - STO_OUT_PRO2PRO(sto,h)
1297          =G= 0
1298  ;
1299   
1300  con11o_pro_ending(sto,h)$( ord(h) = card(h))..
1301           STO_L_PRO2PRO(sto,h) =E= phi_sto_pro_ini(sto) * N_STO_E_PRO(sto)
1302  ;
1303   
1304  * ---------------------------------------------------------------------------- *
1305  ***** FOC conditions *****
1306  * ---------------------------------------------------------------------------- *
1307   
1308  KKTG_L(tech,h)$dis(tech)..
1309   
1310      + c_m(tech)
1311      - lambda_enerbal(h)
          + lambda_convgen(tech,h)
      $ontext
1316      + mu_conv_cap(tech,h)
          + mu_bio_cap(tech)$dis_bio(tech)
      $ontext
         - (lambda_convgen(tech,h+1))$(ord(h) > 1)
      $ontext
1325      =G= 0
1326   
1327  ;
1328   
1329  KKTG_UP(dis,h)..
1330   
1331       - lambda_convgen(dis,h)
1332       + (c_up(dis))$(ord(h)> 1)
1333     =G= 0
1334   
1335  ;
1336   
1337  KKTG_DO(dis,h)..
1338   
1339       + c_do(dis)
1340       + (lambda_convgen(dis,h))$(ord(h) > 1)
1341       =G= 0
1342   
1343  ;
1344   
1345  KKTG_RES(nondis,h)..
1346   
1347       - lambda_enerbal(h) + lambda_resgen(nondis,h)
1348       =G= 0
1349  ;
1350   
1351  KKTCU(nondis,h)..
1352   
1353       c_cu(nondis) + lambda_resgen(nondis,h) =G= 0
1354   
1355  ;
1356   
1357  KKTSTO_IN(sto,h)..
1358   
1359      c_m_sto(sto)  + lambda_enerbal(h) -  lambda_stolev(sto,h)*(1+eta_sto(sto))/2
1360      + mu_stoin_cap(sto,h) =G= 0
1361  ;
1362   
1363  KKTSTO_OUT(sto,h)..
1364   
1365       c_m_sto(sto)  -  lambda_enerbal(h) +  lambda_stolev(sto,h)/(1+eta_sto(sto))*2
1366       +  mu_stout_cap(sto,h)
1367        =G= 0
1368  ;
1369   
1370  KKTSTO_L(sto,h)..
1371   
1372    + lambda_stolev(sto,h)
1373    +  mu_stolev_cap(sto,h)
1374    -  (lambda_stolev(sto,h+1))$(ord(h) > 1 )
1375   
1376    =G= 0
1377   
1378  ;
1379   
      KKTN_TECH_NONDIS(nondis)..
       
          c_i(nondis) +  c_fix(nondis)
          - sum( h,  lambda_resgen(nondis,h)*phi_res(nondis,h)) + mu_nondis_max_i(nondis)
          =G= 0
      ;
       
      KKTN_TECH_DIS(dis)..
       
           c_i(dis) +  c_fix(dis) - sum( h,  lambda_convgen(dis,h)) +  mu_dis_max_i(dis)
           =G= 0
       
      ;
1395   
1396  KKTN_TECH(tech)..
1397   
1398            +  c_i(tech)
1399            +  c_fix(tech)
                +  mu_tech_max_i(tech)       
      $ontext
1404            - sum( h,   mu_conv_cap(tech,h))$dis(tech)
1405            - sum( h,  lambda_resgen(tech,h)*phi_res(tech,h))$nondis(tech)
1406       =G= 0
1407   
1408  ;
1409   
1410   
1411   
1412  KKTN_STO_E(sto)..
1413   
1414        +  c_fix_sto(sto)/2 +  c_i_sto_e(sto)
1415        -  sum( h,   mu_stolev_cap(sto,h))
            +  mu_stoe_max_i(sto)
      $ontext
1420        =G= 0
1421  ;
1422   
1423  KKTN_STO_P(sto)..
1424   
1425   
1426       c_fix_sto(sto)/2 + c_i_sto_p(sto)
1427       - sum( h, (mu_stoin_cap(sto,h) + mu_stout_cap(sto,h)))
           + mu_stop_max_i(sto)
      $ontext
1432       =G= 0
1433   
1434  ;
1435   
1436   
1437  ********************************************************************************
1438  ***** Fix unmatched variables of first period *****
1439  ********************************************************************************
1440   
1441  G_DO.fx(dis,'h1') = 0;
1442   
1443  * Default for reporting
1444  G_DO.l(dis,h)   = 0;
1445  G_L.l(dis,h)    = 0;
1446  G_UP.l(dis,h)   = 0;
1447  G_RES.l(tech,h) = 0;
1448  CU.l(tech,h)    = 0;
1449   
1450  STO_IN.l(sto,h)  = 0;
1451  STO_OUT.l(sto,h) = 0;
1452  STO_L.l(sto,h)   = 0;
1453   
1454  N_TECH.l(tech)   = 0;
1455  N_STO_E.l(sto)   = 0;
1456  N_STO_P.l(sto)   = 0;
1457   
1458   
1459  ********************************************************************************
1460  ***** MODEL *****
1461  ********************************************************************************
1462   
1463  model DIETER /
1464  obj
1465   
1466  con1a_bal
1467   
      con2_loadlevel
      $ontext
1472   
1473  con3a_maxprod_dispatchable
1474  con3e_maxprod_res
1475   
1476  con4_stolev
1477  con4c_stolev_max
1478  con4d_maxin_sto
1479  con4e_maxout_sto
1480   
1481  con5a_minRES
      con5b_max_energy
      $ontext
1486   
      con8a_max_I_power
      con8b_max_I_sto_e
      con8c_max_I_sto_p
      $ontext
1493   
      con8f_max_pro_res
      con8g_max_pro_sto_e
      con8h_max_sto_pro_p
      con11a_pro_distrib
      con11b_pro_balance
      con11c_pro_selfcon
      con11d_pro_stolev_PRO2PRO
      con11h_1_pro_stolev_start_PRO2PRO
      con11j_pro_stolev_max
      con11k_pro_maxin_sto
      con11l_pro_maxout_sto
      con11o_pro_ending
      $ontext
1509   
1510  /;
1511   
1512  model DIETER_MCP /
1513   
1514  con1a_bal.lambda_enerbal
1515   
      con2_loadlevel.lambda_convgen
      $ontext
1520   
1521  con3a_maxprod_dispatchable.mu_conv_cap
1522  con3e_maxprod_res.lambda_resgen
1523   
1524  con4_stolev.lambda_stolev
1525  con4c_stolev_max.mu_stolev_cap
1526  con4d_maxin_sto.mu_stoin_cap
1527  con4e_maxout_sto.mu_stout_cap
1528   
      con5b_max_energy.mu_bio_cap
      $ontext
1533   
      con8a_max_I_power.mu_tech_max_i
      con8b_max_I_sto_e.mu_stoe_max_i
      con8c_max_I_sto_p.mu_stop_max_i
      $ontext
1540   
1541  KKTG_L.G_L
1542   
      KKTG_UP.G_UP
      KKTG_DO.G_DO
      $ontext
1548   
1549  KKTG_RES.G_RES
1550  KKTCU.CU
1551  KKTSTO_IN.STO_IN
1552  KKTSTO_OUT.STO_OUT
1553  KKTSTO_L.STO_L
1554   
      KKTN_TECH.N_TECH
      KKTN_STO_E.N_STO_E
      KKTN_STO_P.N_STO_P
      $ontext
1561  / ;
1562   
1563  ********************************************************************************
1564  ***** Options, fixings, report preparation *****
1565  ********************************************************************************
1566   
1567  * Solver options
1573   
      $onecho > cplex.opt
      lpmethod 4
      threads 4
      epgap 1e-3
      barcrossalg -1
      barepcomp 1e-8
      $offecho
      $ontext
1584   
1585  dieter.OptFile = 1;
1586  dieter.holdFixed = 1 ;
1587   
1588   
1589  ********************************************************************************
1590  ***** Solve *****
1591  ********************************************************************************
1592   
1593  * Preparation of GUSS tool for scenario analysis
1594  phi_min_res = eps ;
1595  phi_pro_self = eps ;
1596   
1598   
1599  Set
1600  modelstats       model stats collection                  /modelstat, solvestat, resusd/
1601  superscen        Scenarios                               /scen1*scen1000/
1602  map(superscen,loop_res_share,loop_prosumage)    /#superscen:(#loop_res_share.#loop_prosumage)/
1603  ;
1604   
1605  set
1606  scen(superscen);
1607  scen(superscen) = yes$( sum((loop_res_share,loop_prosumage) , map(superscen,loop_res_share,loop_prosumage)) )    ;
1608   
1609  Parameters
1610  gussoptions                              /Logoption 2, Optfile 1, Skipbasecase 1/
1611  modstats(superscen, modelstats)
1612  min_res
1613  pro_selfcon
1614  ;
1615   
1616  min_res(scen)     = sum( (loop_res_share,loop_prosumage)$map(scen,loop_res_share,loop_prosumage) , loop_res_share.val/100 ) ;
1617  pro_selfcon(scen) = sum( (loop_res_share,loop_prosumage)$map(scen,loop_res_share,loop_prosumage) , loop_prosumage.val/100 ) ;
1618   
1619  Parameters
1620  * Equations
1621  marginal_con5a(superscen)
1622  marginal_con1a(superscen,*)
1623  marginal_con9a(superscen,*,*,*)
1624  marginal_con9b(superscen,*,*,*)
1625   
1626  * Basic
1627  lev_Z(superscen)
1628  lev_G_L(superscen,tech,h)
1629  lev_G_UP(superscen,tech,h)
1630  lev_G_DO(superscen,tech,h)
1631  lev_G_RES(superscen,tech,h)
1632  lev_CU(superscen,tech,h)
1633  lev_STO_IN(superscen,sto,h)
1634  lev_STO_OUT(superscen,sto,h)
1635  lev_STO_L(superscen,sto,h)
1636  lev_N_TECH(superscen,tech)
1637  lev_N_STO_E(superscen,sto)
1638  lev_N_STO_P(superscen,sto)
1639   
1640   
1641  * Prosumage
1642  lev_CU_PRO(superscen,tech,h)
1643  lev_G_MARKET_PRO2M(superscen,tech,h)
1644  lev_G_MARKET_M2PRO(superscen,h)
1645  lev_G_RES_PRO(superscen,tech,h)
1646  lev_STO_IN_PRO2PRO(superscen,tech,sto,h)
1647  lev_STO_IN_PRO2M(superscen,tech,sto,h)
1648  lev_STO_IN_M2PRO(superscen,sto,h)
1649  lev_STO_IN_M2M(superscen,sto,h)
1650  lev_STO_OUT_PRO2PRO(superscen,sto,h)
1651  lev_STO_OUT_PRO2M(superscen,sto,h)
1652  lev_STO_OUT_M2PRO(superscen,sto,h)
1653  lev_STO_OUT_M2M(superscen,sto,h)
1654  lev_STO_L_PRO2PRO(superscen,sto,h)
1655  lev_STO_L_PRO2M(superscen,sto,h)
1656  lev_STO_L_M2PRO(superscen,sto,h)
1657  lev_STO_L_M2M(superscen,sto,h)
1658  lev_N_STO_E_PRO(superscen,sto)
1659  lev_N_STO_P_PRO(superscen,sto)
1660  lev_STO_L_PRO(superscen,sto,h)
1661  lev_N_RES_PRO(superscen,tech)
1662  ;
1663   
1664   
1665  * Inclusion of scenario and fixing
INCLUDE    C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\fix.gms
1667   
1668  ********************************************************************************
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DIETER).
      Version 1.3.0, October 2017.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses/mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
1678  ********************************************************************************
1679   
1680   
1681   
1682  ********************************************************************************
1683  **** Run of river  *************************************************************
1684  ********************************************************************************
1685   
1686  * If $setglobal ror_parameter "*": choose appropriate value for N_CON.fx('ror') (but no reserve provision):
1687   
1688  *$ontext
1689  N_TECH.fx('ror') = 5857.47 ;
1690  G_RES.fx('ror',h) = N_TECH.l('ror') * phi_res('ror',h) ;
1693   
1694  * Fix everything to zero in case no ROR option is selected:
1695  *N_TECH.fx('ror') = 0 ;
1696  *G_RES.fx('ror',h) = 0 ;
1697  *%ror_parameter%%ror_variable%RP_NONDIS.fx('ror',h) = 0 ;
1698   
1699   
1700  ********************************************************************************
1701  **** No storage and DSM in first period  ***************************************
1702  ********************************************************************************
1703   
1704  ** No storage inflow in first period **
1705  STO_IN.fx(sto,h)$(ord(h) = 1) = 0;
1706   
1707   
1708   
1709  ********************************************************************************
1710  **** No primary reserves by heating devices  ***********************************
1711  ********************************************************************************
1712   
1713   
1714  ********************************************************************************
1715  **** Fixing to reduce model size  **********************************************
1716  ********************************************************************************
1717   
1718  *F.fx(l,h)$(m_ntc(l) = 0) = 0 ;
1719  *NTC.fx(l)$(m_ntc(l) = 0) = 0 ;
1720   
1721  G_L.fx(tech,h)$(m_p(tech) = 0) = 0 ;
1722  G_UP.fx(tech,h)$(m_p(tech) = 0) = 0 ;
1723  G_DO.fx(tech,h)$(m_p(tech) = 0) = 0 ;
1724  N_TECH.fx(tech)$(m_p(tech) = 0) = 0 ;
1725  G_RES.fx(tech,h)$(m_p(tech) = 0) = 0 ;
1726  CU.fx(tech,h)$(m_p(tech) = 0) = 0 ;
1727   
1728  N_STO_P.fx(sto)$(m_sto_p(sto) = 0) = 0 ;
1729  N_STO_E.fx(sto)$(m_sto_e(sto) = 0) = 0 ;
1730  STO_IN.fx(sto,h)$(m_sto_p(sto) = 0) = 0 ;
1731  STO_OUT.fx(sto,h)$(m_sto_p(sto) = 0) = 0 ;
1732  STO_L.fx(sto,h)$(m_sto_p(sto) = 0) = 0 ;
1733   
1734   
1735  Variables
1736  STO_IN_PRO2M(tech,sto,h)
1737  STO_IN_M2PRO(sto,h)
1738  STO_IN_M2M(sto,h)
1739  STO_OUT_PRO2M(sto,h)
1740  STO_OUT_M2PRO(sto,h)
1741  STO_OUT_M2M(sto,h)
1742  STO_L_PRO(sto,h)
1743  STO_L_PRO2M(sto,h)
1744  STO_L_M2PRO(sto,h)
1745  STO_L_M2M(sto,h)
1746  ;
1747   
      CU_PRO.fx(res,h)$(m_res_pro(res) = 0) = 0 ;
      G_MARKET_PRO2M.fx(res,h)$( m_res_pro(res) = 0) = 0 ;
      *G_MARKET_M2PRO.fx(h)$(feat_node('prosumage',n) = 0) = 0 ;
      G_RES_PRO.fx(res,h)$( m_res_pro(res) = 0) = 0 ;
      STO_IN_PRO2PRO.fx(res,sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_IN_PRO2M.fx(res,sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_IN_M2PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_IN_M2M.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_OUT_PRO2PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_OUT_PRO2M.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_OUT_M2PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_OUT_M2M.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_L_PRO2PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_L_PRO2M.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_L_M2PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_L_M2M.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      N_STO_E_PRO.fx(sto)$( m_sto_pro_p(sto) = 0) = 0 ;
      N_STO_P_PRO.fx(sto)$( m_sto_pro_p(sto) = 0) = 0 ;
      STO_L_PRO.fx(sto,h)$( m_sto_pro_p(sto) = 0) = 0 ;
      N_RES_PRO.fx(res)$( m_res_pro(res) = 0) = 0 ;
      $ontext
1771   
1772  * Deactivated market storage links
1773   
1774  STO_IN_PRO2M.fx(tech,sto,h) = 0 ;
1775  STO_IN_M2PRO.fx(sto,h)     = 0 ;
1776  STO_IN_M2M.fx(sto,h)       = 0 ;
1777  STO_OUT_PRO2M.fx(sto,h)    = 0 ;
1778  STO_OUT_M2PRO.fx(sto,h)    = 0 ;
1779  STO_OUT_M2M.fx(sto,h)      = 0 ;
1780  STO_L_PRO.fx(sto,h)        = 0 ;
1781  STO_L_PRO2M.fx(sto,h)      = 0 ;
1782  STO_L_M2PRO.fx(sto,h)      = 0 ;
1783  STO_L_M2M.fx(sto,h)        = 0 ;
1784   
1785  ********************************************************************************
1786  **** DEFAULT LEVELS FOR REPORT PARAMETERS  *************************************
1787  ********************************************************************************
1788   
1789  * Default level zero for report parameters
1790  lev_Z(scen) = 0 ;
1791  lev_G_L(scen,tech,h) = 0 ;
1792  lev_G_UP(scen,tech,h) = 0 ;
1793  lev_G_DO(scen,tech,h) = 0 ;
1794  lev_G_RES(scen,tech,h) = 0 ;
1795  lev_CU(scen,tech,h) = 0 ;
1796  lev_STO_IN(scen,sto,h) = 0 ;
1797  lev_STO_OUT(scen,sto,h) = 0 ;
1798  lev_STO_L(scen,sto,h) = 0 ;
1799  lev_N_TECH(scen,tech) = 0 ;
1800  lev_N_STO_E(scen,sto) = 0 ;
1801  lev_N_STO_P(scen,sto) = 0 ;
1802  marginal_con1a(scen,h) = 0 ;
1803  marginal_con5a(superscen) = 0 ;
1804   
1805  * Prosumage
1806  lev_CU_PRO(scen,tech,h) = 0 ;
1807  lev_G_MARKET_PRO2M(scen,tech,h) = 0  ;
1808  lev_G_MARKET_M2PRO(scen,h) = 0  ;
1809  lev_G_RES_PRO(scen,tech,h) = 0  ;
1810  lev_STO_IN_PRO2PRO(scen,tech,sto,h) = 0  ;
1811  lev_STO_IN_PRO2M(scen,tech,sto,h) = 0  ;
1812  lev_STO_IN_M2PRO(scen,sto,h) = 0   ;
1813  lev_STO_IN_M2M(scen,sto,h) = 0  ;
1814  lev_STO_OUT_PRO2PRO(scen,sto,h) = 0  ;
1815  lev_STO_OUT_PRO2M(scen,sto,h) = 0  ;
1816  lev_STO_OUT_M2PRO(scen,sto,h) = 0  ;
1817  lev_STO_OUT_M2M(scen,sto,h) = 0  ;
1818  lev_STO_L_PRO2PRO(scen,sto,h) = 0  ;
1819  lev_STO_L_PRO2M(scen,sto,h) = 0  ;
1820  lev_STO_L_M2PRO(scen,sto,h) = 0  ;
1821  lev_STO_L_M2M(scen,sto,h) = 0  ;
1822  lev_N_STO_E_PRO(scen,sto) = 0  ;
1823  lev_N_STO_P_PRO(scen,sto) = 0  ;
1824  lev_STO_L_PRO(scen,sto,h) = 0  ;
1825  lev_N_RES_PRO(scen,tech) = 0  ;
1826   
1827   
1828  * Fixing of report parameters for run-of-river
1829  *$ontext
1830  lev_N_TECH(scen,'ror') = 5857.47 ;
1831  lev_G_RES(scen,'ror',h) = lev_N_TECH(scen,'ror') * phi_res('ror',h) ;
      %ror_parameter%%ror_variable%lev_N_TECH(scen'ror') = 0 ;
      %ror_parameter%%ror_variable%lev_G_RES(scen'ror',h) = 0 ;
      %reserves%$ontext
      *%ror_parameter%%ror_variable%lev_RP_CON(scenreserves,'ror',h) = 0 ;
      $ontext
1841   
1842   
1843   
1844   
1845   
1846   
INCLUDE    C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\scenario.gms
1848   
1849  ********************************************************************************
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DIETER).
      Version 1.3.0, October 2017.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses/mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
1859  ********************************************************************************
1860   
1861   
1862   
1863   
1864  *****************************************
1865  **** Scenario file                   ****
1866  ****                                 ****
1867  *****************************************
1868   
1869  Parameter
1870  m_exog_p(tech)
1871  m_exog_sto_e(sto)
1872  m_exog_sto_p(sto)
1873   
1874  ;
1875   
1876  m_exog_p(tech)    = technology_data(tech,'fixed_capacities') ;
1877  m_exog_sto_e(sto) = storage_data(sto,'fixed_capacities_energy');
1878  m_exog_sto_p(sto) = storage_data(sto,'fixed_capacities_power');
1879   
1880   
1881  *** Dispatch model
1882  *$ontext
1883  N_TECH.fx(tech)  = m_exog_p(tech) + 0.1 ;
1884  N_STO_P.fx(sto)  = m_exog_sto_p(sto) ;
1885  N_STO_E.fx(sto)  = m_exog_sto_e(sto) ;
1886   
1887  N_TECH.fx('nuc')     = no  ;
1888  N_STO_E.fx('sto1')   = no ;
1889  N_STO_E.fx('sto2')   = no ;
1890  N_STO_E.fx('sto3')   = no ;
1891  N_STO_E.fx('sto4')   = no ;
1892  N_STO_E.fx('sto6')   = no ;
1893  N_STO_E.fx('sto7')   = no ;
1894  N_STO_P.fx('sto1')   = no ;
1895  N_STO_P.fx('sto2')   = no ;
1896  N_STO_P.fx('sto3')   = no ;
1897  N_STO_P.fx('sto4')   = no ;
1898  N_STO_P.fx('sto6')   = no ;
1899  N_STO_P.fx('sto7')   = no ;
1900   
1903   
1904  *** Investment model
      N_TECH.lo(tech)        = 0 ;
      N_TECH.lo('wind_on')   = m_exog_p('wind_on') ;
      N_TECH.lo('wind_off')  = m_exog_p('wind_off') ;
      N_TECH.lo('pv')        = m_exog_p('pv') ;
      N_STO_P.lo(sto)        = m_exog_sto_p(sto) ;
      N_STO_E.lo(sto)        = m_exog_sto_e(sto) ;
      N_TECH.up(tech)        = m_exog_p(tech) + 0.1 ;
      N_TECH.up('wind_on')   = inf ;
      N_TECH.up('wind_off')  = inf ;
      N_TECH.up('pv')        = inf ;
      N_STO_P.up(sto)        = m_exog_sto_p(sto) + 0.1 ;
      N_STO_E.up(sto)        = m_exog_sto_e(sto) + 0.1 ;
      N_STO_P.up('sto1')     = inf ;
      N_STO_P.up('sto5')     = inf ;
      N_STO_P.up('sto7')     = inf ;
      N_STO_E.up('sto1')     = inf ;
      N_STO_E.up('sto5')     = inf ;
      N_STO_E.up('sto7')     = inf ;
      $ontext
1926   
1927   
1928   
1929  * Definition of dictionary set for GUSS tool
1930   
1931  Set dict(*,*,*) /
1932  scen             .scenario       .''
1933  gussoptions      .opt            .modstats
1934   
1935  phi_min_res      .param          .min_res
1936   
      phi_pro_self     .param          .pro_selfcon
      $ontext
1941   
1942   
1943  con5a_minRES     .marginal       .marginal_con5a
1944  con1a_bal        .marginal       .marginal_con1a
1945   
1946   
      Z                .level          .lev_Z
      $ontext
1951  G_L              .level          .lev_G_L
1952  G_UP             .level          .lev_G_UP
1953  G_DO             .level          .lev_G_DO
1954  G_RES            .level          .lev_G_RES
1955  CU               .level          .lev_CU
1956  STO_IN           .level          .lev_STO_IN
1957  STO_OUT          .level          .lev_STO_OUT
1958  STO_L            .level          .lev_STO_L
1959  N_TECH           .level          .lev_N_TECH
1960  N_STO_E          .level          .lev_N_STO_E
1961  N_STO_P          .level          .lev_N_STO_P
1962   
1963   
      CU_PRO           .level          .lev_CU_PRO
      G_MARKET_PRO2M   .level          .lev_G_MARKET_PRO2M
      G_MARKET_M2PRO   .level          .lev_G_MARKET_M2PRO
      G_RES_PRO        .level          .lev_G_RES_PRO
      STO_IN_PRO2PRO   .level          .lev_STO_IN_PRO2PRO
      STO_OUT_PRO2PRO  .level          .lev_STO_OUT_PRO2PRO
      STO_L_PRO2PRO    .level          .lev_STO_L_PRO2PRO
      N_STO_E_PRO      .level          .lev_N_STO_E_PRO
      N_STO_P_PRO      .level          .lev_N_STO_P_PRO
      N_RES_PRO        .level          .lev_N_RES_PRO
      $ontext
1977  /
1978  ;
1979   
1980   
1981   
      solve  DIETER using lp min Z scenario dict;
       
       
       
      * Reporting
      $include report.gms
       
       
      execute_unload "results", report, report_tech, report_node,
      *report_line,
      report_tech_hours, report_hours, report_cost
      %prosumage%$ontext
      , report_prosumage, report_prosumage_tech, report_prosumage_tech_hours, report_market, report_market_tech, report_market_tech_hours
      $ontext
1998  ;
1999   
2000   
      $include report_to_excel.gms
      $ontext
2005   
2006   
2009   
2010  *$ontext
2011  solve   DIETER_MCP using mcp ;
2012  *scenario dict;
2013   
2014   
2015  Parameters
2016  Z_MCP
2017  ;
2018   
2019  Z_MCP =            sum( (h,dis) , c_m(dis)*G_L.l(dis,h) )
2020                   + sum( (h,dis)$(ord(h)>1) , c_up(dis)*G_UP.l(dis,h) )
2021                   + sum( (h,dis) , c_do(dis)*G_DO.l(dis,h) )
2022                   + sum( (h,nondis) , c_cu(nondis)*CU.l(nondis,h) )
2023                   + sum( (h,sto) , c_m_sto(sto) * ( STO_OUT.l(sto,h) + STO_IN.l(sto,h) ) )
2024                   + sum( tech , c_i(tech)*N_TECH.l(tech) )
2025                   + sum( tech , c_fix(tech)*N_TECH.l(tech) )
2026                   + sum( sto , c_i_sto_e(sto)*N_STO_E.l(sto) )
2027                   + sum( sto , c_fix_sto(sto)/2*(N_STO_P.l(sto)+ N_STO_E.l(sto)) )
2028                   + sum( sto , c_i_sto_p(sto)*N_STO_P.l(sto) )
2029  ;
2030   
2031   
2032  Display
2033  Z_MCP,
2034  N_TECH.l,
2035  N_STO_E.l,
2036  N_STO_P.l,
2037  G_L.l,
2038  G_UP.l,
2039  G_DO.l,
2040  G_RES.l,
2041  CU.l,
2042  STO_IN.l,
2043  STO_OUT.l,
2044  STO_L.l
2045  lambda_enerbal.m,
2046  lambda_enerbal.l,
2047  *lambda_resgen.m,
2048  *lambda_convgen.m,
2049  lambda_stolev.m
2050  ;
2051   
2054   
2055  * ---------------------------------------------------------------------------- *
2056  * ---------------------------------------------------------------------------- *
2057  * ---------------------------------------------------------------------------- *
GAMS 25.1.2  r67455 Released Aug  1, 2018 WEX-WEI x86 64bit/MS Windows - 11/30/18 10:48:27 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\DIETER.gms
     2      136 INCLUDE        1     136  .C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\dataload.gms
     3      540 CALL           2     404  .gdxxrw data_input.xlsx @temp.tmp o=Data_input maxdupeerrors=100
     4      542 GDXIN          2     406  .C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\Data_input.gdx
     5      590 CALL           2     454  .gdxxrw time_series.xlsx @temp2.tmp o=time_series
     6      591 GDXIN          2     455  .C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\time_series.gdx
     7      931 INCLUDE        1     171  .C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\model.gms
     8     1666 INCLUDE        1     276  .C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\fix.gms
     9     1847 INCLUDE        1     277  .C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\scenario.gms


COMPILATION TIME     =        5.085 SECONDS      3 MB  25.1.2 r67455 WEX-WEI
GAMS 25.1.2  r67455 Released Aug  1, 2018 WEX-WEI x86 64bit/MS Windows - 11/30/18 10:48:27 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Model Statistics    SOLVE DIETER_MCP Using MCP From line 2011


MODEL STATISTICS

BLOCKS OF EQUATIONS          13     SINGLE EQUATIONS        7,722
BLOCKS OF VARIABLES          16     SINGLE VARIABLES        7,748
NON ZERO ELEMENTS        21,201     NON LINEAR N-Z              0
DERIVATIVE POOL              20     CONSTANT POOL              16
CODE LENGTH                   0


GENERATION TIME      =        0.032 SECONDS      7 MB  25.1.2 r67455 WEX-WEI


EXECUTION TIME       =        0.032 SECONDS      7 MB  25.1.2 r67455 WEX-WEI
GAMS 25.1.2  r67455 Released Aug  1, 2018 WEX-WEI x86 64bit/MS Windows - 11/30/18 10:48:27 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE DIETER_MCP Using MCP From line 2011


               S O L V E      S U M M A R Y

     MODEL   DIETER_MCP          
     TYPE    MCP                 
     SOLVER  PATH                FROM LINE  2011

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      1 Optimal                   

 RESOURCE USAGE, LIMIT          0.140  10000000.000
 ITERATION COUNT, LIMIT      2706    2000000000
 EVALUATION ERRORS              0             0
6333 row/cols, 10071 non-zeros, 0.03% dense.

Path 4.7.04 (Tue Jul 31 15:20:37 2018)
Written by Todd Munson, Steven Dirkse, and Michael Ferris

INITIAL POINT STATISTICS
Maximum of X. . . . . . . . . .  0.0000e+00 var: (lambda_enerbal(h1))
Maximum of F. . . . . . . . . .  6.2691e+04 eqn: (con1a_bal(h91))
Maximum of Grad F . . . . . . .  1.1111e+00 eqn: (KKTSTO_OUT(Sto5,h2))
                                            var: (lambda_stolev(Sto5,h2))

INITIAL JACOBIAN NORM STATISTICS
Maximum Row Norm. . . . . . . .  1.0000e+01 eqn: (con1a_bal(h2))
Minimum Row Norm. . . . . . . .  1.0000e+00 eqn: (KKTG_L(lig,h1))
Maximum Column Norm . . . . . .  1.0000e+01 var: (lambda_enerbal(h2))
Minimum Column Norm . . . . . .  1.0000e+00 var: (G_L(lig,h1))

FINAL STATISTICS
Inf-Norm of Complementarity . .  3.2462e-06 eqn: (KKTSTO_L(Sto5,h70))
Inf-Norm of Normal Map. . . . .  1.5044e-10 eqn: (KKTSTO_L(Sto5,h70))
Inf-Norm of Minimum Map . . . .  1.4916e-10 eqn: (KKTSTO_L(Sto5,h70))
Inf-Norm of Fischer Function. .  2.3972e-10 eqn: (KKTSTO_OUT(Sto5,h68))
Inf-Norm of Grad Fischer Fcn. .  5.3887e-10 eqn: (con4_stolev(Sto5,h68))
Two-Norm of Grad Fischer Fcn. .  1.5068e-09

FINAL POINT STATISTICS
Maximum of X. . . . . . . . . .  4.5500e+04 var: (STO_L(Sto5,h77))
Maximum of F. . . . . . . . . .  1.2380e+02 eqn: (KKTG_L(oil,h51))
Maximum of Grad F . . . . . . .  1.1111e+00 eqn: (KKTSTO_OUT(Sto5,h2))
                                            var: (lambda_stolev(Sto5,h2))



**** REPORT SUMMARY :        0     NONOPT
                             0 INFEASIBLE
                             0  UNBOUNDED
                           594  REDEFINED (REDEF)
                             0     ERRORS
                           274  PROJECTED
GAMS 25.1.2  r67455 Released Aug  1, 2018 WEX-WEI x86 64bit/MS Windows - 11/30/18 10:48:27 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----   2033 PARAMETER Z_MCP                =     326144123.556  

----   2033 VARIABLE N_TECH.L  Technology tech built [MW]

ror       5857.567,    lig      14928.521,    hc       21846.569,    CCGT     13489.092,    OCGT     13489.092,    oil       1248.213,    other      171.154,    bio       6894.393,    wind_on  55282.581,    wind_off 11931.571,    pv       63959.425


----   2033 VARIABLE N_STO_E.L  Storage technology built - Energy [MWh]

Sto5 45500.000


----   2033 VARIABLE N_STO_P.L  Storage loading and discharging capacity built - Capacity [MW]

Sto5 6500.000


----   2033 VARIABLE G_L.L  Generation level in hour h [MWh]

                    h1               h2               h3               h4               h5               h6               h7               h8               h9              h10              h11              h12              h13              h14

lig           4001.439         2519.016         1020.984          623.341          841.748         2315.073        12826.610        14871.410        14928.521        14928.521        14928.521        14928.521        14928.521        14928.521
hc                                                                                                                                                    2249.220         4928.719         6723.895         8864.310         9828.418        10722.437
bio           6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393

    +              h15              h16              h17              h18              h19              h20              h21              h22              h23              h24              h25              h26              h27              h28

lig          14928.521        14928.521        14928.521        14928.521        14928.521        14928.521        14928.521        14928.521        14928.521        11338.712         7529.426         2701.641
hc           12873.504        16079.904        19344.361        21507.093        20761.062        17585.231        13497.790        10187.339          862.278
bio           6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393

    +              h29              h30              h31              h32              h33              h34              h35              h36              h37              h38              h39              h40              h41              h42

lig                                                0.023            0.025         1515.313         5159.454         6752.534         7746.833         8076.560         7852.944         8204.260         9215.740        10798.539        12344.603
bio           6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393

    +              h43              h44              h45              h46              h47              h48              h49              h50              h51              h52              h53              h54              h55              h56

lig          12446.230        11338.002         8680.467         7308.278
bio           6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         5285.939         3341.165         2206.409         2068.608         2409.034         1884.131         6894.393         6894.393

    +              h57              h58              h59              h60              h61              h62              h63              h64              h65              h66              h67              h68              h69              h70

lig            165.571          278.852          564.263         3863.457         5956.497         7934.212         9413.283        10813.361        12651.201        14841.062        14875.973        13115.512        11054.172        10044.229
bio           6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393

    +              h71              h72              h73              h74              h75              h76              h77              h78              h79              h80              h81              h82              h83              h84

lig                                                                                                                                   790.905        14928.521        14928.521        14928.521        14928.521        14928.521        14928.521
hc                                                                                                                                            4.01942431836E-5         1697.554         5481.342         7079.952         7928.219         9308.463
bio           6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393

    +              h85              h86              h87              h88              h89              h90              h91              h92              h93              h94              h95              h96              h97              h98

lig          14928.521        14928.521        14928.521        14928.521        14928.521        14928.521        14928.521        14928.521        14928.521        14928.521        14718.200        11306.639         8791.463         7313.289
hc           12860.510        14828.349        15513.183        16108.248        17422.810        19407.031        19559.115        18278.840        14419.669        11973.191
bio           6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393         6894.393

    +              h99

lig           6392.775
bio           6894.393


----   2033 VARIABLE G_UP.L  Generation upshift in hour h [MWh]

                      ( ALL            0.000 )


----   2033 VARIABLE G_DO.L  Generation downshift in hour h [MWh]

                      ( ALL            0.000 )


----   2033 VARIABLE G_RES.L  Generation renewables type res in hour h [MWh]

                       h1               h2               h3               h4               h5               h6               h7               h8               h9              h10              h11              h12              h13              h14

ror              2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503
wind_on          8585.385         8474.820         8502.461         8662.780         8557.744         7728.505         7065.114         6291.158         5378.995         4433.663         3322.483         2227.888         1553.441          950.860
wind_off         8269.772         8306.760         8099.150         7310.473         7061.104         5751.017         4831.093         3458.962         2367.224         1611.955         1120.374          633.566          482.035          303.062
pv                                                                                                                                                        223.858         1586.194         4131.779         6178.480         6754.115         6088.937

       +              h15              h16              h17              h18              h19              h20              h21              h22              h23              h24              h25              h26              h27              h28

ror              2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503
wind_on           602.580          536.241          895.578         1741.401         2764.129         4179.363         5080.469         6064.499         6722.362         7418.922         7822.485         8894.967        11050.988        12416.468
wind_off          176.587           23.863            7.159           17.897          342.436          967.650         2219.272         3296.693         4327.581         5274.947         6020.671         7850.974         9121.686         9915.135
pv               4003.860         1381.524           83.147

       +              h29              h30              h31              h32              h33              h34              h35              h36              h37              h38              h39              h40              h41              h42

ror              2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503
wind_on         14373.471        15932.440        17065.733        17867.330        18563.891        19575.562        20360.575        20874.703        20963.155        21062.663        21256.152        21527.037        22151.730        23141.288
wind_off        10110.813        10211.038        10219.390        10175.244        10194.334        10143.028        10071.439        10057.121        10049.962        10016.554        10032.065        10065.473         9986.725         9923.487
pv                                                                                    172.690          972.183         2200.204         3057.261         3351.474         3063.656         1931.575          626.802           44.772

       +              h43              h44              h45              h46              h47              h48              h49              h50              h51              h52              h53              h54              h55              h56

ror              2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503
wind_on         23555.908        23412.173        22848.291        22195.956        21200.870        21621.018        21836.620        21416.472        21444.113        21222.983        21012.909        21051.607        21222.983        20907.872
wind_off         9906.783         9905.590         9922.294         9900.817         9881.727         9890.079         9855.477         9799.399         9744.514         9756.445         9748.093         9712.299         9694.401         9700.367

       +              h57              h58              h59              h60              h61              h62              h63              h64              h65              h66              h67              h68              h69              h70

ror              2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503
wind_on         20305.292        19581.090        18895.586        17491.409        16043.005        15750.007        15794.233        16640.057        17259.222        18469.910        19879.616        20377.159        20493.253        20266.594
wind_off         9723.037         9686.049         9662.186         9622.812         9658.607         9693.208         9399.691         9186.116         9312.591         9425.941         9213.559         9155.094         9201.627         9236.229
pv                108.731         1048.935         2699.088         4298.073         5001.627         4764.977         3082.844         1074.518           76.751

       +              h71              h72              h73              h74              h75              h76              h77              h78              h79              h80              h81              h82              h83              h84

ror              2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503
wind_on         19387.601        19078.019        18619.173        17635.143        16761.679        15910.327        14843.373        14229.736        14351.358        14058.360        13748.778        12858.728        11852.585        10664.010
wind_off         9307.818         9378.215         9425.941         9427.134         9436.679         9440.259         9466.508         9490.371         9553.609         9643.095         9686.049         9658.607         9671.731         9686.049
pv                                                                                                                                                                                          115.127          876.244         2212.996         3274.723

       +              h85              h86              h87              h88              h89              h90              h91              h92              h93              h94              h95              h96              h97              h98

ror              2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503         2964.503
wind_on         10116.712         9574.943         9536.245         9878.997        10271.504        11100.742        11343.986        11017.818        10780.103        10232.806         9818.186         9414.624         9215.606         8922.609
wind_off         9674.118         9684.856         9717.071         9743.321         9701.560         9740.934         9717.071         9746.900         9762.411         9765.991         9758.832         9764.798         9765.991         9736.162
pv               3652.083         3287.514         2123.453          876.244           95.939

       +              h99

ror              2964.503
wind_on          8778.874
wind_off         9762.411


----   2033 VARIABLE CU.L  Renewables curtailment technology res in hour h [MWh]

                       h1               h2               h3               h4               h5               h6               h7               h8               h9              h10              h11              h12              h13              h14

ror                 0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049

       +              h15              h16              h17              h18              h19              h20              h21              h22              h23              h24              h25              h26              h27              h28

ror                 0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049

       +              h29              h30              h31              h32              h33              h34              h35              h36              h37              h38              h39              h40              h41              h42

ror                 0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049

       +              h43              h44              h45              h46              h47              h48              h49              h50              h51              h52              h53              h54              h55              h56

ror                 0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049

       +              h57              h58              h59              h60              h61              h62              h63              h64              h65              h66              h67              h68              h69              h70

ror                 0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049

       +              h71              h72              h73              h74              h75              h76              h77              h78              h79              h80              h81              h82              h83              h84

ror                 0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049

       +              h85              h86              h87              h88              h89              h90              h91              h92              h93              h94              h95              h96              h97              h98

ror                 0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049            0.049

       +              h99

ror                 0.049


----   2033 VARIABLE STO_IN.L  Storage inflow technology sto hour h [MWh]

                  h27              h28              h29              h30              h47              h48              h49              h50              h51              h52              h53              h54              h55              h56

Sto5         1169.092         3066.021         4494.702         5598.896         1835.794         4975.453         6500.000         6500.000         6500.000         6500.000         6500.000         6500.000         3101.567         1446.709

   +              h71              h72              h73              h74              h75              h76              h77

Sto5          393.248         3207.220         4940.101         5504.264         5556.345         4590.572         2388.868


----   2033 VARIABLE STO_OUT.L  Storage outflow technology sto hour h [MWh]

                  h31              h32              h33              h34              h35              h36              h37              h42              h43              h57              h58              h59              h60              h61

Sto5         1264.671         2544.932         3589.589         2039.824          957.301          457.849          130.380          392.534          211.227         1254.186         4164.126         5771.929         5302.015         3928.795

   +              h62              h69              h70              h79              h80              h81              h82              h83              h84              h85              h86              h87              h88              h89

Sto5          968.412 3.76990567020E-5 6.69108307193E-5         1912.329         6500.000         6500.000         6500.000         6500.000         6500.000         3260.586         1452.634          664.579          308.722          143.432

   +              h90              h91              h92              h93              h94

Sto5          433.684          247.456           14.686            7.348            4.544


----   2033 VARIABLE STO_L.L  Storage level technology sto hour h [MWh]

                  h27              h28              h29              h30              h31              h32              h33              h34              h35              h36              h37              h38              h39              h40

Sto5         1052.182         3811.601         7856.833        12895.839        11490.649         8662.947         4674.515         2408.043         1344.376          835.655          690.788          690.788          690.788          690.788

   +              h41              h42              h43              h44              h45              h46              h47              h48              h49              h50              h51              h52              h53              h54

Sto5          690.788          254.640           19.943           19.943           19.943           19.943         1672.158         6150.065        12000.065        17850.065        23700.065        29550.065        35400.065        41250.065

   +              h55              h56              h57              h58              h59              h60              h61              h62              h63              h64              h65              h66              h67              h68

Sto5        44041.476        45343.514        43949.974        39323.166        32909.912        27018.785        22653.457        21577.444        21577.444        21577.444        21577.444        21577.444        21577.444        21577.444

   +              h69              h70              h71              h72              h73              h74              h75              h76              h77              h78              h79              h80              h81              h82

Sto5        21577.444        21577.443        21931.366        24817.864        29263.955        34217.793        39218.504        43350.019        45500.000        45500.000        43375.189        36152.967        28930.745        21708.523

   +              h83              h84              h85              h86              h87              h88              h89              h90              h91              h92              h93

Sto5        14486.301         7264.078         3641.205         2027.167         1288.746          945.722          786.353          304.481           29.530           13.213            5.049


----   2033 VARIABLE lambda_enerbal.M  Dual variable on energy balance (1a)

                      ( ALL            0.000 )


----   2033 VARIABLE lambda_enerbal.L  Dual variable on energy balance (1a)

h1  45.418,    h2  45.418,    h3  45.418,    h4  45.418,    h5  45.418,    h6  45.418,    h7  45.418,    h8  45.418,    h9  49.563,    h10 49.563,    h11 49.563,    h12 49.563,    h13 49.563,    h14 49.563,    h15 49.563,    h16 49.563,    h17 49.563
h18 49.563,    h19 49.563,    h20 49.563,    h21 49.563,    h22 49.563,    h23 49.563,    h24 45.418,    h25 45.418,    h26 45.418,    h27 35.883,    h28 35.883,    h29 35.883,    h30 35.883,    h31 45.418,    h32 45.418,    h33 45.418,    h34 45.418
h35 45.418,    h36 45.418,    h37 45.418,    h38 45.418,    h39 45.418,    h40 45.418,    h41 45.418,    h42 45.418,    h43 45.418,    h44 45.418,    h45 45.418,    h46 45.418,    h47 35.883,    h48 35.883,    h49 20.534,    h50 20.534,    h51 20.534
h52 20.534,    h53 20.534,    h54 20.534,    h55 35.883,    h56 35.883,    h57 45.418,    h58 45.418,    h59 45.418,    h60 45.418,    h61 45.418,    h62 45.418,    h63 45.418,    h64 45.418,    h65 45.418,    h66 45.418,    h67 45.418,    h68 45.418
h69 45.418,    h70 45.418,    h71 35.883,    h72 35.883,    h73 35.883,    h74 35.883,    h75 35.883,    h76 35.883,    h77 35.883,    h78 45.418,    h79 49.563,    h80 49.563,    h81 49.563,    h82 49.563,    h83 49.563,    h84 49.563,    h85 49.563
h86 49.563,    h87 49.563,    h88 49.563,    h89 49.563,    h90 49.563,    h91 49.563,    h92 49.563,    h93 49.563,    h94 49.563,    h95 45.418,    h96 45.418,    h97 45.418,    h98 45.418,    h99 45.418


----   2033 VARIABLE lambda_stolev.M  Dual variable on storage level  (4b)

                      ( ALL            0.000 )



EXECUTION TIME       =        0.000 SECONDS      5 MB  25.1.2 r67455 WEX-WEI


USER: Medium MUD - 10 User License                   S180308:0349AO-GEN
      Deutsches Institut fuer Wirtschaftsforschung DIW, AbteilungDC3975
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\DIETER.gms
Output     C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Dieter_Module\Modified_MCP_WORKS\DIETER.lst
