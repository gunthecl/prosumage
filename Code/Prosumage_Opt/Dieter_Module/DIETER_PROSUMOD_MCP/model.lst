GAMS 25.1.2  r67455 Released Aug  1, 2018 WEX-WEI x86 64bit/MS Windows 01/09/19 12:49:30 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1   
   2  **************************************************************************
      ******
      The Dispatch and Investment Evaluation Tool with Endogenous Renewables (DI
      ETER).
      Version 1.3.0, October 2017.
      Written by Alexander Zerrahn and Wolf-Peter Schill.
      This work is licensed under the MIT License (MIT).
      For more information on this license, visit http://opensource.org/licenses
      /mit-license.php.
      Whenever you use this code, please refer to http://www.diw.de/dieter.
      We are happy to receive feedback under azerrahn@diw.de and wschill@diw.de.
  12  **************************************************************************
      ******
  13   
  14  Variables
  15  Z                  Value objective function [Euro]
  16  ;
  17   
  18  Positive Variables
  19  lambda_enerbal     Dual variable on energy balance (1a)
  20  lambda_resgen      Dual variable on renewable generation (3e)
  21  lambda_convgen     Dual variable on conventional generation level (2a)
  22  lambda_stolev      Dual variable on storage level  (4a-4b)
  23   
  24  lambda_enerbal_pro     Prosumage: Dual variable on prosumage energy balanc
      e (11b)
  25  lambda_resgen_pro      Prosumage: Dual variable on renewable generation (1
      1a)
  26  lambda_stolev_pro      Prosumage: Dual variable on storage level  (11d-11h
      )
  27   
  28  G_L(tech,h)            Generation level in hour h [MWh]
****         $120,120
  29  G_UP(tech,h)           Generation upshift in hour h [MWh]
  30  G_DO(tech,h)           Generation downshift in hour h [MWh]
  31  G_RES(tech,h)          Generation renewables type res in hour h [MWh]
  32  CU(tech,h)             Renewables curtailment technology res in hour h [MW
      h]
  33   
  34  STO_IN(sto,h)          Storage inflow technology sto hour h [MWh]
****           $120
  35  STO_OUT(sto,h)         Storage outflow technology sto hour h [MWh]
  36  STO_L(sto,h)           Storage level technology sto hour h [MWh]
  37   
  38  N_TECH(tech)           Technology tech built [MW]
  39  N_STO_E(sto)           Storage technology built - Energy [MWh]
  40  N_STO_P(sto)           Storage loading and discharging capacity built - Ca
      pacity [MW]
  41   
  42  CU_PRO(tech,h)                 Prosumage: curtailment of renewable generat
      ion in hour h [MWh]
  43  G_MARKET_PRO2M(tech,h)         Prosumage. energy sent to market in hour h 
      [MWh]
  44  G_MARKET_M2PRO(h)              Prosumage: withdrawal of energy from market
       in hour h [MWh]
  45  G_RES_PRO(tech,h)              Prosumage: hourly renewables generation in 
      hour h [MWh]
  46  STO_IN_PRO2PRO(sto,tech,h)     Prosumage: storage loading from generation 
      for discharging to consumption in hour h [MWh]
  47  STO_OUT_PRO2PRO(sto,h)         Prosumage: storage discharging to consumpti
      on from generation in hour h [MWh]
  48  STO_L_PRO2PRO(sto,h)           Prosumage: storage level generation to cons
      umption in hour h [MWh]
  49  N_STO_E_PRO(sto)              Prosumage: installed storage energy [MWh]
  50  N_STO_P_PRO(sto)              Prosumage: installed storage power [MW]
  51  N_RES_PRO(tech)                Prosumage: installed renewables capacities 
      [MW]
  52   
  53   
  54  mu_stoin_cap          Dual variable on storage loading capacity constraint
       (4d)
  55  mu_stout_cap          Dual variable on storage discharging capacity constr
      aint (4e)
  56  mu_stolev_cap         Dual variable on energy capacity constraint (4c)
  57  mu_conv_cap           Dual variable on conventional generation capacity co
      nstraint (3a)
  58  mu_bio_cap            Dual variable on storage bio energy constraint (5b)
  59  mu_dis_max_i          Dual variable on dispatchable installation constrain
      t (8a)
  60  mu_nondis_max_i       Dual variable on nondispatchable installation constr
      aint (8a)
  61  mu_tech_max_i         Dual variable on tech installation constraint (8a)
  62  mu_stop_max_i         Dual variable on storage power installation constrai
      nt  (8c)
  63  mu_stoe_max_i         Dual variable on storage energy installation constra
      int  (8b)
  64  mu_minRES             Dual variable on minimum renewable share constraint 
      (5a)
  65   
  66  mu_stoin_cap_pro          Prosumage: Dual variable on storage loading capa
      city constraint (11k)
  67  mu_stout_cap_pro          Prosumage: Dual variable on storage discharging 
      capacity constraint (11l)
  68  mu_stolev_cap_pro         Prosumage: Dual variable on energy capacity cons
      traint (11j)
  69  mu_tech_max_i_pro         Prosumage: Dual variable on res installation con
      straint (8f)
  70  mu_stop_max_i_pro         Prosumage: Dual variable on storage power instal
      lation constraint  (8g)
  71  mu_stoe_max_i_pro         Prosumage: Dual variable on storage energy insta
      llation constraint  (8h)
  72  mu_self_con_pro           Prosumage: Constraint on miminum self-consumptio
      n level (8c)
  73  ;
  74   
  75  Set
  76  *$onempty
  77  dis_bio(tech)          Subset of dispatchable technology: Bio mass        
      /bio/
****     $361
  78  res_pro(tech)          Prosumage renewable generation technologies        
      /pv/
****    $361
  79  sto_pro(sto)          Storage technologies prosumager                     
      /sto1/
****      $361
  80  sto_sys(sto)           Storage technologies system                        
      /sto5/
****      $361
  81  dis_sys(tech)                                                             
      /lig,hc,CCGT,OCGT,oil,other,bio/
****     $361
  82  nondis_sys(tech)                                                          
      /ror,wind_on,wind_off,pv/
****     $361
  83  ;
  84  **************************************************************************
      ******
  85   
  86  Equations
  87  * Objective
  88  obj                      Objective cost minimization
  89   
  90  * Energy balance
  91  con1a_bal                Energy Balance
  92   
  93  * Load change costs
  94  con2a_loadlevel          Load change costs: Level
  95  con2b_loadlevelstart     Load change costs: Level for first period
  96  con2_loadlevel           Load change costs: Level of all periods (2a+2b)
  97  * Capacity contraints and flexibility constraints
  98  con3a_maxprod_dispatchable       Capacity Constraint conventionals
  99  con3e_maxprod_res                Capacity constraints renewables
 100   
 101  * Storage constraints
 102  con4a_stolev_start        Storage Level Dynamics Initial Condition
 103  con4b_stolev              Storage Level Dynamics
 104  con4_stolev               Storage Level Dynamics all periods(4a + 4b)
 105  con4c_stolev_max          Storage Power Capacity
 106  con4d_maxin_sto           Storage maximum inflow
 107  con4e_maxout_sto          Storage maximum outflow
 108  con4j_ending              End level equal to initial level
 109  con4k_PHS_EtoP            Maximum E-P ratio
 110   
 111  * Minimum restrictions for renewables and biomass
 112  con5a_minRES             Minimum yearly renewables requirement
 113  con5b_max_energy         Maximum yearly biomass energy
 114   
 115  * Maximum installation conditions
 116  con8a_max_I_power                Maximum installable capacity: Conventiona
      ls
 117  con8b_max_I_sto_e                Maximum installable energy: Storage energ
      y in MWh
 118  con8c_max_I_sto_p                Maximum installable capacity: Storage inf
      low-outflow in MW
 119   
 120  con8f_max_pro_res                Maximum installable capacity: prosumage r
      enewables
 121  con8g_max_pro_sto_e              Maximum installable capacity: prosumage s
      torage energy
 122  con8h_max_sto_pro_p              Maximum installable capacity: prosumage s
      torage power
 123   
 124  * Prosumage
 125  con11a_pro_distrib                       Prosumage: distribution of genera
      ted energy
 126  con11b_pro_balance                       Prosumage: energy balance
 127  con11c_pro_selfcon                       Prosumage: minimum self-generatio
      n requirement
 128  con11d_pro_stolev_PRO2PRO                Prosumage: storage level prosumag
      er-to-prosumagers
 129  con11h_1_pro_stolev_start_PRO2PRO        Prosumage: storage level initial 
      conditions
 130  con11j_pro_stolev_max                    Prosumage: maximum overall storag
      e level
 131  con11k_pro_maxin_sto                     Prosumage: maximum storage inflow
 132  con11l_pro_maxout_sto                    Prosumage: maximum storage outflo
      w
 133  con11o_pro_ending                        Prosumage: storage ending conditi
      on
 134   
 135  * FOC optimality conditions
 136  FOCG_L                   FOC w.r.t. G_L
 137  FOCG_UP                  FOC w.r.t. G_UP
 138  FOCG_DO                  FOC w.r.t. G_DO
 139  FOCG_RES                 FOC w.r.t. G_RES
 140  FOCCU                    FOC w.r.t. CU
 141  FOCSTO_IN                FOC w.r.t. STO_IN
 142  FOCSTO_OUT               FOC w.r.t. STO_OUT
 143  FOCSTO_L                 FOC w.r.t. STO_L
 144  FOCN_TECH_NONDIS         FOC w.r.t. N_TECH(nondis)
 145  FOCN_TECH_DIS            FOC w.r.t. N_TECH(dis)
 146  FOCN_TECH                FOC w.r.t. N_TECH
 147  FOCN_STO_E               FOC w.r.t. N_STO_E
 148  FOCN_STO_P               FOC w.r.t. N_STO_P
 149   
 150  FOC_CU_PRO                  Prosumage: FOC w.r.t CU_PRO
 151  FOC_N_RES_PRO               Prosumage: FOC w.r.t N_RES_PRO
 152  FOC_N_STO_E_PRO             Prosumage: FOC w.r.t N_STO_E_PRO
 153  FOC_N_STO_P_PRO             Prosumage: FOC w.r.t N_STO_P_PRO
 154  FOC_G_MARKET_M2PRO          Prosumage: FOC w.r.t G_MARKET_M2PRO
 155  FOC_G_MARKET_PRO2M          Prosumage: FOC w.r.t G_MARKET_PRO2M
 156  FOC_G_RES_PRO               Prosumage: FOC w.r.t G_RES_PRO
 157  FOC_STO_IN_PRO2PRO          Prosumage: FOC w.r.t STO_IN_PRO2PRO
 158  FOC_STO_OUT_PRO2PRO         Prosumage: FOC w.r.t STO_OUT_PRO2PRO
 159  FOC_STO_L_PRO2PRO           Prosumage: FOC w.r.t STO_L_PRO2PRO
 160   
 161  ;
 162   
 163   
 164   
 165  **************************************************************************
      ******
 166   
 167  * ------------------------------------------------------------------------
      ---- *
 168  ***** Objective function *****
 169  * ------------------------------------------------------------------------
      ---- *
 170   
 171  obj..
 172           Z =E=
 173                     sum( (h,dis_sys) , c_m(dis_sys)*G_L(dis_sys,h) )
****                                          $140
 174                   + sum( (h,dis_sys)$(ord(h)>1) , c_up(dis_sys)*G_UP(dis_sy
****                                                      $140
      s,h) )
 175                   + sum( (h,dis_sys) , c_do(dis_sys)*G_DO(dis_sys,h) )
****                                           $140
 176                   + sum( (h,nondis_sys) , c_cu(nondis_sys)*CU(nondis_sys,h)
****                                              $140
       )
 177                   + sum( (h,sto_sys) , c_m_sto(sto_sys)* ( STO_OUT(sto_sys,
****                                              $140
      h) + STO_IN(sto_sys,h) ) )
 178                   + sum( tech , c_i(tech)*N_TECH(tech) )
****                                   $140
 179                   + sum( tech , c_fix(tech)*N_TECH(tech) )
****                                     $140
 180                   + sum( sto_sys , c_i_sto_e(sto_sys)*N_STO_E(sto_sys))
****                                            $140
 181                   + sum( sto_sys , c_fix_sto(sto_sys)/2*(N_STO_P(sto_sys)+ 
****                                            $140
      N_STO_E(sto_sys)) )
 182                   + sum( sto_sys , c_i_sto_p(sto_sys)*N_STO_P(sto_sys))
****                                            $140
 183  %prosumage$ontext
****  $409
 184                   + sum( res_pro , c_i(res_pro)*N_RES_PRO(res_pro) )
 185                   + sum( res_pro , c_fix(res_pro)*N_RES_PRO(res_pro) )
 186                   + sum( sto_pro , c_i_sto_e(sto_pro)*N_STO_E_PRO(sto_pro) 
      )
 187                   + sum( sto_pro , c_fix_sto(sto_pro)/2*(N_STO_P_PRO(sto_pr
      o) + N_STO_E_PRO(sto_pro)) )
 188                   + sum( sto_pro , c_i_sto_p(sto_pro)*N_STO_P_PRO(sto_pro) 
      )
 189                   + sum( (h,sto_pro) , c_m_sto(sto_pro) * ( STO_OUT_PRO2PRO
      (sto_pro,h) + sum( res_pro , STO_IN_PRO2PRO(sto_pro,res_pro,h)) ) )
 192  ;
 193   
 194  * ------------------------------------------------------------------------
      ---- *
 195  ***** Energy balance and load levels *****
 196  * ------------------------------------------------------------------------
      ---- *
 197   
 198  * Energy balance
 199  con1a_bal(h)..
 200   
 201             sum( dis_sys , G_L(dis_sys,h)) + sum( nondis_sys , G_RES(nondis
      _sys,h)) + sum( sto_sys , STO_OUT(sto_sys,h) )
 202  %prosumage$ontext
****  $37,409
 203           + sum( res , G_MARKET_PRO2M(res,h) )
 206           -  ( 1 - phi_pro_load )* d(h)
 207           -   sum( sto_sys , STO_IN(sto_sys,h) )
 208   
 209  %prosumage$ontext
 210           - G_MARKET_M2PRO(h)
 213   
 214         =G= 0
 215  ;
 216   
 217  con2a_loadlevel(dis_sys,h)$(ord(h) > 1)..
 218           G_L(dis_sys,h-1) + G_UP(dis_sys,h) - G_DO(dis_sys,h)  - G_L(dis_s
      ys,h) =G= 0
 219  ;
 220   
 221  con2b_loadlevelstart(dis_sys,h)$(ord(h) = 1)..
 222          G_UP(dis_sys,h) - G_L(dis_sys,h) =G= 0
 223  ;
 224   
 225  con2_loadlevel(dis_sys,h)..
 226             G_UP(dis_sys,h)  - G_L(dis_sys,h)
 227          +  (G_L(dis_sys,h-1) - G_DO(dis_sys,h))$(ord(h) > 1)
 228          =G= 0
 229  ;
 230   
 231   
 232   
 233  * ------------------------------------------------------------------------
      ---- *
 234  ***** Hourly maximum generation caps *****
 235  * ------------------------------------------------------------------------
      ---- *
 236   
 237  con3a_maxprod_dispatchable(dis_sys,h)..
 238   
 239           N_TECH(dis_sys) -  G_L(dis_sys,h)  =G= 0
 240   
 241  ;
 242   
 243  con3e_maxprod_res(nondis_sys,h)..
 244   
 245   
 246         phi_res(nondis_sys,h)*N_TECH(nondis_sys) - G_RES(nondis_sys,h) - CU
****               $140
      (nondis_sys,h) =G= 0
 247  ;
 248   
 249  * ------------------------------------------------------------------------
      ---- *
 250  ***** Storage constraints *****
 251  * ------------------------------------------------------------------------
      ---- *
 252   
 253  con4a_stolev_start(sto_sys,h)$(ord(h) = 1)..
 254          phi_sto_ini(sto_sys)* N_STO_E(sto_sys)+ STO_IN(sto_sys,h)*(1+eta_s
****                    $140                                                    
      to(sto_sys))/2 - STO_OUT(sto_sys,h)/(1+eta_sto(sto_sys))*2  - STO_L(sto_sy
       $140
      s,h)  =G= 0
 255  ;
 256   
 257  con4b_stolev(sto_sys,h)$(ord(h)>1)..
 258          STO_L(sto_sys,h-1) + STO_IN(sto_sys,h)*(1+eta_sto(sto_sys))/2 - ST
      O_OUT(sto_sys,h)/(1+eta_sto(sto_sys))*2  -  STO_L(sto_sys,h) =G= 0
 259  ;
 260   
 261  con4_stolev(sto_sys,h)..
 262   
 263         + STO_IN(sto_sys,h)*(1+eta_sto(sto_sys))/2 - STO_OUT(sto_sys,h)/(1+
      eta_sto(sto_sys))*2  -  STO_L(sto_sys,h)
 264         + (STO_L(sto_sys,h-1))$(ord(h)>1)
 265         =G= 0
 266  ;
 267   
 268   
 269  con4c_stolev_max(sto_sys,h)..
 270         N_STO_E(sto_sys)-  STO_L(sto_sys,h) =G= 0
 271  ;
 272   
 273  con4d_maxin_sto(sto_sys,h)..
 274   
 275          N_STO_P(sto_sys)-  STO_IN(sto_sys,h)   =G= 0
 276  ;
 277   
 278  con4e_maxout_sto(sto_sys,h)..
 279   
 280          N_STO_P(sto_sys)- STO_OUT(sto_sys,h)   =G= 0
 281  ;
 282   
 283  con4j_ending(sto_sys,h)$(ord(h) = card(h))..
 284   
 285          phi_sto_ini(sto_sys)* N_STO_E(sto_sys)-  STO_L(sto_sys,h) =G= 0
 286  ;
 287   
 288   
 289  con4k_PHS_EtoP(sto_sys)..
 290           etop_max(sto_sys)* N_STO_P(sto_sys)- N_STO_E(sto_sys)=G= 0
****                  $140
 291  ;
 292   
 293  * ------------------------------------------------------------------------
      ---- *
 294  ***** Quotas for renewables and biomass *****
 295  * ------------------------------------------------------------------------
      ---- *
 296   
 297  con5a_minRES..
 298  sum( h , G_L('bio',h) + sum(nondis_sys , G_RES(nondis_sys,h))
 299   
 300  %prosumage$ontext
****  $8,37,409
 301           + sum( sto_pro , STO_OUT_PRO2PRO(sto_pro,h)) + sum( res , G_MARKE
      T_PRO2M(res,h) + G_RES_PRO(res,h))
 304  )
 305          - phi_min_res * phi_min_res_exog * sum( h ,
 306           sum( (dis_sys) , G_L(dis_sys,h)) + sum( (nondis_sys) , G_RES(nond
      is_sys,h))
 307   
 308  %prosumage$ontext
 309           + sum( (res_pro) , phi_res(res_pro,h) * N_RES_PRO(res_pro) - CU_P
      RO(res_pro,h))
 312           )  =G= 0
 313  ;
 314   
 315  con5b_max_energy(tech)$dis_bio(tech)..
 316           m_e(tech) -  sum( h , G_L(tech,h) ) =G= 0
****             $140
 317  ;
 318   
 319   
 320  * ------------------------------------------------------------------------
      ---- *
 321  ***** Maximum installation constraints *****
 322  * ------------------------------------------------------------------------
      ---- *
 323   
 324  con8a_max_I_power(tech)..
 325         m_p(tech) - N_TECH(tech)     =G= 0
****           $140
 326  ;
 327   
 328  con8b_max_I_sto_e(sto_sys)..
 329         m_sto_e(sto_sys)- N_STO_E(sto_sys) =G= 0
****               $140
 330  ;
 331   
 332  con8c_max_I_sto_p(sto_sys)..
 333         m_sto_p(sto_sys)-  N_STO_P(sto_sys)=G= 0
****               $140
 334  ;
 335   
 336   
 337   
 338  con8f_max_pro_res(res_pro)..
 339         m_res_pro(res_pro)   -  N_RES_PRO(res_pro)   =G= 0
****                 $140
 340  ;
 341   
 342  con8g_max_pro_sto_e(sto_pro)..
 343         m_sto_pro_e(sto_pro) -  N_STO_E_PRO(sto_pro) =G= 0
****                   $140
 344  ;
 345   
 346  con8h_max_sto_pro_p(sto_pro)..
 347          m_sto_pro_p(sto_pro) -  N_STO_P_PRO(sto_pro) =G= 0
****                    $140
 348  ;
 349   
 350  * ------------------------------------------------------------------------
      ---- *
 351  ***** Prosumage constraints *****
 352  * ------------------------------------------------------------------------
      ---- *
 353   
 354  con11a_pro_distrib(res_pro,h)..
 355           phi_res(res_pro,h) * N_RES_PRO(res_pro)
 356           - CU_PRO(res_pro,h) - G_MARKET_PRO2M(res_pro,h) - G_RES_PRO(res_p
      ro,h) - sum( sto_pro , STO_IN_PRO2PRO(sto_pro,res_pro,h) )
 357           =G= 0
 358  ;
 359   
 360  con11b_pro_balance(h)..
 361           sum( res_pro , G_RES_PRO(res_pro,h)) + sum( sto_pro , STO_OUT_PRO
      2PRO(sto_pro,h) ) + G_MARKET_M2PRO(h)
 362           - phi_pro_load * d(h)
****                        $140$140
 363           =G= 0
 364  ;
 365   
 366  *** Not used in MCP model
 367  con11c_pro_selfcon..
 368           sum( (h,res_pro) , G_RES_PRO(res_pro,h) ) + sum( (h,sto_pro) , ST
      O_OUT_PRO2PRO(sto_pro,h) )
 369           -  phi_pro_self * sum( h , phi_pro_load * d(h))
****                         $140
 370           =G=     0
 371  ;
 372   
 373  con11d_pro_stolev_PRO2PRO(sto_pro,h)..
 374   
 375           + sum( res_pro , STO_IN_PRO2PRO(sto_pro,res_pro,h))*(1+eta_sto(st
      o_pro))/2
 376           - STO_OUT_PRO2PRO(sto_pro,h)/(1+eta_sto(sto_pro))*2
 377           - STO_L_PRO2PRO(sto_pro,h)
 378           + STO_L_PRO2PRO(sto_pro,h-1)$((ord(h)>1) )
 379           =G= 0
 380  ;
 381   
 382  *** Not used in MCP model
 383  con11h_1_pro_stolev_start_PRO2PRO(sto_pro,h)$( ord(h) = 1)..
 384          STO_L_PRO2PRO(sto_pro,h) =N=  sum( res_pro , STO_IN_PRO2PRO(sto_pr
      o,res_pro,h))*(1+eta_sto(sto_pro))/2 - STO_OUT_PRO2PRO(sto_pro,h)/(1+eta_s
      to(sto_pro))*2
 385  ;
 386   
 387   
 388  con11j_pro_stolev_max(sto_pro,h)..
 389         N_STO_E_PRO(sto_pro) - STO_L_PRO2PRO(sto_pro,h) =G= 0
 390  ;
 391   
 392  con11k_pro_maxin_sto(sto_pro,h)..
 393          N_STO_P_PRO(sto_pro) - sum( res_pro , STO_IN_PRO2PRO(sto_pro,res_p
      ro,h) )
 394          =G= 0
 395  ;
 396   
 397  con11l_pro_maxout_sto(sto_pro,h)..
 398          N_STO_P_PRO(sto_pro) - STO_OUT_PRO2PRO(sto_pro,h)
 399          =G= 0
 400  ;
 401   
 402  *** Not used in MCP model
 403  con11o_pro_ending(sto_pro,h)$( ord(h) = card(h))..
 404           STO_L_PRO2PRO(sto_pro,h) =G= phi_sto_pro_ini(sto_pro) * N_STO_E_P
****                                                      $140
      RO(sto_pro)
 405  ;
 406   
 407  * ------------------------------------------------------------------------
      ---- *
 408  ***** FOC conditions *****
 409  * ------------------------------------------------------------------------
      ---- *
 410   
 411   
 412  *** System FOC ***
 413  FOCG_L(tech,h)$dis_sys(tech)..
 414   
 415      + c_m(tech)
 416      - lambda_enerbal(h)
 417  %load_change_costs$ontext
****  $37,409
 418      + lambda_convgen(tech,h)
 421      + mu_conv_cap(tech,h)
 422  %investment_model$ontext
 423      + mu_bio_cap(tech)$dis_bio(tech)
 426  %load_change_costs$ontext
 427     - (lambda_convgen(tech,h+1))$(ord(h) > 1)
 430      =G= 0
 431   
 432  ;
 433   
 434  FOCG_UP(dis_sys,h)..
 435   
 436       - lambda_convgen(dis_sys,h)
 437       + (c_up(dis_sys))$(ord(h)> 1)
 438     =G= 0
 439   
 440  ;
 441   
 442  FOCG_DO(dis_sys,h)..
 443   
 444       + c_do(dis_sys)
 445       + (lambda_convgen(dis_sys,h))$(ord(h) > 1)
 446       =G= 0
 447   
 448  ;
 449   
 450  * Note: Fixed generation from ror is excluded since this is a parameter
 451  FOCG_RES(nondis_sys,h)$(not fx(nondis_sys))..
****                               $140
 452   
 453       - lambda_enerbal(h) + lambda_resgen(nondis_sys,h)
 454       =G= 0
 455  ;
 456   
 457  FOCCU(nondis_sys,h)..
 458   
 459       c_cu(nondis_sys) + lambda_resgen(nondis_sys,h) =G= 0
 460   
 461  ;
 462   
 463  FOCSTO_IN(sto_sys,h)..
 464   
 465      c_m_sto(sto_sys) + lambda_enerbal(h) -  lambda_stolev(sto_sys,h)*(1+et
      a_sto(sto_sys))/2
 466      + mu_stoin_cap(sto_sys,h) =G= 0
 467  ;
 468   
 469  FOCSTO_OUT(sto_sys,h)..
 470   
 471       c_m_sto(sto_sys) -  lambda_enerbal(h) +  lambda_stolev(sto_sys,h)/(1+
      eta_sto(sto_sys))*2
 472       +  mu_stout_cap(sto_sys,h)
 473        =G= 0
 474  ;
 475   
 476  FOCSTO_L(sto_sys,h)..
 477   
 478    + lambda_stolev(sto_sys,h)
 479    +  mu_stolev_cap(sto_sys,h)
 480    -  (lambda_stolev(sto_sys,h+1))$(ord(h) > 1 )
 481   
 482    =G= 0
 483   
 484  ;
 485   
 486  FOCN_TECH(tech)..
 487   
 488            +  c_i(tech)
 489            +  c_fix(tech)
 490  %investment_model$ontext
****  $37,409
 491            +  mu_tech_max_i(tech)
 494            - sum( h,   mu_conv_cap(tech,h))$dis_sys(tech)
 495            - sum( h,  lambda_resgen(tech,h)*phi_res(tech,h))$nondis_sys(tec
      h)
 496       =G= 0
 497   
 498  ;
 499   
 500   
 501   
 502  FOCN_STO_E(sto_sys)..
 503   
 504        +  c_fix_sto(sto_sys)/2 +  c_i_sto_e(sto_sys)
 505        -  sum( h,   mu_stolev_cap(sto_sys,h))
 506  %investment_model$ontext
****  $37,409
 507        +  mu_stoe_max_i(sto_sys)
 510        =G= 0
 511  ;
 512   
 513  FOCN_STO_P(sto_sys)..
 514   
 515   
 516       c_fix_sto(sto_sys)/2 + c_i_sto_p(sto_sys)
 517       - sum( h, (mu_stoin_cap(sto_sys,h) + mu_stout_cap(sto_sys,h)))
 518  %investment_model$ontext
****  $37,409
 519       + mu_stop_max_i(sto_sys)
 522       =G= 0
 523   
 524  ;
 525   
 526  *** Prosumage FOC ***
 527  * FOC w.r.t CU_PRO
 528  FOC_CU_PRO(res_pro,h)..
 529          lambda_resgen_pro(res_pro,h)
 530        =G= 0
 531  ;
 532   
 533  * FOC w.r.t N_RES_PRO
 534  FOC_N_RES_PRO(res_pro)..
 535  *             c_i_pv_PRO(res_pro)
 536             + c_i(res_pro) + c_fix(res_pro)
 537             - sum(h, lambda_resgen_pro(res_pro,h)*phi_res(res_pro,h)  )
 538             + mu_tech_max_i_pro(res_pro)  =G= 0
 539   
 540  ;
 541   
 542  * FOC w.r.t N_STO_E_PRO
 543  FOC_N_STO_E_PRO(sto_pro)..
 544  *            c_i_sto_pro_e_PRO(sto_pro)
 545            + c_i_sto_e(sto_pro) + c_fix_sto(sto_pro)/2
 546            - sum(h, mu_stolev_cap_pro(sto_pro,h) )       =G=  0
 547   
 548  ;
 549   
 550  * FOC w.r.t N_STO_P_PRO
 551  FOC_N_STO_P_PRO(sto_pro)..
 552  *            c_i_sto_pro_p_PRO(sto_pro)
 553              c_i_sto_p(sto_pro) + c_fix_sto(sto_pro)/2
 554            - sum(h, mu_stoin_cap_pro(sto_pro,h))
 555            - sum(h, mu_stout_cap_pro(sto_pro,h))
 556            =G=  0
 557   
 558  ;
 559   
 560  * FOC w.r.t G_MARKET_M2PRO
 561  FOC_G_MARKET_M2PRO(h)..
 562  %selfish_prosumage$ontext
****  $119             $140   $140
 563  *           price_consume_PRO(h)
 564  *          sum( hh, lambda_enerbal(hh))/card(h) + 250
 565   + 300
 566   
 569  %prosumage_system_version$ontext
****  $37,409
 570             + lambda_enerbal(h)
 573  *
 574             - lambda_enerbal_pro(h) =G=  0
 575  ;
 576   
 577  * FOC w.r.t G_MARKET_PRO2M
 578  FOC_G_MARKET_PRO2M(res_pro,h)..
 579  %selfish_prosumage$ontext
****  $119
 580  *         - price_produce_PRO(h)
 581            - 120
 584  %prosumage_system_version$ontext
****  $37,409
 585             - lambda_enerbal(h)
 588   
 589           + lambda_resgen_pro(res_pro,h)  =G= 0
 590  ;
 591   
 592  * FOC w.r.t G_RES_PRO
 593  FOC_G_RES_PRO(res_pro,h)..
 594           - lambda_enerbal_pro(h)
 595           + lambda_resgen_pro(res_pro,h)
 596  %prosumage$ontext
****  $37,409
 597  %minimum_SC$ontext
 598           - mu_self_con_pro
 601   
 602          =G= 0
 603  ;
 604   
 605  * FOC w.r.t STO_IN_PRO2PRO
 606  FOC_STO_IN_PRO2PRO(sto_pro,res_pro,h)..
 607  *            c_var_sto_pro_PRO(sto_pro)
 608           +  c_m_sto(sto_pro)
 609           +  lambda_resgen_pro(res_pro,h)
 610           -  lambda_stolev_pro(sto_pro,h)*(1+eta_sto(sto_pro))/2
 611           +  mu_stoin_cap_pro(sto_pro,h)
 612          =G= 0
 613   
 614  ;
 615   
 616  * FOC w.r.t STO_OUT_PRO2PRO
 617  FOC_STO_OUT_PRO2PRO(sto_pro,h)..
 618  *         c_var_sto_pro_PRO(sto_pro)
 619         + c_m_sto(sto_pro)
 620         - lambda_enerbal_pro(h)
 621         + lambda_stolev_pro(sto_pro,h)*2/(1+eta_sto(sto_pro))
 622         + mu_stout_cap_pro(sto_pro,h)
 623  %prosumage$ontext
****  $37,409
 624  %minimum_SC$ontext
 625          - mu_self_con_pro
 628           =G= 0
 629  ;
 630   
 631  * FOC w.r.t STO_L_PRO2PRO
 632  FOC_STO_L_PRO2PRO(sto_pro,h)..
 633        + lambda_stolev_pro(sto_pro,h)
 634        + mu_stolev_cap_pro(sto_pro,h)
 635        - lambda_stolev_pro(sto_pro,h+1)$(ord(h) > 1 )
 636        =G= 0
 637  ;
 638   
 639   
 640  **************************************************************************
      ******
 641  ***** Fix unmatched variables of first period *****
 642  **************************************************************************
      ******
 643   
 644  G_DO.fx(dis_sys,'h1') = 0;
****                     $353
 645   
 646  * Default for reporting
 647  G_DO.l(dis_sys,h)   = 0;
 648  G_L.l(dis_sys,h)    = 0;
 649  G_UP.l(dis_sys,h)   = 0;
 650  G_RES.l(tech,h) = 0;
 651  CU.l(tech,h)    = 0;
 652   
 653  STO_IN.l(sto_sys,h)  = 0;
 654  STO_OUT.l(sto_sys,h) = 0;
 655  STO_L.l(sto_sys,h)   = 0;
 656   
 657  N_TECH.l(tech)   = 0;
 658  N_STO_E.l(sto_sys)  = 0;
 659  N_STO_P.l(sto_sys)  = 0;
 660   
 661   
 662  **************************************************************************
      ******
 663  ***** MODEL *****
 664  **************************************************************************
      ******
 665   
 666  model DIETER /
 667  obj
 668   
 669  con1a_bal
 670   
 671  %load_change_costs$ontext
****  $2               $140,2 $234
 672  con2_loadlevel
 675   
 676  con3a_maxprod_dispatchable
 677  con3e_maxprod_res
 678   
 679  con4_stolev
 680  con4c_stolev_max
 681  con4d_maxin_sto
 682  con4e_maxout_sto
 683   
 684  con5a_minRES
 685  %investment_model$ontext
****  $2              $140,2 $234
 686  con5b_max_energy
 689   
 690  %investment_model$ontext
****  $2              $236,2 $234
 691  con8a_max_I_power
 692  con8b_max_I_sto_e
 693  con8c_max_I_sto_p
 696   
 697  %prosumage$ontext
****  $2       $140,2 $234
 698  con8f_max_pro_res
 699  *con8g_max_pro_sto_e
 700  *con8h_max_sto_pro_p
 701  con11a_pro_distrib
 702  con11b_pro_balance
 703  con11c_pro_selfcon
 704  con11d_pro_stolev_PRO2PRO
 705  con11j_pro_stolev_max
 706  con11k_pro_maxin_sto
 707  con11l_pro_maxout_sto
 710   
 711  /;
 712   
 713  model DIETER_MCP /
 714   
 715  con1a_bal.lambda_enerbal
 716   
 717  %load_change_costs$ontext
****  $2                $2    $234
 718  con2_loadlevel.lambda_convgen
 721   
 722  con3a_maxprod_dispatchable.mu_conv_cap
 723  con3e_maxprod_res.lambda_resgen
 724   
 725  con4_stolev.lambda_stolev
 726  con4c_stolev_max.mu_stolev_cap
 727  con4d_maxin_sto.mu_stoin_cap
 728  con4e_maxout_sto.mu_stout_cap
 729   
 730  %investment_model$ontext
****  $2               $2    $234
 731  con5b_max_energy.mu_bio_cap
 734   
 735  %investment_model$ontext
****  $2              $236,2 $234
 736  con8a_max_I_power.mu_tech_max_i
 737  con8b_max_I_sto_e.mu_stoe_max_i
 738  con8c_max_I_sto_p.mu_stop_max_i
 741   
 742  FOCG_L.G_L
 743   
 744  %load_change_costs$ontext
****  $2               $236,2 $234
 745  FOCG_UP.G_UP
 746  FOCG_DO.G_DO
 749   
 750  FOCG_RES.G_RES
 751  FOCCU.CU
 752  FOCSTO_IN.STO_IN
 753  FOCSTO_OUT.STO_OUT
 754  FOCSTO_L.STO_L
 755   
 756  %investment_model$ontext
****  $2              $236,2 $234
 757  FOCN_TECH.N_TECH
 758  FOCN_STO_E.N_STO_E
 759  FOCN_STO_P.N_STO_P
 762   
 763  %prosumage$ontext
****  $2        $2    $234
 764  con8f_max_pro_res.mu_tech_max_i_pro
 765  *con8g_max_pro_sto_e
 766  *con8h_max_sto_pro_p
 767  con11a_pro_distrib.lambda_resgen_pro
 768  con11b_pro_balance.lambda_enerbal_pro
 769  %selfish_prosumage%con11c_pro_selfcon.mu_self_con_pro
****  $2               $234,2
 770  con11d_pro_stolev_PRO2PRO.lambda_stolev_pro
 771  con11j_pro_stolev_max.mu_stolev_cap_pro
 772  con11k_pro_maxin_sto.mu_stoin_cap_pro
 773  con11l_pro_maxout_sto.mu_stout_cap_pro
 774   
 775  FOC_CU_PRO.CU_PRO
 776  FOC_N_RES_PRO.N_RES_PRO
 777  FOC_N_STO_E_PRO.N_STO_E_PRO
 778  FOC_N_STO_P_PRO.N_STO_P_PRO
 779  FOC_G_MARKET_M2PRO.G_MARKET_M2PRO
 780  FOC_G_MARKET_PRO2M.G_MARKET_PRO2M
 781  FOC_G_RES_PRO.G_RES_PRO
 782  FOC_STO_IN_PRO2PRO.STO_IN_PRO2PRO
 783  FOC_STO_OUT_PRO2PRO.STO_OUT_PRO2PRO
 784  FOC_STO_L_PRO2PRO.STO_L_PRO2PRO
 787   
 788   
 789   
 790   
 791  / ;
 792   
GAMS 25.1.2  r67455 Released Aug  1, 2018 WEX-WEI x86 64bit/MS Windows 01/09/19 12:49:30 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Error Messages


  2  Identifier expected
  8  ')' expected
 37  '=l=' or '=e=' or '=g=' operator expected
119  Number (primary) expected
120  Unknown identifier entered as set
140  Unknown symbol
234  Illegal type in model list - equation or equation.variable
       or another model list
236  Duplicate identifier(s) in model definition
353  The domain for this index position is unknown and the element
        cannot be checked at this point. Missing data statement.
361  Values for domain 1 are unknown - no checking possible
409  Unrecognizable item - skip to find a new statement
       looking for a ';' or a key word to get started again

**** 102 ERROR(S)   0 WARNING(S)


COMPILATION TIME     =        0.281 SECONDS      3 MB  25.1.2 r67455 WEX-WEI


USER: Medium MUD - 10 User License                   S180308:0349AO-GEN
      Deutsches Institut fuer Wirtschaftsforschung DIW, AbteilungDC3975
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Diet
           er_Module\DIETER_PROSUMOD_MCP\model.gms
Output     C:\Users\cguenther\Documents\GitHub\prosumage\Code\Prosumage_Opt\Diet
           er_Module\DIETER_PROSUMOD_MCP\model.lst

**** USER ERROR(S) ENCOUNTERED
